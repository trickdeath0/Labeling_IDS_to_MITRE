Sid,URL,technique ids,Rule
7846,https://snort.org/rule_docs/1-7846,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger clogger 1.0 runtime detection""; flow:to_server,established; flowbits:isset,Clogger_SendLogOut1; content:""|23 23 23 23|"",nocase; content:""Fen|EA|tre |3A|"",distance 0,nocase; content:""|23 23 23 23|"",distance 0,nocase; pcre:""/\x23\x23\x23\x23\s+Fen\xeatre\s+\x3a[^\r\n]*\x23\x23\x23\x23/ims""; flowbits:set,Clogger_SendLogOut2; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:7846; rev:6; )"
20098,https://snort.org/rule_docs/1-20098,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-CNC Win.Trojan.KeyLogger.wav variant outbound connection""; flow:to_server,established; content:""Subject|3A|Rpt|0A 0D|""; content:""SL|3A|"",within 3,distance 1; content:""SL|3A|"",distance 0; service:smtp; classtype:trojan-activity; sid:20098; rev:8; )"
16125,https://snort.org/rule_docs/1-16125,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger spyyahoo v2.2 runtime detection""; flow:to_server,established; content:""RETR k3ylogger.txt"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp; classtype:successful-recon-limited; sid:16125; rev:7; )"
7165,https://snort.org/rule_docs/1-7165,['T1056'],"alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 1""; flow:established; content:""chkLis"",depth 6; flowbits:set,ABSystemSpy_Inforetrieve1; flowbits:noalert; classtype:successful-recon-limited; sid:7165; rev:8; )"
7547,https://snort.org/rule_docs/1-7547,['T1056'],"alert udp $EXTERNAL_NET any -> $HOME_NET 15164 ( msg:""MALWARE-OTHER Keylogger activity monitor 3.8 runtime detection - agent status monitoring""; content:""|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"",depth 16; classtype:successful-recon-limited; sid:7547; rev:8; )"
13243,https://snort.org/rule_docs/1-13243,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger computer monitor 1.1 by lastcomfort runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Computer"",distance 0,nocase; content:""Monitor"",distance 0,nocase; pcre:""/^X-Mailer\x3A[^\r\n]*Computer\s+Monitor/ims""; flowbits:set,ComputerMonitor11_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13243; rev:7; )"
14075,https://snort.org/rule_docs/1-14075,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger ultimate Keylogger pro runtime detection""; flow:to_server,established; content:""Subject|3A| Ultimate Keylogger Report from"",fast_pattern,nocase; content:""Activity Report from Ultimate"",nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:14075; rev:8; )"
8467,https://snort.org/rule_docs/1-8467,['T1056'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger netobserve runtime detection - remote login response""; flow:to_client,established; http_header; content:""Server|3A|"",nocase; content:""NETObserve"",nocase; pcre:""/^Server\x3a[^\r\n]*NETObserve/ims""; service:http; classtype:successful-recon-limited; sid:8467; rev:11; )"
29918,https://snort.org/rule_docs/1-29918,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 100 ( msg:""MALWARE-OTHER Win.Keylogger.Vacky system information disclosure""; flow:to_server,established; content:""|00 00 00 00 00 00 00|"",depth 7,offset 1; content:""|AA AA AA AA|"",within 4,distance 4,fast_pattern; isdataat:15; isdataat:!16; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:29918; rev:4; )"
12772,https://snort.org/rule_docs/1-12772,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated PPStream PowerPlayer ActiveX exploit attempt""; flow:to_client,established; file_data; content:""pps.setAttribute|28 22|classid|22|,|22|clsid|3A|5EC7C511-CD0F-42E6-830C-1BD9882F3458|22 29|"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12772; rev:12; )"
12129,https://snort.org/rule_docs/1-12129,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - get sys info""; flow:to_server,established; content:""info"",depth 4; flowbits:set,RemoteKeyLog.b.Info_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:12129; rev:6; )"
974,https://snort.org/rule_docs/1-974,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-IIS Microsoft Windows IIS directory traversal attempt""; flow:to_server,established; content:""..|5C|.."",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:974; rev:23; )"
46027,https://snort.org/rule_docs/1-46027,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP EventManager page.php sql injection attempt SQL injection attempt""; flow:to_server,established; http_uri; content:""/page.php"",fast_pattern,nocase; http_client_body; content:""slug="",nocase; pcre:""/(^|&)slug=[^&]*?([\x27\x22\x3b\x23]|\x2f\x2a|\x2d\x2d|%27|%22|%3b|%23|%2f%2a|%2d%2d)/im""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:46027; rev:2; )"
5779,https://snort.org/rule_docs/1-5779,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwpe shell file logs""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""HWPE Shell/File LOG"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5779; rev:9; )"
59092,https://snort.org/rule_docs/1-59092,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.Generic download attempt""; flow:to_client,established; file_data; content:""<?""; content:""function deltree($deldir) "",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59092; rev:1; )"
38950,https://snort.org/rule_docs/1-38950,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.PassStealer passwords exfiltration attempt""; flow:to_server; file_data; content:""Passwords Recorded On "",fast_pattern; content:""Time of Recording:"",within 20,distance 22; content:""IP Address"",within 12,distance 15; metadata:impact_flag red,ruleset community; service:ftp; T1020; classtype:trojan-activity; sid:38950; rev:4; )"
59051,https://snort.org/rule_docs/1-59051,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Andela upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""$andela"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59051; rev:1; )"
38558,https://snort.org/rule_docs/1-38558,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger outbound connection""; flow:to_server,established; http_uri; content:""/News/gate.php"",fast_pattern,nocase; http_client_body; content:""="",depth 4; http_header; content:""User-Agent|3A 20|""; pcre:""/User-Agent\x3a\x20[A-F0-9]{32}\x0d\x0a/""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38558; rev:3; )"
31556,https://snort.org/rule_docs/1-31556,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [80,8080,443] ( msg:""MALWARE-CNC Win.Trojan.CosmicDuke HTTP data exfiltration attempt""; flow:to_server,established; content:""/index.php?i="",depth 25,fast_pattern; content:!""&"",within 40; content:""|20|HTTP"",within 5,distance 40; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:31556; rev:4; )"
12760,https://snort.org/rule_docs/1-12760,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger powered Keylogger 2.2 runtime detection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""Powered"",distance 0,nocase; content:""Keylogger"",distance 0,nocase; content:""Logs"",distance 0,nocase; pcre:""/^Subject\x3A[^\r\n]*Powered\s+Keylogger\s+Logs/ims""; flowbits:set,PoweredKeylogger22_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:12760; rev:7; )"
37389,https://snort.org/rule_docs/1-37389,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Rockwell Automation default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW5pc3RyYXRvcjptbDE0MDA="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37389; rev:3; )"
50095,https://snort.org/rule_docs/1-50095,['T1187'],"alert tcp any 443 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner self-signed certificate attempt""; flow:to_client,established; ssl_state:server_hello; content:""|30 82 01 BB A0 03 02 01 02 02 09 00 E4 22 8D EC 68 EF B1 78|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ssl; classtype:misc-attack; sid:50095; rev:1; )"
41457,https://snort.org/rule_docs/1-41457,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC User-Agent known malicious user-agent string - Elite Keylogger""; flow:to_server,established; http_header; content:""User-Agent|3A| installer/"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41457; rev:4; )"
25010,https://snort.org/rule_docs/1-25010,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.Perflog variant outbound connection""; flow:to_server,established; content:""Perfect=20Keylogger=20was=20installed=20successfully:="",fast_pattern,nocase; content:""Perfect Keylogger was installed on the computer""; metadata:impact_flag red; service:smtp; classtype:trojan-activity; sid:25010; rev:3; )"
40238,https://snort.org/rule_docs/1-40238,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Keylogger.AgentTesla variant outbound connection""; flow:to_server,established; http_uri; content:""/post.php"",fast_pattern,nocase; http_client_body; content:""type="",nocase; content:""hwid="",nocase; content:""pcname="",nocase; content:""username="",nocase; content:""password="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:40238; rev:3; )"
50955,https://snort.org/rule_docs/1-50955,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:""JHM9JF9TRVJWRVI7a3NvcnQoJHMpOyR4PSIi"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50955; rev:1; )"
56610,https://snort.org/rule_docs/1-56610,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Cobalt Strike beacon outbound connection attempt""; flow:to_server,established; http_header; content:""auth=0|5C 3B|loc=US}"",fast_pattern,nocase; content:""sess-=""; content:""Accept-Encoding: gzip, deflate, br""; content:""Accept-Language: en-US|0D 0A|""; content:""Accept: */*""; http_uri; pcre:""/^\x2f(updates|license\x2feula|docs\x2foffice|software-activation)/i""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56610; rev:1; )"
36601,https://snort.org/rule_docs/1-36601,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $FTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.QVKeylogger outbound variant connection""; flow:to_server,established; content:""PASS hUSuphun7*|0D 0A|"",fast_pattern,nocase; metadata:impact_flag red; service:ftp; classtype:trojan-activity; sid:36601; rev:3; )"
19900,https://snort.org/rule_docs/1-19900,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Tong Keylogger outbound connection""; flow:to_server,established; flowbits:isset,backdoor.tongkeylogger; content:""|5B|Sync"",nocase; content:"" Manager|5D|"",distance 0,nocase; content:""|2D|"",distance 0,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:trojan-activity; sid:19900; rev:6; )"
2922,https://snort.org/rule_docs/1-2922,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:""PROTOCOL-DNS TCP inverse query""; flow:to_server,established; byte_test:1,<,16,4; byte_test:1,&,8,4; metadata:policy max-detect-ips drop,ruleset community; service:dns; classtype:attempted-recon; sid:2922; rev:12; )"
8355,https://snort.org/rule_docs/1-8355,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spybuddy 3.72 runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""SpyBuddy"",distance 0,nocase; pcre:""/^From\x3a[^\r\n]*SpyBuddy/ims""; flowbits:set,SpyBuddy_SMTP; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:8355; rev:13; )"
5777,https://snort.org/rule_docs/1-5777,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger gurl watcher runtime detection""; flow:to_server,established; content:""X-Mailer|3A| GURL Watcher"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5777; rev:10; )"
61158,https://snort.org/rule_docs/1-61158,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC JSP.Webshell.JSP2Shell inbound connection""; flow:to_server,established; http_uri; content:"".jsp?path="",fast_pattern,nocase; content:""&editfile"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61158; rev:1; )"
28976,https://snort.org/rule_docs/1-28976,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Agent.DF - Data Exfiltration""; flow:to_server,established; http_client_body; content:""|3B| name=|22|arquivo|22 3B| filename=|22|C:|5C|"",fast_pattern,nocase; content:""|0D 0A|TP=""; content:""|0D 0A|LGSN="",distance 0; metadata:impact_flag red,ruleset community; service:http; T1020; classtype:trojan-activity; sid:28976; rev:3; )"
59350,https://snort.org/rule_docs/1-59350,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CWShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; http_client_body; content:""connectback=Connect+Back"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59350; rev:1; )"
59941,https://snort.org/rule_docs/1-59941,['T1190'],"alert http ( msg:""SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt""; flow:to_server,established; http_uri; content:""${"",fast_pattern; content:""atlassian."",distance 0; content:""|28|"",distance 0; content:""}"",distance 0; pcre:""/\x24\x7b[^\x7d]*?atlassian\x2e[^\x7d]*?\x28/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:59941; rev:3; )"
2230,https://snort.org/rule_docs/1-2230,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP NetGear router default password login attempt admin/password""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46cGFzc3dvcmQ"",nocase; pcre:""/^Authorization\x3a(\s*|\s*\r?\n\s+)Basic\s+YWRtaW46cGFzc3dvcmQ/ims""; metadata:ruleset community; service:http; T1078; classtype:default-login-attempt; sid:2230; rev:17; )"
2145,https://snort.org/rule_docs/1-2145,['T1078'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP TextPortal admin.php default password admin attempt""; flow:to_server,established; http_uri; content:""/admin.php""; pkt_data; content:""op=admin_enter""; content:""password=admin"",fast_pattern,nocase; metadata:ruleset community; service:http; T1078; classtype:web-application-activity; sid:2145; rev:12; )"
52620,https://snort.org/rule_docs/1-52620,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Citrix ADC and Gateway arbitrary code execution attempt""; flow:to_server,established; http_uri; content:""/vpns/"",fast_pattern,nocase; http_raw_header; content:""NSC_USER:""; content:""../"",within 10; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:52620; rev:2; )"
7184,https://snort.org/rule_docs/1-7184,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger 007 spy software runtime detection - smtp""; flow:to_server,established; content:""From|3A| |22|007 Spy Agent|22|"",nocase; content:""Subject|3A| 007 Monitoring Log Report"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:7184; rev:9; )"
59263,https://snort.org/rule_docs/1-59263,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C0ders inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?mode=shell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59263; rev:1; )"
38564,https://snort.org/rule_docs/1-38564,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger keylog exfiltration attempt""; flow:to_server,established; http_uri; content:""/post.php?"",fast_pattern,nocase; content:""pl=""; content:""&education="",distance 0; metadata:impact_flag red,ruleset community; service:http; T1020; T1056; classtype:trojan-activity; sid:38564; rev:3; )"
59091,https://snort.org/rule_docs/1-59091,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Azrail inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?op="",fast_pattern,nocase; content:""&dir="",within 15,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59091; rev:1; )"
12761,https://snort.org/rule_docs/1-12761,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger powered Keylogger 2.2 runtime detection""; flow:to_server,established; flowbits:isset,PoweredKeylogger22_detection; content:""Please,"",nocase; content:""find"",distance 0,nocase; content:""the"",distance 0,nocase; content:""log"",distance 0,nocase; content:""file"",distance 0,nocase; content:""|28|PKL|29|"",distance 0,nocase; content:""attached"",distance 0,nocase; content:""to"",distance 0,nocase; content:""this"",distance 0,nocase; content:""e-mail."",distance 0,nocase; pcre:""/Please\x2C\s+find\s+the\s+log\s+file\s+\x28PKL\x29\s+attached\s+to\s+this\s+e\x2Dmail\x2E/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12761; rev:7; )"
12133,https://snort.org/rule_docs/1-12133,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - open url""; flow:to_server,established; content:""url"",depth 3; flowbits:set,RemoteKeyLog.b.Url_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:12133; rev:6; )"
58744,https://snort.org/rule_docs/1-58744,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_uri; content:""${"",fast_pattern,nocase; pcre:""/\x24\x7b(jndi|[^\x7d\x80-\xff]*?\x24\x7b[^\x7d]*?\x3a[^\x7d]*?\x7d)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58744; rev:6; )"
19324,https://snort.org/rule_docs/1-19324,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Keylogger WL-Keylogger inbound connection""; flow:to_client,established; content:""ServerDetails"",depth 13,nocase; flowbits:set,Malware_Keylogger_InitConnection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:trojan-activity; sid:19324; rev:7; )"
28609,https://snort.org/rule_docs/1-28609,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Sakura exploit kit obfuscated exploit payload download""; flow:to_client,established; flowbits:isset,file.sakura_kit; file_data; content:""secretsecretsecretsecretsecretsecret"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:28609; rev:3; )"
49452,https://snort.org/rule_docs/1-49452,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Perl webshell upload attempt""; flow:to_server,established; file_data; content:""|89|PNG|0D 0A 1A 0A|"",depth 8; content:""/usr/bin/perl"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49452; rev:2; )"
13812,https://snort.org/rule_docs/1-13812,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger refog Keylogger runtime detection""; flow:to_server,established; content:""Content-Type|3A|"",nocase; content:""NextPart_2"",nocase; content:""<TIT=|0D 0A|LE>REFOG log</TITLE>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13812; rev:9; )"
37393,https://snort.org/rule_docs/1-37393,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Schneider default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""VVNFUjpVU0VS"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37393; rev:3; )"
28991,https://snort.org/rule_docs/1-28991,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $FTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Qakbot FTP data exfiltration""; flow:to_server,established; content:""STOR si_""; content:"".cb"",within 50; metadata:impact_flag red; service:ftp-data; classtype:trojan-activity; sid:28991; rev:3; )"
233,https://snort.org/rule_docs/1-233,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 27665 ( msg:""MALWARE-OTHER Trin00 Attacker to Master default startup password""; flow:to_server,established; content:""betaalmostdone""; metadata:ruleset community; T1078; classtype:attempted-dos; sid:233; rev:11; )"
1809,https://snort.org/rule_docs/1-1809,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-APACHE Apache chunked-encoding worm attempt""; flow:to_server,established; http_header; content:""X-CCCCCCC|3A 20|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:1809; rev:20; )"
37396,https://snort.org/rule_docs/1-37396,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP eWON default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtOmFkbQ=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37396; rev:3; )"
42925,https://snort.org/rule_docs/1-42925,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Keylogger.Scanbox outbound connection""; flow:to_server,established; http_uri; content:""/file/i/recv.php"",fast_pattern,nocase; http_method; content:""POST""; metadata:impact_flag red; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:42925; rev:4; )"
59353,https://snort.org/rule_docs/1-59353,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.SmallShell download attempt""; flow:to_client,established; file_data; content:""<?""; content:""$cmd"",nocase; content:""($_REQUEST["",within 16,nocase; content:""cmd"",within 4,nocase; content:""])|3B|"",within 4; content:""system($cmd)|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59353; rev:1; )"
41458,https://snort.org/rule_docs/1-41458,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Osx.Keylogger.Elite variant outbound connection""; flow:to_server,established; http_uri; content:""/read-mip.php"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41458; rev:3; )"
42926,https://snort.org/rule_docs/1-42926,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Keylogger.Scanbox outbound connection""; flow:to_server,established; http_uri; content:""/file/i/d.php?"",fast_pattern,nocase; content:""==""; metadata:impact_flag red; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:42926; rev:4; )"
7546,https://snort.org/rule_docs/1-7546,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger PerfectKeylogger runtime detection""; flow:to_server,established; flowbits:isset,PerfectKeylogger2; content:""This is a Perfect Keylogger report"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:7546; rev:8; )"
37379,https://snort.org/rule_docs/1-37379,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP BinTec Elmeg default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46YmludGVj"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37379; rev:3; )"
60402,https://snort.org/rule_docs/1-60402,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.DToolPro outbound connection attempt""; flow:to_client,established; file_data; content:""<script"",nocase; content:""function enviaCMD()"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60402; rev:1; )"
12480,https://snort.org/rule_docs/1-12480,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger inside website logger 2.4 runtime detection""; flow:to_server,established; content:""Subject|3A| Email Reports from Inside Website Logger"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:successful-recon-limited; sid:12480; rev:6; )"
32670,https://snort.org/rule_docs/1-32670,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Dropper.Ch variant outbound connection""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/tasks.php"",fast_pattern,nocase; http_header; content:""Content-length:""; content:""Content-type:""; content:!""Accept""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:32670; rev:3; )"
10167,https://snort.org/rule_docs/1-10167,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 20 ( msg:""MALWARE-OTHER Keylogger radar spy 1.0 runtime detection - send html log""; flow:to_client,established; content:""<title>New Page 1</title>"",nocase; content:""Log Started |3A|"",distance 0,fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10167; rev:7; )"
38104,https://snort.org/rule_docs/1-38104,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION Javascript obfuscation double unescape""; flow:to_client,established; file_data; content:""unescape(unescape("",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:38104; rev:2; )"
19392,https://snort.org/rule_docs/1-19392,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger Monitor.win32.perflogger""; flow:to_server,established; content:""USER|20|nacky8|0D 0A|"",nocase; flowbits:set,w32.perflogger; flowbits:noalert; metadata:policy max-detect-ips alert; service:ftp; classtype:trojan-activity; sid:19392; rev:8; )"
7544,https://snort.org/rule_docs/1-7544,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger PerfectKeylogger runtime detection - flowbit set 1""; flow:to_server,established; content:""X-Mailer|3A| CSMTPConnection"",depth 256,nocase; flowbits:set,PerfectKeylogger1; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:7544; rev:8; )"
59050,https://snort.org/rule_docs/1-59050,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.Andela download attempt""; flow:to_client,established; file_data; content:""<?""; content:""$andela"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59050; rev:1; )"
38249,https://snort.org/rule_docs/1-38249,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Samsung Data Manager default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46MTIzNA=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:38249; rev:3; )"
60297,https://snort.org/rule_docs/1-60297,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Cybershell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?d=/"",fast_pattern,nocase; content:""&show"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60297; rev:1; )"
37394,https://snort.org/rule_docs/1-37394,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Wago default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46d2Fnbw=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37394; rev:3; )"
40493,https://snort.org/rule_docs/1-40493,['T1220'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Ektron ServerControlWS.asmx XSL transform code injection attempt""; flow:to_server,established; http_uri; content:""/WorkArea/ServerControlWS.asmx"",fast_pattern,nocase; http_client_body; content:""<msxsl:script"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:40493; rev:3; )"
7591,https://snort.org/rule_docs/1-7591,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger keylogger pro runtime detection - flowbit set""; flow:to_server,established; content:""From|3A|"",nocase; content:""Keylogger-Pro"",distance 0,nocase; pcre:""/^From\x3a[^\r\n]*Keylogger-Pro/ims""; flowbits:set,KeyloggerPro_SMTP; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:7591; rev:6; )"
12137,https://snort.org/rule_docs/1-12137,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger Keylogger king home 2.3 runtime detection""; flow:to_server,established; content:""<TIT=|0D 0A|LE>|0D 0A|King log|0D 0A|</TITLE>|0D 0A|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12137; rev:8; )"
47898,https://snort.org/rule_docs/1-47898,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.OilRig variant outbound connection""; flow:to_server,established; http_uri; content:""/tahw?"",depth 6; pcre:""/\x2ftahw\x3f[A-F0-9]{3,84}$/""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:47898; rev:2; )"
6383,https://snort.org/rule_docs/1-6383,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 15163 ( msg:""MALWARE-OTHER Keylogger stealthwatcher 2000 runtime detection - tcp connection setup""; flow:to_server,established; content:""|04 00 00 00|"",depth 4; content:""|FF D8 FF E0 00 10|JFIF|00 01 01 00 00 00 00 00 00 00 FF DB 00|C|00 08 06 06 07 06 05 08 07 07 07 09 09 08 0A 0C 14 0D 0C 0B 0B 0C 19 12 13 0F 14 1D 1A 1F 1E 1D 1A 1C 1C| |24|.' |22|,|23 1C 1C 28|7|29|,01444|1F|'9=82<.342|FF DB 00|C|01|"",distance 0; classtype:successful-recon-limited; sid:6383; rev:6; )"
40905,https://snort.org/rule_docs/1-40905,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:""SERVER-WEBAPP Oracle Weblogic default credentials login attempt""; flow:to_server,established; http_uri; content:""/j_security_check"",fast_pattern,nocase; http_client_body; content:""j_username=""; content:""j_password=weblogic""; pcre:""/j_username=(root|system)/""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:40905; rev:3; )"
58737,https://snort.org/rule_docs/1-58737,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""jndi"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58737; rev:5; )"
59354,https://snort.org/rule_docs/1-59354,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.SmallShell upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""$cmd"",nocase; content:""($_REQUEST["",within 16,nocase; content:""cmd"",within 4,nocase; content:""])|3B|"",within 4; content:""shell_exec($cmd)|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59354; rev:1; )"
58787,https://snort.org/rule_docs/1-58787,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""%24%257b"",fast_pattern,nocase; pcre:""/%24%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58787; rev:4; )"
47398,https://snort.org/rule_docs/1-47398,['T1059'],"alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE Microsoft cmd.exe outbound shell attempt""; content:""Microsoft Windows [Version"",depth 26; metadata:policy max-detect-ips drop; classtype:attempted-user; sid:47398; rev:2; )"
40331,https://snort.org/rule_docs/1-40331,['T1078'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP JBoss default credential login attempt""; flow:to_server,established; http_uri; content:""/jmx-console/"",nocase; http_header; content:""Authorization: Basic YWRtaW46YWRtaW4="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:40331; rev:3; )"
50463,https://snort.org/rule_docs/1-50463,['T1187'],"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Mimikatz use via SMB attempt""; flow:to_server,established; content:""k|00|u|00|h|00|l|00|_|00|m|00|_|00|l|00|s|00|a|00|d|00|u|00|m|00|p|00|_|00|g|00|e|00|t|00|H|00|a|00|s|00|h|00|"",fast_pattern,nocase; content:""|FF|SMB|2F|"",depth 5,offset 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50463; rev:1; )"
6340,https://snort.org/rule_docs/1-6340,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger handy keylogger runtime detection""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""Handy Keylogger|3A|"",distance 0,nocase; content:""PRODUCED BY HANDY KEYLOGGER LOG PARSER"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:6340; rev:9; )"
10165,https://snort.org/rule_docs/1-10165,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger mybr Keylogger runtime detection""; flow:to_server,established; content:""From|3A D0 C5 CF A2|"",fast_pattern,nocase; content:""Subject|3A|"",nocase; pcre:""/^From\x3a\xd0\xc5\xcf\xa2.*Subject\x3a[^\r\n]*\d+\x2d\d+\x2d\d+\x2d\d+\x3a\d+\x3a\d+/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10165; rev:9; )"
59022,https://snort.org/rule_docs/1-59022,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Antichat upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""Antichat Shell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59022; rev:1; )"
60471,https://snort.org/rule_docs/1-60471,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.CmdShell outbound connection attempt""; flow:to_client,established; file_data; content:""<input type=|22|TEXT|22| name=|22|cmd|22 20|"",fast_pattern,nocase; content:""<input type=|22|SUBMIT|22| value=|22|Execute|22|>"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60471; rev:1; )"
58733,https://snort.org/rule_docs/1-58733,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""${upper:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58733; rev:5; )"
5783,https://snort.org/rule_docs/1-5783,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwae keystrokes log""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""HWAE Keystrokes LOG"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5783; rev:9; )"
49458,https://snort.org/rule_docs/1-49458,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER PHP webshell upload attempt""; flow:to_server,established; file_data; content:""|FF D8 FF|"",depth 3; content:""<?php"",distance 0,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49458; rev:3; )"
25475,https://snort.org/rule_docs/1-25475,['T1027'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt""; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:""<template xmlns=""; content:""http|3A|//www.xfa.org/"",distance 1; content:""<event activity"",distance 0; content:""initialize"",within 50,distance 1; content:""application/x-javascript"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:25475; rev:8; )"
15424,https://snort.org/rule_docs/1-15424,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP phpBB mod shoutbox sql injection attempt""; flow:to_server,established; http_uri; content:""shoutbox_view.php"",fast_pattern,nocase; content:""mode="",nocase; content:""id="",nocase; pcre:""/shoutbox_view\.php\x3F[^\r\n]*mode\s*=\s*(delete|edit)[^\r\n]*id\s*=\s*[^\r\n\x26]*[^\d]+/ims""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:15424; rev:13; )"
5880,https://snort.org/rule_docs/1-5880,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spyagent runtime detect - smtp delivery""; flow:to_server,established; content:""Computer IP Address|3A|"",nocase; content:""Attached to this email are the activity logs that you have requested"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5880; rev:8; )"
24369,https://snort.org/rule_docs/1-24369,['T1190'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Lizamoon sql injection campaign ur.php response detected""; flow:to_client,established; flowbits:isset,lizamoon.get.ur; content:""parkinglot=""; http_cookie; content:""parkinglot=""; metadata:impact_flag red; service:http; classtype:misc-activity; sid:24369; rev:4; )"
9828,https://snort.org/rule_docs/1-9828,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 20 ( msg:""MALWARE-OTHER Keylogger paq keylog runtime detection - ftp""; flow:to_client,established; content:""version"",nocase; content:""key"",distance 0,nocase; pcre:""/^version\s+\d+\x2E\d+\s+key\x3a/ims""; classtype:successful-recon-limited; sid:9828; rev:6; )"
35110,https://snort.org/rule_docs/1-35110,['T1027'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""EXPLOIT-KIT Angler exploit kit obfuscated Flash actionscript classname detected""; flow:to_server,established; file_data; content:""|0E|IIll1III111I11|0E|Illl1III111I11"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:35110; rev:4; )"
50106,https://snort.org/rule_docs/1-50106,['T1187'],"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB attack attempt""; flow:to_client,established; content:""W|00|I|00|N|00|-|00|P|00|R|00|H|00|4|00|9|00|2|00|R|00|Q|00|A|00|F|00|V|00|.|00|S|00|M|00|B|00|3|00|.|00|l|00|o|00|c|00|a|00|l|00|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50106; rev:1; )"
40832,https://snort.org/rule_docs/1-40832,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-CNC Win.Backdoor.Houdini variant keylogger inbound init command attempt""; flow:to_client,established; isdataat:22; isdataat:!23; content:""silence_keylogger|0D 0A|"",depth 19,offset 4; metadata:impact_flag red,ruleset community; T1056; classtype:trojan-activity; sid:40832; rev:5; )"
48288,https://snort.org/rule_docs/1-48288,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FormBook variant outbound request detected""; flow:to_server,established; http_uri; content:""/plugin.wbk"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:48288; rev:2; )"
51632,https://snort.org/rule_docs/1-51632,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION JavaScript exploit obfuscation attempt""; flow:to_client,established; content:""<body onload=|22|""; content:""parseInt|28 22|"",within 150,distance 25,fast_pattern; content:""unescape|28|"",within 150,distance 25; content:""String.fromCharCode|28|"",within 150,distance 25; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:51632; rev:1; )"
49865,https://snort.org/rule_docs/1-49865,['T1020'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-OTHER Multiple Products XML external entity information disclosure attempt""; flow:to_server,established; file_data; content:""ENTITY"",fast_pattern,nocase; content:""://"",within 75; pcre:""/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)((?!\x3e|%3e).)*?(file|http|https|ftp|jar)\x3A\x2F\x2F/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-attack; sid:49865; rev:2; )"
37305,https://snort.org/rule_docs/1-37305,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [$HTTP_PORTS,22222,22223] ( msg:""APP-DETECT Hola VPN tunnel keep alive""; flow:to_server,established; content:""/hola_trigger?ping=tunnel"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:37305; rev:3; )"
37388,https://snort.org/rule_docs/1-37388,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP NOVUS AUTOMATION default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""c3VwZXJ2aWV3OnN1cGVydmlldw=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37388; rev:3; )"
37301,https://snort.org/rule_docs/1-37301,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN startup attempt""; flow:to_server,established; http_uri; content:""/www/hola/pub/"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37301; rev:4; )"
41440,https://snort.org/rule_docs/1-41440,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Dos.Tool.LOIC TCP default U dun goofed attack""; flow:to_server,established; content:""U dun goofed"",fast_pattern,nocase; content:""U dun goofed"",depth 12; content:""U dun goofed""; content:""U dun goofed""; metadata:policy max-detect-ips drop; classtype:attempted-dos; sid:41440; rev:3; )"
27774,https://snort.org/rule_docs/1-27774,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC RDN Banker Data Exfiltration""; flow:to_server,established; http_method; content:""POST""; http_client_body; content:""|3B| name=|22|arquivo|22 3B| filename=|22|C:|5C|"",fast_pattern,nocase; content:""_.log|22 0D 0A|""; metadata:impact_flag red,ruleset community; service:http; T1020; classtype:trojan-activity; sid:27774; rev:3; )"
13237,https://snort.org/rule_docs/1-13237,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger active Keylogger 3.9.2 runtime detection""; flow:to_server,established; flowbits:isset,ActiveKeylogger392_detection; content:""filename=|22|"",nocase; content:""akllogs.zip|22|"",distance 0,nocase; pcre:""/filename\x3D\x22[^\r\n]*akllogs\x2Ezip\x22/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13237; rev:6; )"
15431,https://snort.org/rule_docs/1-15431,['T1220'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox 3 xsl parsing heap overflow attempt""; flow:to_client,established; file_data; content:""<xsl|3A|key name=|22|label|22| match=|22|item2|22| use=|22|w00t|28 29 22|/>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:15431; rev:14; )"
11311,https://snort.org/rule_docs/1-11311,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Keylogger pcsentinelsoftware Keylogger runtime detection - upload infor""; flow:to_server,established; http_uri; content:""/upload.php"",nocase; http_header; content:""Host|3A|"",nocase; content:""www.pcsentinelsoftware.com"",nocase; pcre:""/^Host\x3a[^\r\n]*www\x2Epcsentinelsoftware\x2Ecom/ims""; metadata:policy max-detect-ips drop; service:http; classtype:successful-recon-limited; sid:11311; rev:12; )"
7549,https://snort.org/rule_docs/1-7549,['T1056'],"alert udp $HOME_NET any -> $EXTERNAL_NET 15165 ( msg:""MALWARE-OTHER Keylogger activity monitor 3.8 runtime detection""; content:""|1D BA 0B FB|d|5C 86 E1 DA 83|BC|B6 04 E0|^|0A|@|C5 D4 00 00 00 00 00 00 00 00|""; classtype:successful-recon-limited; sid:7549; rev:8; )"
16574,https://snort.org/rule_docs/1-16574,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated ActiveX object instantiation via fromCharCode""; flow:to_client,established; file_data; content:""ActiveXObject|28|"",nocase; content:""String.fromCharCode|28|"",fast_pattern,nocase; pcre:""/new\s*ActiveXObject\(\s*String\.fromCharCode\(/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:16574; rev:13; )"
1564,https://snort.org/rule_docs/1-1564,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP login.htm access""; flow:to_server,established; http_uri; content:""/login.htm"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1564; rev:14; )"
36602,https://snort.org/rule_docs/1-36602,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $FTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.QVKeylogger outbound variant connection""; flow:to_server,established; content:""RETR public_html/updates/version.txt|0D 0A|"",fast_pattern,nocase; metadata:impact_flag red; service:ftp; classtype:trojan-activity; sid:36602; rev:3; )"
12379,https://snort.org/rule_docs/1-12379,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 20 ( msg:""MALWARE-OTHER Keylogger PaqKeylogger 5.1 runtime detection - ftp""; flow:to_client,established; content:""version 4.0 key|3A 0D 0A|~~~~~~~~~~~~~~~~~~~~~~~~~~""; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12379; rev:7; )"
45469,https://snort.org/rule_docs/1-45469,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC SambaCry ransomware download attempt""; flow:to_server,established; content:""/kelly6666/lo.txt"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:45469; rev:3; )"
33220,https://snort.org/rule_docs/1-33220,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.HawkEye keylogger exfiltration attempt""; flow:to_server,established; content:""HawkEye Keylogger"",fast_pattern,nocase; content:""Subject: =?utf-8?B""; metadata:impact_flag red,ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:33220; rev:6; )"
7539,https://snort.org/rule_docs/1-7539,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger eye spy pro 1.0 runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Eye"",distance 0,nocase; content:""Spy"",distance 0,nocase; content:""Pro"",distance 0,nocase; pcre:""/^X-Mailer\x3A[^\r\n]*Eye\s+Spy\s+Pro/ims""; service:smtp; classtype:successful-recon-limited; sid:7539; rev:9; )"
35317,https://snort.org/rule_docs/1-35317,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Directate outbound connection""; flow:to_server,established; http_uri; content:""/plugin/update/?user="",fast_pattern; content:""&usersid="",within 45; content:""&version="",within 193; content:""&osbit="",distance 0; content:""&state="",within 10; http_header; content:""User-Agent|3A| EI Plugin updater"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:35317; rev:3; )"
48508,https://snort.org/rule_docs/1-48508,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.ZeusPanda outbound connection attempt""; flow:to_server,established; http_uri; content:""/wp-content/plugins/"",fast_pattern,nocase; http_header; content:!""Referer""; http_uri; pcre:""/^\x2fwp-content\x2fplugins(\x2f.+?)*?\x2f[123]$/i""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:48508; rev:2; )"
19568,https://snort.org/rule_docs/1-19568,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Trojan-Spy.Win32.PerfectKeylogger variant outbound connection""; flow:to_server,established; http_uri; content:""/1stupload.php"",nocase; http_client_body; content:""name=|22|username|22 0D 0A|"",nocase; content:""name=|22|computername|22 0D 0A|"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:19568; rev:9; )"
7857,https://snort.org/rule_docs/1-7857,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger EliteKeylogger runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""<logs@logs.com>"",distance 0,nocase; pcre:""/^From\x3A[^\r\n]*\x3Clogs\x40logs\x2Ecom\x3E/ims""; service:smtp; classtype:successful-recon-limited; sid:7857; rev:7; )"
9827,https://snort.org/rule_docs/1-9827,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger paq keylog runtime detection - smtp""; flow:to_server,established; content:""Subject|3A|"",nocase; content:"".l|0D 0A|"",within 200,fast_pattern,nocase; pcre:""/^Subject\x3a[^\r\n]*20\d{3,4}\x5f[123]?\d\x2El/im""; service:smtp; classtype:successful-recon-limited; sid:9827; rev:10; )"
24368,https://snort.org/rule_docs/1-24368,['T1190'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Lizamoon sql injection campaign phone-home""; flow:to_server,established; http_uri; content:""/ur.php"",fast_pattern,nocase; http_header; content:"".asp""; pcre:""/Referer\x3a [^\r\n]+\.aspx?/i""; flowbits:set,lizamoon.get.ur; metadata:impact_flag red; service:http; classtype:misc-activity; sid:24368; rev:9; )"
37303,https://snort.org/rule_docs/1-37303,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN X-Hola-Version header attempt""; flow:to_server,established; http_header; content:""X-Hola-Version:"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37303; rev:4; )"
2056,https://snort.org/rule_docs/1-2056,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP TRACE attempt""; flow:to_server,established; content:""TRACE"",depth 5; metadata:ruleset community; service:http; classtype:web-application-attack; sid:2056; rev:12; )"
13279,https://snort.org/rule_docs/1-13279,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger advanced spy 4.0 runtime detection""; flow:to_server,established; flowbits:isset,AdvancedSpy_detection; content:""filename="",nocase; content:""|22|as_report_"",distance 0,nocase; content:"".zip|22|"",distance 0,nocase; pcre:""/filename\s*\x3D\s*\x22as\x5Freport\x5F[^\x22]+\x2Ezip\x22/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13279; rev:7; )"
61159,https://snort.org/rule_docs/1-61159,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC JSP.Webshell.JSP2Shell inbound connection""; flow:to_server,established; http_uri; content:"".jsp?up=true&path="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61159; rev:1; )"
28399,https://snort.org/rule_docs/1-28399,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:""MALWARE-CNC Linux.Backdoor.Tsunami outbound connection""; flow:to_server,established; content:""NICK"",depth 4; content:""USER"",within 4,distance 11; content:""|3A|raft"",within 5,distance 31; metadata:impact_flag red; service:irc; classtype:trojan-activity; sid:28399; rev:5; )"
46436,https://snort.org/rule_docs/1-46436,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Vbs.Downloader.Agent inbound connection""; flow:to_client,established; flowbits:isset,file.ole; file_data; content:""3832D640-CF90-11CF-8E43-00A0C911005A"",fast_pattern,nocase; content:""Workbook_Open"",nocase; content:""Document_Open"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:46436; rev:1; )"
13244,https://snort.org/rule_docs/1-13244,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger computer monitor 1.1 by lastcomfort runtime detection""; flow:to_server,established; flowbits:isset,ComputerMonitor11_detection; content:""Computer"",nocase; content:""Monitor"",distance 0,nocase; content:""by"",distance 0,nocase; content:""Lastcomfort"",distance 0,nocase; pcre:""/Computer\s+Monitor\s+by\s+Lastcomfort/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13244; rev:6; )"
57461,https://snort.org/rule_docs/1-57461,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.PULSECHECK variant cnc connection""; flow:to_server,established; http_uri; content:""/secid_canceltoken.cgi"",fast_pattern,nocase; http_header; content:""X-CMD|3A|"",nocase; content:""X-KEY|3A|"",nocase; http_method; content:""POST""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57461; rev:1; )"
60584,https://snort.org/rule_docs/1-60584,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Perl.Webshell.GammaShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".cgi?action=browse&path="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60584; rev:1; )"
38562,https://snort.org/rule_docs/1-38562,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger initial exfiltration attempt""; flow:to_server,established; content:""/gate.php"",fast_pattern,nocase; http_client_body; content:""pc="",nocase; content:""&admin="",distance 0,nocase; content:""&os="",distance 0,nocase; content:""&hid="",distance 0,nocase; content:""&arc="",distance 0,nocase; http_header; content:""User-Agent|3A 20|""; pcre:""/User-Agent\x3a\x20[A-F0-9]{32}\x0d\x0a/""; metadata:impact_flag red,ruleset community; service:http; T1020; T1056; classtype:trojan-activity; sid:38562; rev:4; )"
60337,https://snort.org/rule_docs/1-60337,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.DiveShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; http_client_body; content:""output="",nocase; content:""command="",fast_pattern,nocase; content:""rows=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60337; rev:1; )"
7186,https://snort.org/rule_docs/1-7186,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger kgb Keylogger runtime detection""; flow:to_server,established; content:""filename="",nocase; content:""zip"",distance 0,nocase; pcre:""/filename\x3D\x22[^\r\n]*?\x2D\d+\x5F\d+\x5F\d+\x2D\d+\x5F\d+\x5F\d+\s+[AP]M\x2Ezip/ims""; service:smtp; classtype:successful-recon-limited; sid:7186; rev:7; )"
53197,https://snort.org/rule_docs/1-53197,['T1056'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Keylogger.WindowsKeylogger variant download attempt""; flow:to_client,established; file_data; content:""user32.ShowWindow(kernel32.GetConsoleWindow(), 0)"",fast_pattern,nocase; content:""key_info.append(str(key.name)""; content:""key.on_press(write_key)""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:53197; rev:1; )"
60401,https://snort.org/rule_docs/1-60401,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.DToolPro inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; pkt_data; content:""?&cmd="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60401; rev:1; )"
44697,https://snort.org/rule_docs/1-44697,['T1176'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC SquirrelMail directory traversal attempt""; flow:to_server,established; http_uri; content:""/src/redirect.php?plugins[]="",fast_pattern,nocase; pcre:""/\x2fsrc\x2fredirect.php\x3fplugins\x5b\x5d=((?!^--).)*?\x2e\x2e[\x2f\x5c]/ims""; service:http; classtype:web-application-attack; sid:44697; rev:2; )"
50947,https://snort.org/rule_docs/1-50947,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:""|0D 0A|Zz""; content:""|3A|"",within 1,distance 2; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50947; rev:1; )"
8465,https://snort.org/rule_docs/1-8465,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger netobserve runtime detection - email notification""; flow:to_server,established; content:""From|3A|"",nocase; content:""NETObserve"",distance 0,nocase; pcre:""/^From\x3a[^\r\n]*NETObserve/ims""; flowbits:set,NETObserve_SMTP; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:8465; rev:6; )"
49569,https://snort.org/rule_docs/1-49569,['T1059'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER PowerShell invocation with ExecutionPolicy Bypass attempt""; flow:to_client,established; flowbits:isset,file.exe; content:""powershell"",fast_pattern; content:""bypass"",within 50; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:49569; rev:1; )"
50465,https://snort.org/rule_docs/1-50465,['T1187'],"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_client,established; content:""|FF|SMB|73|"",depth 5,offset 4; content:""|CE 0E 00 00 00 0F|S|00|M|00|B|00|1|00|2|00 02 00 0A 00|S|00|M|00|B|00|1|00|2|00|"",distance 0; content:""W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|S|00|e|00|r|00|v|00|e|00|r|00| |00|2|00|0|00|0|00|3|00| |00|3|00|7|00|9|00|0|00|"",distance 0; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50465; rev:1; )"
50952,https://snort.org/rule_docs/1-50952,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_client_body; content:""=ZWNobyAiP""; content:!""="",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50952; rev:1; )"
60451,https://snort.org/rule_docs/1-60451,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Erne inbound connection attempt""; flow:to_server,established; http_client_body; content:""newdirectory="",nocase; content:""createdirectory=yenidizin"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60451; rev:1; )"
59349,https://snort.org/rule_docs/1-59349,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CWShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; http_client_body; content:""phpinfo=View+PhpInfo"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59349; rev:1; )"
41443,https://snort.org/rule_docs/1-41443,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Ransomware.X-Mas variant keylogger outbound connection""; flow:to_server,established; http_uri; content:""/gate.php"",fast_pattern,nocase; http_client_body; content:""163=""; content:""&x="",distance 0; content:""&z="",distance 0; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:41443; rev:4; )"
21947,https://snort.org/rule_docs/1-21947,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 1024:65535 ( msg:""MALWARE-CNC Win.Trojan.VicSpy.A variant outbound connection""; flow:to_server,established; content:""VicSpy Keylogger"",depth 16,fast_pattern,nocase; content:""|0A|Ver|3A| "",within 50,nocase; content:""|0A|Prm|3A| "",within 50,nocase; classtype:trojan-activity; sid:21947; rev:7; )"
41817,https://snort.org/rule_docs/1-41817,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP generic SQL select statement possible sql injection""; flow:to_server,established; http_uri; content:""select * from"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:41817; rev:2; )"
300363,https://snort.org/rule_docs/1-300363,['T1505'],"alert file ( msg:""MALWARE-OTHER JSP.Webshell.JSPShell transfer attempt""; flow:to_server,established; file_data; content:""<%@"",depth 3; content:""request.getParameter(|22|cmd|22|) + |22|<BR>|22|)|3B|"",fast_pattern,nocase; content:""Runtime.getRuntime().exec(request.getParameter(|22|""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:300363; rev:1; )"
41714,https://snort.org/rule_docs/1-41714,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION rfc822 HTTP transfer encoding attempt""; flow:to_client,established; http_header; content:""Content-"",nocase; content:""rfc822"",within 50,fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:policy-violation; sid:41714; rev:7; )"
45518,https://snort.org/rule_docs/1-45518,['T1021'],"alert tcp $EXTERNAL_NET 3389 -> $HOME_NET any ( msg:""POLICY-OTHER Remote Desktop weak 40-bit RC4 encryption use attempt""; flow:to_client,established; content:""|02 0C|""; content:""|01 00 00 00 01 00 00 00 20 00 00 00|"",within 12,distance 2; content:""|01 00 00 00 01 00 00 00 01 00 00 00 06 00|"",within 14,distance 36; metadata:policy max-detect-ips drop; service:rdp; classtype:policy-violation; sid:45518; rev:4; )"
54793,https://snort.org/rule_docs/1-54793,['T1094'],"alert tcp any any -> any any ( msg:""MALWARE-CNC Unix.Malware.Drovorub cnc inbound connection attempt""; flow:established; content:""{|22|children|22|:[{|22|name|22|:"",fast_pattern,nocase; content:""|81|"",depth 1; content:""|22 2C 22|value|22 3A|"",distance 0,nocase; pcre:""/^\x81.{1,9}\x7b\x22children\x22\x3a\x5b\x7b\x22name\x22\x3a\x22[a-z0-9_\x2e]+\x22\x2c\x22value\x22\x3a\x22[a-z0-9\x2b\x2f]+={0,2}\x22\x7d/ims""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:trojan-activity; sid:54793; rev:1; )"
60286,https://snort.org/rule_docs/1-60286,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.CrewShell outbound connection attempt""; flow:to_client,established; file_data; content:""<br>Current_file:"",fast_pattern,nocase; content:""<br>Start_dir:"",nocase; content:""<br>Free Space:"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60286; rev:1; )"
32312,https://snort.org/rule_docs/1-32312,['T1020'],"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""MALWARE-CNC FrameworkPOS data exfiltration through DNS - beacon message""; flow:to_server; content:""|06|beacon""; content:""dc"",within 6,distance 3,nocase; content:""dc"",within 6,distance 2,nocase; content:""dc"",within 6,distance 2,nocase; metadata:impact_flag red; service:dns; classtype:trojan-activity; sid:32312; rev:3; )"
49530,https://snort.org/rule_docs/1-49530,['T1187'],"alert tcp any any -> $SMTP_SERVERS 25 ( msg:""INDICATOR-COMPROMISE Responder poisoner download attempt""; flow:to_server,established; flowbits:isset,file.exe; file_data; content:""poisoners.NBTNS"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-attack; sid:49530; rev:1; )"
7160,https://snort.org/rule_docs/1-7160,['T1056'],"alert tcp $HOME_NET 10050 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - upload file server-to-client""; flow:to_client,established; flowbits:isset,winspy_upload_client-to-server; content:""/CK|16|"",fast_pattern,nocase; classtype:successful-recon-limited; sid:7160; rev:8; )"
36100,https://snort.org/rule_docs/1-36100,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP ManageEngine OpManager default credentials authentication attempt""; flow:to_server,established; http_uri; content:""/jsp/Login.do"",nocase; http_client_body; content:""userName=IntegrationUser"",fast_pattern,nocase; content:""password=plugin"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:36100; rev:4; )"
37378,https://snort.org/rule_docs/1-37378,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP ABB default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""c2VydmljZTpBQkI4MDB4QQ=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37378; rev:3; )"
49454,https://snort.org/rule_docs/1-49454,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER CFM webshell upload attempt""; flow:to_server,established; file_data; content:""|FF D8 FF|"",depth 3; content:""cfexecute"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49454; rev:2; )"
35029,https://snort.org/rule_docs/1-35029,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC Win.Keylogger.Lotronc variant outbound connection""; flow:to_server,established,no_stream; content:""USER killer0709"",depth 15; detection_filter:track by_dst,count 2,seconds 3; metadata:impact_flag red; service:ftp; classtype:trojan-activity; sid:35029; rev:4; )"
59093,https://snort.org/rule_docs/1-59093,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Azrail outbound connection attempt""; flow:to_client,established; file_data; content:""<b><u>Software</u>:"",fast_pattern,nocase; content:""<b><u>Server IP</u>"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59093; rev:1; )"
30782,https://snort.org/rule_docs/1-30782,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 02|""; byte_jump:2,0,relative; content:""|18 03 02|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30782; rev:4; )"
58913,https://snort.org/rule_docs/1-58913,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.AcceptLanguage download attempt""; flow:to_client,established; file_data; content:""<?php"",nocase; content:""passthru(getenv("",distance 0,fast_pattern,nocase; content:""HTTP_ACCEPT_LANGUAGE"",within 30; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:58913; rev:1; )"
12793,https://snort.org/rule_docs/1-12793,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spy lantern Keylogger pro 6.0 runtime detection""; flow:to_server,established; flowbits:isset,SpyLanternKeylogger6_detection; content:""filename=|22|"",nocase; content:"".ltr"",distance 0,nocase; pcre:""/filename\x3D\x22[^\r\n]*\x2Eltr\x22/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12793; rev:7; )"
7176,https://snort.org/rule_docs/1-7176,['T1056'],"alert tcp $HOME_NET 868 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - log retrieve""; flow:to_client,established; flowbits:isset,ABSystemSpy_LogRetrieve; content:""FILEINFO|7C|""; classtype:successful-recon-limited; sid:7176; rev:7; )"
10098,https://snort.org/rule_docs/1-10098,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection - get system info""; flow:to_client,established; flowbits:isset,Win32.RemoteKeylog.b.info; content:""Product"",depth 7,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10098; rev:8; )"
60338,https://snort.org/rule_docs/1-60338,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.DiveShell outbound connection attempt""; flow:to_client,established; file_data; content:""command_hist[current_line] = document.shell.command.value|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60338; rev:1; )"
7179,https://snort.org/rule_docs/1-7179,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Keylogger desktop detective 2000 runtime detection - init connection""; flow:to_server,established; flowbits:isset,DesktopDetective_InitConnection1; content:""|FE FE FE FE 00 00 00 00|"",depth 8; content:""DDController"",distance 0,nocase; flowbits:set,DesktopDetective_InitConnection2; flowbits:noalert; classtype:successful-recon-limited; sid:7179; rev:5; )"
2146,https://snort.org/rule_docs/1-2146,['T1078'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP TextPortal admin.php default password 12345 attempt""; flow:to_server,established; http_uri; content:""/admin.php""; pkt_data; content:""op=admin_enter""; content:""password=12345"",fast_pattern,nocase; metadata:ruleset community; service:http; T1078; classtype:web-application-activity; sid:2146; rev:12; )"
30520,https://snort.org/rule_docs/1-30520,['T1123'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 00|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30520; rev:9; )"
49539,https://snort.org/rule_docs/1-49539,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER WordPress wp_user_roles configuration change attempt""; flow:to_server,established; http_uri; content:""/admin-ajax.php"",fast_pattern,nocase; http_client_body; content:""default_role"",nocase; content:""administrator"",within 45,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:49539; rev:1; )"
46070,https://snort.org/rule_docs/1-46070,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.yty file exfiltration outbound request""; flow:to_server,established; http_header; content:""Expect: 100-continue"",fast_pattern,nocase; http_client_body; content:""id="",depth 3; content:""&pc=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1020; classtype:trojan-activity; sid:46070; rev:4; )"
39734,https://snort.org/rule_docs/1-39734,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Win.Trojan.Xtrat outbound connection detected""; flow:to_server,established; http_uri; content:""/plugin.xtr"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:39734; rev:4; )"
32771,https://snort.org/rule_docs/1-32771,['T1566'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Adobe Invoice email scam phishing attempt""; flow:to_server,established; content:""Content-Disposition|3A 20|attachment"",nocase; content:""adb-"",within 50,nocase; content:""-invoice.zip"",within 12,distance 6,fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; classtype:trojan-activity; sid:32771; rev:3; )"
16269,https://snort.org/rule_docs/1-16269,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.tdss.1.gen install-time detection - findzproportal1.com""; flow:to_server,established; http_uri; content:""/botmon/readdata/""; pkt_data; content:""Host|3A| findzproportal1.com"",nocase; service:http; classtype:trojan-activity; sid:16269; rev:8; )"
7548,https://snort.org/rule_docs/1-7548,['T1056'],"alert udp $HOME_NET any -> $EXTERNAL_NET 15165 ( msg:""MALWARE-OTHER Keylogger activity monitor 3.8 runtime detection - agent up notification""; content:""|00 00 00 00 00 00 00 00|"",depth 8; classtype:successful-recon-limited; sid:7548; rev:8; )"
47847,https://snort.org/rule_docs/1-47847,['T1059'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_server,established; file_data; content:""powershell|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?powershell\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:47847; rev:4; )"
46048,https://snort.org/rule_docs/1-46048,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Gen variant outbound communication""; flow:to_server,established; http_raw_uri; bufferlen:6; http_uri; content:""/A56WY"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:46048; rev:2; )"
37299,https://snort.org/rule_docs/1-37299,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN installation attempt""; flow:to_server,established; http_header; content:""User-Agent: hola_get"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37299; rev:4; )"
38563,https://snort.org/rule_docs/1-38563,['T1056'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger fake 404 response""; flow:to_client,established; http_stat_code; content:""200""; http_stat_msg; content:""OK""; pkt_data; content:"">404 Not Found<"",fast_pattern,nocase; content:"" requested URL / was not found ""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38563; rev:4; )"
36304,https://snort.org/rule_docs/1-36304,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.WinPlock variant outbound connection""; flow:to_server,established; http_uri; content:""/wp-content/plugins/WPCoreLog/log.php?rnd="",fast_pattern,nocase; http_header; content:""WinHttp.WinHttpRequest.5""; http_client_body; content:""Run as Admin""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36304; rev:3; )"
59021,https://snort.org/rule_docs/1-59021,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.Antichat download attempt""; flow:to_client,established; file_data; content:""<?""; content:""Antichat Shell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59021; rev:1; )"
31301,https://snort.org/rule_docs/1-31301,['T1220'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-IE Microsoft Internet Explorer XSLT memory corruption attempt""; flow:to_server,established; file_data; content:""xmlns"",nocase; content:""|3A|xsl"",within 8,nocase; content:""http|2D|equiv|3D|"",nocase; content:""refresh"",within 10,nocase; content:""onunload"",fast_pattern,nocase; pcre:""/http\x2dequiv\x3d\s*?[\x22\x27]\s*?refresh\s*?[\x22\x27]\s*?content\s*?\x3d\s*?[\x22\x27]\s*?((1\s*?)|(0\s*?)|(\.\d\s*?)|(1\.\d\s*?))[\x22\x27]/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:31301; rev:5; )"
50953,https://snort.org/rule_docs/1-50953,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:"": ZWNobyAiP"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50953; rev:1; )"
10440,https://snort.org/rule_docs/1-10440,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger pc black box runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""PC"",distance 0,nocase; content:""Black"",distance 0,nocase; content:""Box"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*PC[^\r\n]*Black[^\r\n]*Box/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10440; rev:10; )"
59934,https://snort.org/rule_docs/1-59934,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt""; flow:to_server,established; http_uri; content:""${"",fast_pattern; content:""java"",distance 0; content:""|28|"",distance 0; content:""}"",distance 0; pcre:""/\x24\x7b[^\x7d]*?javax?\x2e[^\x7d]*?\x28/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:59934; rev:2; )"
44646,https://snort.org/rule_docs/1-44646,['T1021'],"alert tcp any any -> $HOME_NET 445 ( msg:""MALWARE-OTHER Win.Ransomware.BadRabbit propagation via SVCCTL remote service attempt""; flow:to_server,established; content:""|FE|SMB"",depth 4,offset 4; content:""|5C 00|r|00|u|00|n|00|d|00|l|00|l|00|3|00|2|00|.|00|e|00|x|00|e"",fast_pattern,nocase; content:""|5C 00|i|00|n|00|f|00|p|00|u|00|b|00|.|00|d|00|a|00|t"",nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:dcerpc; classtype:trojan-activity; sid:44646; rev:5; )"
33221,https://snort.org/rule_docs/1-33221,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot""; flow:to_server,established; content:""Subject|3A 20|=?utf-8?B?"",fast_pattern; content:""=?=|0D 0A|"",within 150; flowbits:set,hawk.lgr; flowbits:noalert; metadata:ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:33221; rev:8; )"
7178,https://snort.org/rule_docs/1-7178,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger desktop detective 2000 runtime detection - init connection""; flow:to_client,established; content:""|FE FE FE FE|90|00 00|"",depth 8; content:""Private"",distance 0,nocase; content:""Server,"",distance 0,nocase; content:""Login"",distance 0,nocase; content:""Required"",distance 0,nocase; flowbits:set,DesktopDetective_InitConnection1; flowbits:noalert; classtype:successful-recon-limited; sid:7178; rev:7; )"
60590,https://snort.org/rule_docs/1-60590,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Perl.Webshell.GoShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".cgi?"",nocase; content:""cmd="",fast_pattern,nocase; content:""dir="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60590; rev:1; )"
60285,https://snort.org/rule_docs/1-60285,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CrewShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?"",nocase; content:""&file_browser&file="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60285; rev:1; )"
12131,https://snort.org/rule_docs/1-12131,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - keylogging""; flow:to_client,established; content:""WND"",depth 3; flowbits:set,RemoteKeyLog.b.Keylogging_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:12131; rev:6; )"
7514,https://snort.org/rule_docs/1-7514,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger watchdog runtime detection - send out info to server periodically""; flow:to_server,established; content:""S|3A|Users"",fast_pattern,nocase; pcre:""/^S\x3aUsers\x5c\d+\x2cSTATSTimeTotal/ims""; metadata:impact_flag red; classtype:successful-recon-limited; sid:7514; rev:9; )"
13778,https://snort.org/rule_docs/1-13778,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger kgb employee monitor runtime detection""; flow:to_server,established; content:""<TIT= LE> KGB log </TITLE>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13778; rev:8; )"
50466,https://snort.org/rule_docs/1-50466,['T1187'],"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_server,established; content:""|FF|SMB|2D|"",depth 5,offset 4; content:""|0F FF 00|"",within 3,distance 27; content:""|16 00 20 00 40 9D C1 57 01 00|"",within 10,distance 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50466; rev:1; )"
58786,https://snort.org/rule_docs/1-58786,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""%2524{"",fast_pattern,nocase; pcre:""/%2524\x7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58786; rev:4; )"
38387,https://snort.org/rule_docs/1-38387,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection""; flow:to_server,established; content:""STOR Screenshot from|3A 20|"",fast_pattern; content:""|29|.png"",within 80; metadata:impact_flag red,ruleset community; service:ftp; T1056; classtype:trojan-activity; sid:38387; rev:2; )"
38641,https://snort.org/rule_docs/1-38641,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION Invalid header line evasion attempt""; flow:to_client,established; http_header; content:""|0D 0A|""; content:""|0D 0A|"",within 15; pcre:""/\r\n[\x20\t]*?[:\x20]+?[\w\x2d]*?\r\n/i""; metadata:policy max-detect-ips drop; service:http; classtype:non-standard-protocol; sid:38641; rev:6; )"
19106,https://snort.org/rule_docs/1-19106,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Keylogger Ardamax keylogger runtime detection - http""; flow:to_server,established; http_uri; content:""/pub/u1.php?v=""; content:""&pr=""; content:""&id=""; content:""&rn=""; metadata:policy max-detect-ips drop; service:http; classtype:trojan-activity; sid:19106; rev:6; )"
11250,https://snort.org/rule_docs/1-11250,['T1014'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Sony Rootkit Uninstaller ActiveX clsid access""; flow:to_client,established; file_data; content:""4EA7C4C5-C5C0-4F5C-A008-8293505F71CC"",fast_pattern,nocase; pcre:""/<object\s*[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*4EA7C4C5-C5C0-4F5C-A008-8293505F71CC\s*}?\s*(?P=q1)(\s|>)/is""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:11250; rev:12; )"
27957,https://snort.org/rule_docs/1-27957,['T1014'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit download attempt""; flow:to_client,established; file_data; content:""|22|opener: Finished move to System Library StartupItems |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:27957; rev:3; )"
30787,https://snort.org/rule_docs/1-30787,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|18 03 02|""; byte_jump:2,0,relative; content:""|18 03 02|"",within 3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30787; rev:5; )"
14074,https://snort.org/rule_docs/1-14074,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spybosspro 4.2 runtime detection""; flow:to_server,established; content:""Subject|3A| SpyBoss Pro - Log File Mailing"",fast_pattern,nocase; content:""X-Mailer|3A| SpyBoss Pro"",nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:14074; rev:8; )"
50098,https://snort.org/rule_docs/1-50098,['T1566'],"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; file_data; content:""Welcome To Spider Shell!"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:50098; rev:1; )"
60299,https://snort.org/rule_docs/1-60299,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Cybershell upload attempt""; flow:to_server,established; file_data; content:""header(|22|Expires: |22|.date(|22|r|22|,mktime(0,0,0,1,1,2030)))|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60299; rev:1; )"
19925,https://snort.org/rule_docs/1-19925,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Novell iPrint ActiveX client browser plugin call-back-url buffer overflow attempt""; flow:to_client,established; file_data; content:""clsid|3A|36723F97-7AA0-11D4-8919-FF2D71D0D32C"",fast_pattern,nocase; content:""call-back-url""; pcre:""/name\s*=\s*(?P<q1>\x22|\x27|)call-back-url(?P=q1)/ims""; pcre:""/value\s*=\s*[\x27\x22][^\x27\x22]{257}/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19925; rev:8; )"
50948,https://snort.org/rule_docs/1-50948,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:""Phpspl01T:"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50948; rev:1; )"
60506,https://snort.org/rule_docs/1-60506,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.FTPSearch outbound connection attempt""; flow:to_client,established; file_data; content:""[+] Founded"",nocase; content:""entrys in /etc/passwd"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60506; rev:1; )"
7847,https://snort.org/rule_docs/1-7847,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger clogger 1.0 runtime detection - send log through email""; flow:to_server,established; flowbits:isset,Clogger_SendLogOut2; content:""<----------- Fin du Fichier ----------- >"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:7847; rev:8; )"
59024,https://snort.org/rule_docs/1-59024,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.Antichat outbound connection attempt""; flow:to_client,established; file_data; content:""<a href|3D 22 23 22| onclick|3D 22|document|2E|reqs|2E|action|2E|value|3D 27|shell|27 3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59024; rev:1; )"
10096,https://snort.org/rule_docs/1-10096,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection - keylog""; flow:to_client,established; content:""KEY"",depth 3,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10096; rev:10; )"
58740,https://snort.org/rule_docs/1-58740,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""%24%7b"",fast_pattern,nocase; pcre:""/%24%7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58740; rev:6; )"
57797,https://snort.org/rule_docs/1-57797,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION Javascript obfuscation using parseInt""; flow:to_client,established; file_data; content:""body onload=""; content:""new Number|28|""; content:""))))"",within 250; content:""parseInt|28|"",within 250; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:57797; rev:1; )"
12771,https://snort.org/rule_docs/1-12771,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated BaoFeng Storm MPS.dll ActiveX exploit attempt""; flow:to_client,established; file_data; content:""storm.setAttribute|28 22|classid|22|,|22|clsid|3A|6BE52E1D-E586-474f-A6E2-1A85A9B4D9FB|22 29|"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12771; rev:12; )"
12048,https://snort.org/rule_docs/1-12048,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger computer Keylogger runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""ComputerKeylogger.com"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*ComputerKeylogger\x2Ecom/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12048; rev:6; )"
5742,https://snort.org/rule_docs/1-5742,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger activitylogger runtime detection""; flow:to_server,established; content:""X-Mailer|3A| SoftActivity Mailer"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5742; rev:11; )"
60453,https://snort.org/rule_docs/1-60453,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Erne outbound connection attempt""; flow:to_client,established; file_data; content:""<option value="",nocase; content:""passthru"",within 10,nocase; content:"">passthru</option>"",within 20,fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60453; rev:1; )"
24705,https://snort.org/rule_docs/1-24705,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP CA Total Defense management.asmx sql injection attempt""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/UNCWS/Management.asmx"",fast_pattern,nocase; http_header; content:""SOAP"",nocase; http_client_body; pcre:""/<SelectedID>[^<]+?(\x3B|%3B)/im""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:24705; rev:10; )"
30512,https://snort.org/rule_docs/1-30512,['T1123'],"alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt""; flow:to_server,established,only_stream; content:""|18 03 02|"",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30512; rev:8; )"
44564,https://snort.org/rule_docs/1-44564,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; content:""HTTP/1.1|0D 0A|Cookie: SESSION"",fast_pattern,nocase; http_cookie; pcre:""/^session(id)?=[a-z0-9\x2b\x2f]{27}=$/im""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:44564; rev:5; )"
7512,https://snort.org/rule_docs/1-7512,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Keylogger watchdog runtime detection - init connection - flowbit set""; flow:to_client,established; content:""N|3A|UC|3A|"",fast_pattern,nocase; pcre:""/^N\x3aUC\x3a\d+\x2c\d+\x2e\d+\x2e\d+\x2e\d+\x2c/ims""; flowbits:set,WatchDog_Init_Connection; flowbits:noalert; classtype:successful-recon-limited; sid:7512; rev:7; )"
18717,https://snort.org/rule_docs/1-18717,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Banker.QO variant outbound connection""; flow:to_server,established; http_client_body; content:""RooTKit+By+Iron+Mask+%2D+Espanha"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:18717; rev:12; )"
45352,https://snort.org/rule_docs/1-45352,['T1059'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC PowerShell Empire HTTP listener response""; flow:to_client,established; http_header; content:""Content-Length: 233|0D 0A|"",fast_pattern,nocase; content:""Expires: 0|0D 0A|"",nocase; content:""Cache-Control: no-cache, no-store, must-revalidate|0D 0A|"",nocase; content:""Pragma: no-cache|0D 0A|"",nocase; http_stat_msg; content:""Not Found"",nocase; http_header; content:!""Set-Cookie: "",nocase; content:!""|0D 0A|X-"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:45352; rev:3; )"
39130,https://snort.org/rule_docs/1-39130,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Obfuscated exploit download attempt""; flow:to_client,established; file_data; content:""87,115,99,114,105,112,116,37,50,69,83,104,101,108,108"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:39130; rev:2; )"
48532,https://snort.org/rule_docs/1-48532,['T1220'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-IE Microsoft Internet Explorer 11 VBScript execution policy bypass attempt""; flow:to_server,established; file_data; content:""ex = xml.transformNode(xsl)|3B 20|document.getElementById"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:attempted-user; sid:48532; rev:2; )"
51633,https://snort.org/rule_docs/1-51633,['T1027'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""INDICATOR-OBFUSCATION JavaScript exploit obfuscation attempt""; flow:to_server,established; file_data; content:""<body onload=|22|""; content:""parseInt|28 22|"",within 150,distance 25,fast_pattern; content:""unescape|28|"",within 150,distance 25; content:""String.fromCharCode|28|"",within 150,distance 25; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:51633; rev:1; )"
48740,https://snort.org/rule_docs/1-48740,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Tridium Niagara default administrator account login attempt""; flow:to_server,established; http_uri; content:""/niagara/"",fast_pattern,nocase; pkt_data; content:""Authorization|3A|"",nocase; content:""Basic"",distance 0,nocase; base64_decode:bytes 64,offset 0,relative; base64_data; pcre:""/^administrator\x3a\x20$/""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:48740; rev:2; )"
12135,https://snort.org/rule_docs/1-12135,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - fun""; flow:to_server,established; content:""fun"",depth 3; flowbits:set,RemoteKeyLog.b.Fun_detection; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:12135; rev:6; )"
21038,https://snort.org/rule_docs/1-21038,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION String.fromCharCode with multiple encoding types detected""; flow:to_client,established; content:""String.fromCharCode"",fast_pattern,nocase; pcre:""/String\x2efromCharCode\s*\x28[^\x29]*0x[0-9a-f]{2}\s*,[^\x29]*,\s*0[0-7]{1,3}\s*,[^\x29]*,\s*[1-9][0-9]{0,2}\s*,/ims""; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:21038; rev:9; )"
32105,https://snort.org/rule_docs/1-32105,['T1218'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Oracle WebCenter Content CheckOutAndOpen.dll ActiveX control code execution ActiveX function call access""; flow:to_client,established; file_data; content:""CheckOutAndOpen.Control"",fast_pattern,nocase; content:"".coao|28|"",nocase; content:"".hta"",nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:32105; rev:8; )"
234,https://snort.org/rule_docs/1-234,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 27665 ( msg:""MALWARE-OTHER Trin00 Attacker to Master default password""; flow:to_server,established; content:""gOrave""; metadata:ruleset community; T1078; classtype:attempted-dos; sid:234; rev:9; )"
23612,https://snort.org/rule_docs/1-23612,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt""; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:""<template xmlns=""; content:""http|3A|//www.xfa.org/"",distance 1; content:""<event activity"",distance 0; content:""initialize"",within 50,distance 1; content:""application/x-javascript"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:23612; rev:11; )"
42300,https://snort.org/rule_docs/1-42300,['T1078'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""SERVER-WEBAPP SensorIP2 default credentials enumeration attempt""; flow:to_client,established; file_data; content:""<select class=|22|drpdwn|22| name=|22|user|22| onchange=|22|setpasswd()|22|>"",fast_pattern,nocase; content:""<option value=|22|""; content:""<input class=|22|stxt|22| type=|22|password|22| size=|22|"",distance 0; content:""maxlength=|22|"",distance 0; content:""name=|22|passwd|22| value=|22|"",distance 0; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:42300; rev:3; )"
14065,https://snort.org/rule_docs/1-14065,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Keylogger emptybase j runtime detection""; flow:to_server,established; content:""/th/script.php?"",nocase; content:""boundary=--__abcd-xyz789__--"",distance 0,nocase; content:""name=|22|Module|22 0D 0A 0D 0A|"",distance 0,nocase; content:""IE"",distance 0,nocase; pcre:""/name\x3d\x22Module\x22\x0d\x0a\x0d\x0a(IEGrabber|IEInjector|IEFaker|IEKeylogger|IETanGrabber|IEScrGrabber|IECertGrab|IEFileGrabber)/ims""; metadata:policy max-detect-ips drop; service:http; classtype:successful-recon-limited; sid:14065; rev:7; )"
10183,https://snort.org/rule_docs/1-10183,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger activity Keylogger runtime detection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""Activity"",distance 0,nocase; content:""Keylogger"",distance 0,nocase; content:""Logs"",distance 0,nocase; pcre:""/^Subject\x3a[^\r\n]*Activity[^\r\n]*Keylogger[^\r\n]*Logs/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10183; rev:11; )"
19037,https://snort.org/rule_docs/1-19037,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:6667 ( msg:""MALWARE-CNC Win.Trojan.IRCBrute.I variant outbound connection""; flow:to_server,established; flowbits:isset,trojan.ircbrute_i; content:""JOIN|20 23 23|"",depth 7,nocase; content:""|23 23|"",within 8,distance 2; pcre:""/^JOIN\s\x23\x23\S{2,6}\x23\x23\s?\x0D\x0A/im""; classtype:trojan-activity; sid:19037; rev:8; )"
56607,https://snort.org/rule_docs/1-56607,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC potential Rat.Tool.CSBundleUSAToday connectivity check""; flow:to_server,established; http_cookie; content:""gnt_ub=86|5C 3B|gnt_sb=18|5C 3B|usprivacy=1YNY|5C 3B|DigiTrust.v1.identity=""; http_header; content:""Host: www.usatoday.com""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56607; rev:1; )"
58728,https://snort.org/rule_docs/1-58728,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""${lower:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58728; rev:5; )"
48819,https://snort.org/rule_docs/1-48819,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Trojan.Agent variant inbound payload download""; flow:to_server,established; http_uri; content:""/blogs/enc7.js"",fast_pattern,nocase; http_raw_uri; bufferlen:14; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:48819; rev:1; )"
41444,https://snort.org/rule_docs/1-41444,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Ransomware.X-Mas variant keylogger outbound connection""; flow:to_server,established; http_uri; content:""/gate.php?"",fast_pattern,nocase; http_client_body; content:""|3C|br|3E 3C|br|3E 3C|b|3E 3C|big|3E 3C|font color=|22|""; content:""|22 3E 20 5B|"",within 12; http_header; content:!""Accept-""; content:!""Referer""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:41444; rev:4; )"
56599,https://snort.org/rule_docs/1-56599,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original stager outbound connection attempt""; flow:to_server,established; http_header; content:""Accept: */*""; content:""Accept-Language: en-US""; content:""Accept-Encoding: gzip, deflate""; http_cookie; content:""Cookie: SIDCC=AN0-TYutOSq-fxZK6e4kagm70VyKACiG1susXcYRuxK08Y-rHysliq0LWklTqjtulAhQOPH8uA""; http_uri; content:""/api/v1/user""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56599; rev:1; )"
25521,https://snort.org/rule_docs/1-25521,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""OS-MOBILE Android User-Agent detected""; flow:to_server,established; http_header; content:""User-Agent|3A|""; content:""android"",distance 0,fast_pattern,nocase; pcre:""/^User-Agent\x3a[^\r\n]*android/i""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:policy-violation; sid:25521; rev:4; )"
29608,https://snort.org/rule_docs/1-29608,['T1190'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP McAfee ePO showRegisteredTypeDetails.do sql injection attempt""; flow:to_server,established; http_uri; content:""/core/showRegisteredTypeDetails.do"",depth 34,fast_pattern; pkt_data; content:""uid|3D|""; pcre:""/uid\x3D\d{0,10}?[A-Za-z\x3B\x25]/""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:29608; rev:3; )"
61161,https://snort.org/rule_docs/1-61161,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC JSP.Webshell.JSP2Shell inbound connection""; flow:to_server,established; http_uri; content:"".jsp"",nocase; http_client_body; content:""command="",depth 8,fast_pattern; content:""&Submit="",within 250; content:!""&"",within 500; metadata:impact_flag red,policy max-detect-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61161; rev:1; )"
44562,https://snort.org/rule_docs/1-44562,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; http_uri; content:""/login/process.php"",fast_pattern,nocase; http_cookie; content:""SESSION""; http_header; content:""User-Agent: Mozilla/5.0 (Windows NT 6.1|3B| WOW64|3B| Trident/7.0|3B| rv:11.0) like Gecko""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:44562; rev:4; )"
44388,https://snort.org/rule_docs/1-44388,['T1003'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Multiple routers getcfg.php credential disclosure attempt""; flow:to_server,established; http_uri; content:""/getcfg.php"",fast_pattern,nocase; http_client_body; pcre:""/(\n|%0A)(A|%41)(U|%55)(T|%54)(H|%48)/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-recon; sid:44388; rev:6; )"
43673,https://snort.org/rule_docs/1-43673,['T1027'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-FIREFOX Mozilla products obfuscated cross site scripting attempt""; flow:to_server,established; file_data; content:""&#xdc"",fast_pattern,nocase; content:""&#xdc""; content:""&#xdc"",distance 0; content:""&#xdc"",distance 0; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-admin; sid:43673; rev:3; )"
12773,https://snort.org/rule_docs/1-12773,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated Xunlei Thunder PPLAYER.DLL ActiveX exploit attempt""; flow:to_client,established; file_data; content:""<object id=|22|gl|22| classid=|22|clsid|3A|F3E70CEA-956E-49CC-B444-73AFE593AD7F|22|>"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12773; rev:12; )"
30777,https://snort.org/rule_docs/1-30777,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|16 03 00|""; byte_jump:2,0,relative; content:""|18 03 00|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30777; rev:4; )"
7515,https://snort.org/rule_docs/1-7515,['T1056'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger watchdog runtime detection - remote monitoring""; flow:to_client,established; http_header; content:""Server|3A|"",nocase; content:""WatchDog"",fast_pattern,nocase; content:""Server"",nocase; pcre:""/Server\x3a[^\r\n]*WatchDog[^\r\n]*Server/ims""; metadata:impact_flag red; service:http; classtype:successful-recon-limited; sid:7515; rev:11; )"
59351,https://snort.org/rule_docs/1-59351,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.SmallShell upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""$cmd"",nocase; content:""($_REQUEST["",within 16,nocase; content:""cmd"",within 4,nocase; content:""])|3B|"",within 4; content:""system($cmd)|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59351; rev:1; )"
20593,https://snort.org/rule_docs/1-20593,['T1220'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-WEBKIT Apple Safari Webkit libxslt arbitrary file creation attempt""; flow:to_client,established; file_data; content:""http://icl.com/saxon"",fast_pattern,nocase; content:"":output"",nocase; pcre:""/\s*[^>]file=/Ri""; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:20593; rev:11; )"
59932,https://snort.org/rule_docs/1-59932,['T1094'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Behinder upload attempt""; flow:to_server,established; content:""<%""; content:""java.util.*""; content:""extends ClassLoader"",fast_pattern,nocase; content:""defineClass""; content:""getInstance(|22|AES|22|)""; content:""decodeBuffer"",distance 0; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59932; rev:2; )"
49459,https://snort.org/rule_docs/1-49459,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Perl webshell upload attempt""; flow:to_server,established; file_data; content:""|FF D8 FF|"",depth 3; content:""/usr/bin/perl"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49459; rev:2; )"
49451,https://snort.org/rule_docs/1-49451,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER ASP webshell upload attempt""; flow:to_server,established; file_data; content:""|FF D8 FF|"",depth 3; content:""<%"",distance 0; content:""language"",within 25,nocase; content:""%>"",within 35; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49451; rev:2; )"
44689,https://snort.org/rule_docs/1-44689,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Gen variant outbound connection""; flow:to_server,established; http_uri; content:""/aspnet_client/system_web/4_0_30319/update/"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:44689; rev:3; )"
12698,https://snort.org/rule_docs/1-12698,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger net vizo 5.2 runtime detection""; flow:to_server,established; content:""This is an alert notification from NetVizor"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12698; rev:9; )"
58751,https://snort.org/rule_docs/1-58751,['T1190'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; content:""|24 7B|"",fast_pattern,nocase; pcre:""/^[\w\x2d\x20]+\x3a[^\r\n]*?\x24\x7b(jndi|lower|upper)\x3a/im""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; classtype:attempted-user; sid:58751; rev:4; )"
58727,https://snort.org/rule_docs/1-58727,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""${jndi:"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58727; rev:5; )"
58736,https://snort.org/rule_docs/1-58736,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""upper"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58736; rev:4; )"
61160,https://snort.org/rule_docs/1-61160,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC JSP.Webshell.JSP2Shell outbound connection""; flow:to_client,established; file_data; content:""<title>JspWebShell By "",fast_pattern,nocase; content:""</title>"",within 50,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61160; rev:1; )"
60586,https://snort.org/rule_docs/1-60586,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Perl.Webshell.GammaShell inbound connection attempt""; flow:to_server,established; http_client_body; content:""action=execute&command="",depth 23,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60586; rev:1; )"
59048,https://snort.org/rule_docs/1-59048,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Generic outbound connection attempt""; flow:to_client,established; file_data; content:""<script type="",nocase; content:""|2F|javascript"",within 30; content:""function tukar("",within 300,fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59048; rev:1; )"
30003,https://snort.org/rule_docs/1-30003,['T1189'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""EXPLOIT-KIT Hello/LightsOut exploit kit payload download attempt""; flow:to_server,established; http_uri; content:"".php?a=dw"",fast_pattern,nocase; pcre:""/\?a=dw[a-z]$/""; http_header; content:"" Java/1.""; flowbits:set,file.exploit_kit.pe; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1189; classtype:trojan-activity; sid:30003; rev:6; )"
1141,https://snort.org/rule_docs/1-1141,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP handler access""; flow:to_server,established; http_uri; content:""/handler"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1141; rev:19; )"
32366,https://snort.org/rule_docs/1-32366,['T1204'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""OS-OTHER Bash environment variable injection attempt""; flow:to_server,established; content:""() {""; content:""}"",within 25; pcre:""/^[\w\x2d\x5f]+?\x3a\s*?\x28\x29\s\x7b/im""; metadata:policy max-detect-ips drop,ruleset community; service:smtp; classtype:attempted-admin; sid:32366; rev:2; )"
1808,https://snort.org/rule_docs/1-1808,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP Apache chunked-encoding memory corruption exploit attempt""; flow:to_server,established; http_header; content:""|C0|PR|89 E1|PQRP|B8 3B 00 00 00 CD 80|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:1808; rev:17; )"
47070,https://snort.org/rule_docs/1-47070,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER Arris VAP2500 default credentials authentication attempt""; flow:to_server,established; http_uri; content:""/login.php""; pkt_data; content:""user=SuperATT"",fast_pattern,nocase; content:""pwd=""; pcre:""/pwd=DC(\x21|%21)94(\x40|%40)B3/i""; service:http; classtype:policy-violation; sid:47070; rev:4; )"
11309,https://snort.org/rule_docs/1-11309,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger sskc v2.0 runtime detection""; flow:to_server,established; content:""SSKC"",nocase; content:""v2.0"",distance 0,nocase; content:""Startup"",distance 0,nocase; content:""at"",distance 0,nocase; pcre:""/^SSKC[^\r\n]*v2\x2E0[^\r\n]*Startup[^\r\n]*at/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:11309; rev:8; )"
1859,https://snort.org/rule_docs/1-1859,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:""SERVER-WEBAPP Oracle JavaServer default password login attempt""; flow:to_server,established; content:""/servlet/admin""; content:""ae9f86d6beaa3f9ecb9a5b7e072a4138""; metadata:ruleset community; service:http; T1078; classtype:default-login-attempt; sid:1859; rev:14; )"
59025,https://snort.org/rule_docs/1-59025,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.Antichat inbound connection attempt""; flow:to_server,established; http_client_body; content:""action="",nocase; content:""&dir="",distance 0,fast_pattern,nocase; content:""&file="",distance 0,nocase; http_uri; content:"".php"",nocase; http_client_body; pcre:""/^action=[^&]*?&dir=[^&]*?&file=[^&]*?$/i""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59025; rev:1; )"
31977,https://snort.org/rule_docs/1-31977,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; http_uri; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:31977; rev:5; )"
27959,https://snort.org/rule_docs/1-27959,['T1014'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit upload attempt""; flow:to_server,established; file_data; content:""|22|opener: Finished gather system-wide info |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:27959; rev:3; )"
42944,https://snort.org/rule_docs/1-42944,['T1190'],"alert tcp any any -> $HOME_NET 445 ( msg:""OS-WINDOWS Microsoft Windows SMB remote code execution attempt""; flow:to_server,established; content:""|FF|SMB|A0 00 00 00 00|"",depth 9,offset 4; content:""|01 00 00 00 00|"",within 5,distance 59; byte_test:4,>,0x8150,-33,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; classtype:attempted-admin; sid:42944; rev:2; )"
36611,https://snort.org/rule_docs/1-36611,['T1189'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""INDICATOR-COMPROMISE Metasploit Meterpreter reverse HTTPS certificate""; flow:to_client,established; content:""|16 03 01|""; content:""|0B|"",within 1,distance 2; content:""|30 82|"",within 2,distance 9; content:""|30 82|"",within 2,distance 2; content:""|A0 03 02 01 02 02|"",within 6,distance 2; content:""|30 0D 06 09 2A 86 48 86 F7 0D 01 01|"",within 22; content:""|31|"",within 1,distance 5; content:""|30|"",within 1,distance 1; content:""|06 03 55 04 03 0C|"",within 6,distance 1; byte_extract:1,0,string_size,relative; content:""|30|"",within 1,distance string_size; content:""|17 0D|"",within 2,distance 1; content:""Z|17 0D|"",within 3,distance 12; content:""Z|30|"",within 2,distance 12; content:""|31|"",within 1,distance 1; content:""|30|"",within 1,distance 1; content:""|06 03 55 04 03 0C|"",within 6,distance 1; byte_extract:1,0,string_size,relative; content:""|30 82|"",within 2,distance string_size; content:""|30 0D 06 09 2A 86 48 86 F7 0D 01 01 01 05 00 03 82|"",within 17,distance 2; content:""|30 82|"",within 2,distance 3; content:""|02 82|"",within 2,distance 2; content:""|02 03 01 00 01 A3 0D 30 0B 30 09 06 03 55 1D 13 04 02 30 00 30 0D 06 09 2A 86 48 86 F7 0D 01 01 0B 05 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; classtype:misc-activity; sid:36611; rev:4; )"
56609,https://snort.org/rule_docs/1-56609,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Cobalt Strike beacon outbound connection attempt""; flow:to_server,established; http_uri; content:""/v1/push""; http_header; content:""Accept: */*""; content:""Accept-Encoding: gzip, deflate, br""; content:""Accept-Language: en-US|0D 0A|""; content:""{|22|locale|22|:|22|en|22|,|22|channel|22|:|22|prod|22|,|22|addon|22|:|22|"",fast_pattern,nocase; content:""cli""; content:""l-""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56609; rev:1; )"
33886,https://snort.org/rule_docs/1-33886,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC WIn.Trojan.HawkEye keylogger variant outbound connection""; flow:to_server,established; content:""STOR HawkEye_"",fast_pattern,nocase; metadata:impact_flag red; service:ftp; classtype:trojan-activity; sid:33886; rev:3; )"
13236,https://snort.org/rule_docs/1-13236,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger active Keylogger 3.9.2 runtime detection""; flow:to_server,established; content:""Attached"",nocase; content:""|28|ZIP"",distance 0,nocase; content:""file|29|"",distance 0,nocase; content:""to"",distance 0,nocase; content:""this"",distance 0,nocase; content:""email"",distance 0,nocase; content:""are"",distance 0,nocase; content:""the"",distance 0,nocase; content:""activity"",distance 0,nocase; content:""logs"",distance 0,nocase; content:""that"",distance 0,nocase; content:""you"",distance 0,nocase; content:""have"",distance 0,nocase; content:""requested."",distance 0,nocase; pcre:""/Attached\s+\x28ZIP\s+file\x29\s+to\s+this\s+email\s+are\s+the\s+activity\s+logs\s+that\s+you\s+have\s+requested\x2E/ims""; flowbits:set,ActiveKeylogger392_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13236; rev:7; )"
52622,https://snort.org/rule_docs/1-52622,['T1059'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt""; flow:to_server,established; file_data; content:""window.onkeydown=function(e){if(""; content:""keyCode=="",within 100; content:""document.location.href="",within 1000; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:52622; rev:1; )"
26774,https://snort.org/rule_docs/1-26774,['T1218'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Worm.Luder variant outbound connection""; flow:to_server,established; http_uri; content:""/loader.cpl"",fast_pattern,nocase; pcre:""/\/loader\.cpl$/""; http_header; content:""|3B 20|MSIE|20|""; content:!""|0D 0A|Accept-Language:""; metadata:impact_flag red,ruleset community; service:http; T1196; classtype:trojan-activity; sid:26774; rev:4; )"
37392,https://snort.org/rule_docs/1-37392,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Schneider default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""QWRtaW5pc3RyYXRvcjpHYXRld2F5"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37392; rev:3; )"
37302,https://snort.org/rule_docs/1-37302,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""APP-DETECT Hola VPN X-Hola-Version header nonstandard port attempt""; flow:to_server,established; content:""X-Hola-Version:"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:37302; rev:3; )"
29383,https://snort.org/rule_docs/1-29383,['T1021'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""APP-DETECT VPN Over DNS application download attempt""; flow:to_server,established; flowbits:isset,file.apk|file.zip; file_data; content:""assets/dns160.png"",fast_pattern,nocase; content:""assets/dns240.png"",nocase; content:""assets/dns320.png"",within 150,nocase; content:""assets/fond-Snow-UI-Kit-2.png"",within 150,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:policy-violation; sid:29383; rev:4; )"
23986,https://snort.org/rule_docs/1-23986,['T1176'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-PLUGINS Apple Quicktime plugin SetLanguage buffer overflow attempt""; flow:to_server,established; file_data; content:""<object"",nocase; content:""02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"",within 200; content:""<EMBED"",nocase; content:""SRC="",distance 0,nocase; content:""PLUGINSPAGE"",distance 0; content:""SetLanguage|28 22|"",nocase; content:!""|22|"",within 512; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:attempted-user; sid:23986; rev:10; )"
5759,https://snort.org/rule_docs/1-5759,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger fearlesskeyspy runtime detection""; flow:to_server,established; content:""STOR"",nocase; content:""FKS_"",distance 0,nocase; pcre:""/^STOR\s+FKS_\w+_\d+-\d+-\d+\.log/i""; service:ftp; classtype:successful-recon-limited; sid:5759; rev:7; )"
9649,https://snort.org/rule_docs/1-9649,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger ghost Keylogger runtime detection - flowbit set""; flow:to_server,established; content:""|23|"",nocase; content:""Ghost"",distance 0,nocase; content:""keylogger"",distance 0,nocase; content:""has"",distance 0,nocase; content:""started"",distance 0,nocase; pcre:""/^\x23\s+Ghost\s+Keylogger\s+has\s+started\x2E/ims""; flowbits:set,ghost_keylogger_start; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:9649; rev:6; )"
12759,https://snort.org/rule_docs/1-12759,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger/RAT digi watcher 2.32 runtime detection""; flow:to_server,established; flowbits:isset,DigiWatcher232_detection; content:""Motion"",nocase; content:""detected!"",distance 0,nocase; content:""Watcher"",distance 0,nocase; content:""PC"",distance 0,nocase; content:""IP"",distance 0,nocase; content:""address|3A|"",distance 0,nocase; pcre:""/Motion\s+detected\x21/ims""; pcre:""/Watcher\s+PC\s+IP\s+address\x3A/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12759; rev:7; )"
60498,https://snort.org/rule_docs/1-60498,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Exoshell outbound connection attempt""; flow:to_client,established; file_data; content:""<b>Current-path : </b>"",fast_pattern,nocase; content:""<b>Os : </b>"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60498; rev:1; )"
47846,https://snort.org/rule_docs/1-47846,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_client,established; file_data; content:""powershell|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?powershell\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:47846; rev:4; )"
24436,https://snort.org/rule_docs/1-24436,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Novell ZENworks Asset Management default admin credentials function call attempt""; flow:to_server,established; http_uri; content:""/rtrlet/rtr"",fast_pattern,nocase; content:""username=ivanhoe"",nocase; content:""password=scott"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:24436; rev:8; )"
13767,https://snort.org/rule_docs/1-13767,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger cyber sitter runtime detection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""CYBERsitter"",distance 0,nocase; content:""Report"",distance 0,nocase; content:""for|3A|"",distance 0,nocase; pcre:""/Subject\x3A[^\r\n]*CYBERsitter\s+Report\s+for\x3A/ims""; flowbits:set,cyberSitter_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13767; rev:7; )"
19899,https://snort.org/rule_docs/1-19899,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Tong Keylogger outbound connectiooutbound connection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""KeyLogged"",distance 0,nocase; content:""from"",distance 0,nocase; flowbits:set,backdoor.tongkeylogger; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:trojan-activity; sid:19899; rev:7; )"
33983,https://snort.org/rule_docs/1-33983,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Nuclear exploit kit obfuscated file download""; flow:to_client,established; content:""Content-Disposition|3A 20|inline|3B 20|filename=|0D 0A 0D 0A 3F 0B D4 6C 4F 48 61 50|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:33983; rev:5; )"
56321,https://snort.org/rule_docs/1-56321,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER IBM Spectrum Protect Plus admin credentials reset attempt""; flow:to_server,established; http_uri; content:""/emi/api/changeadministratorpassword"",fast_pattern,nocase; http_client_body; content:""cpassword=sppDP758-SysXyz""; service:http; classtype:policy-violation; sid:56321; rev:3; )"
47867,https://snort.org/rule_docs/1-47867,['T1059'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Html.Dropper.Xbash variant obfuscated powershell invocation""; flow:to_server,established; file_data; content:""|5C|x70|5C|x6F|5C|x77|5C|x65|5C|x72|5C|x73|5C|x68|5C|x65|5C|x6C|5C|x6C|5C|x2E|5C|x65|5C|x78|5C|x65|5C|x20|5C|x2D|5C|x65|5C|x78|5C|x65|5C|x63|5C|x75|5C|x74|5C|x69|5C|x6F|5C|x6E|5C|x70|5C|x6F|5C|x6C|5C|x69|5C|x63|5C|x79|5C|x20|5C|x62|5C|x79|5C|x70|5C|x61|5C|x73|5C|x73"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:47867; rev:2; )"
57336,https://snort.org/rule_docs/1-57336,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER F5 iControl REST interface tm.util.bash invocation attempt""; flow:to_server,established; http_uri; content:""/mgmt/tm/util/bash"",fast_pattern,nocase; http_client_body; content:""command"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:policy-violation; sid:57336; rev:3; )"
46065,https://snort.org/rule_docs/1-46065,['T1197'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Ransomware.Sigma outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:10; http_uri; content:""/email.bin"",fast_pattern,nocase; http_header; content:""User-Agent: Microsoft BITS/"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:46065; rev:2; )"
13642,https://snort.org/rule_docs/1-13642,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger easy Keylogger runtime detection""; flow:to_server,established; content:""DQp+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fg0KV2luZG93IFRpd"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13642; rev:7; )"
38560,https://snort.org/rule_docs/1-38560,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger outbound connection - screenshot""; flow:to_server,established; http_uri; content:""/News/gate.php?"",fast_pattern,nocase; http_client_body; content:""JFIF""; http_uri; pcre:""/\/News\/gate\.php\x3f[a-f0-9]{32}\x3d\d/i""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38560; rev:3; )"
50093,https://snort.org/rule_docs/1-50093,['T1187'],"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; http_header; content:""X-Powered-By: ASP.NC0CD7B7802C76736E9B26FB19BEB2D36290B9FF9A46EDDA5ET|0D 0A|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:misc-attack; sid:50093; rev:1; )"
44698,https://snort.org/rule_docs/1-44698,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Internal field separator use in HTTP URI attempt""; flow:to_server,established; http_uri; content:""$IFS""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:44698; rev:3; )"
4126,https://snort.org/rule_docs/1-4126,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 10000 ( msg:""SERVER-OTHER Veritas Backup Exec root connection attempt using default password hash""; flow:to_server,established; content:""|00 00 00 00 00 00 09 01|"",depth 8,offset 12; content:""|00 00 00 02|"",depth 4,offset 28; content:""root"",depth 4,offset 36,nocase; content:""|B4 B8 0F|& |5C|B4|03 FC AE EE 8F 91|=o"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; classtype:suspicious-login; sid:4126; rev:13; )"
30568,https://snort.org/rule_docs/1-30568,['T1566'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt""; flow:to_server,established; http_uri; content:""/cache/pdf_efax_"",fast_pattern,nocase; pcre:""/\/cache\/pdf\x5Fefax\x5F\d{8,15}\.zip$/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:30568; rev:3; )"
33943,https://snort.org/rule_docs/1-33943,['T1218'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Executable control panel file download request""; flow:to_server,established; flowbits:isset,file.zip; file_data; content:""PK|03 04|""; byte_jump:2,22,relative,little,post_offset -2; content:"".cpl"",within 4,fast_pattern,nocase; content:!""bin/javacpl.cpl""; content:!""Office16/MLCFG32.CPL""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-activity; sid:33943; rev:7; )"
9830,https://snort.org/rule_docs/1-9830,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger supreme spy runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Supreme"",distance 0,nocase; content:""Spy"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*Supreme\s+Spy/ims""; service:smtp; classtype:successful-recon-limited; sid:9830; rev:9; )"
31985,https://snort.org/rule_docs/1-31985,['T1204'],"alert udp $HOME_NET 67 -> $HOME_NET 68 ( msg:""OS-OTHER Malicious DHCP server bash environment variable injection attempt""; flow:stateless; content:""() {"",fast_pattern,nocase; content:""|02 01 06 00|"",depth 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-admin; sid:31985; rev:6; )"
46482,https://snort.org/rule_docs/1-46482,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Installation Keylogger Osx.Trojan.Mokes data exfiltration""; flow:to_server,established,only_stream; content:""GET /v1 HTTP/1.1"",depth 16,fast_pattern; http_header; content:""Connection: ""; content:""User-Agent: ""; content:""Accept-Encoding: ""; content:""Accept-Language: ""; content:""Host: ""; detection_filter:track by_src,count 3,seconds 6; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1020; T1056; classtype:trojan-activity; sid:46482; rev:6; )"
37298,https://snort.org/rule_docs/1-37298,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN installation attempt""; flow:to_server,established; http_header; content:""User-Agent: wget|0D 0A|Host: perr.hola.org"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37298; rev:4; )"
60301,https://snort.org/rule_docs/1-60301,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Cybershell outbound connection attempt""; flow:to_client,established; file_data; content:""<center>.:Cyber Shell (v 1.0):.<br>"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60301; rev:1; )"
39409,https://snort.org/rule_docs/1-39409,['T1056'],"alert tcp $HOME_NET any -> $SMTP_SERVERS [25,587] ( msg:""MALWARE-CNC Win.Trojan.iSpy variant initial outbound connection""; flow:to_server,established; content:""=0D=0A=0D=0A"",fast_pattern,nocase; content:""iSpy Keylogger""; content:""Computer Information""; content:""Username:"",within 30; content:""Installed"",within 50; metadata:impact_flag red,ruleset community; service:smtp; T1056; classtype:trojan-activity; sid:39409; rev:3; )"
13651,https://snort.org/rule_docs/1-13651,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger family cyber alert runtime detection - smtp traffic for recorded activities""; flow:to_server,established; content:""thread-index|3A| Acio"",nocase; content:""Subject|3A| Email from Family Cyber Alert"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13651; rev:9; )"
27286,https://snort.org/rule_docs/1-27286,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP DuWare DuClassmate default.asp iCity sql injection attempt""; flow:to_server,established; http_uri; content:""/default.asp?"",nocase; content:""iCity="",fast_pattern,nocase; pcre:""/iCity=((UNION|DELETE|ASCII)?\s*SELECT.*?FROM|UPDATE.*?SET)/i""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:27286; rev:5; )"
18556,https://snort.org/rule_docs/1-18556,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Symantec IM manager IMAdminReportTrendFormRun.asp sql injection attempt""; flow:to_server,established; http_uri; content:""|2F|IMManager|2F|admin|2F|IMAdminReportTrendFormRun|2E|asp|3F|"",nocase; pcre:""/groupList\x3d[^\x26]*\x3b/i""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18556; rev:13; )"
41446,https://snort.org/rule_docs/1-41446,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Cisco Meraki default admin credentials attempt""; flow:to_server,established; http_header; content:""Authorization: Basic bWZfdGVzdDptZl90ZXN0"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:41446; rev:3; )"
5784,https://snort.org/rule_docs/1-5784,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwae urls browsed log""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""HWAE URLS Browsed LOG"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5784; rev:9; )"
6385,https://snort.org/rule_docs/1-6385,['T1056'],"alert udp $EXTERNAL_NET any -> $HOME_NET 15164 ( msg:""MALWARE-OTHER Keylogger stealthwatcher 2000 runtime detection - agent status monitoring""; content:""|0A 02 08 FE 00|"",depth 5,offset 4; classtype:successful-recon-limited; sid:6385; rev:8; )"
22053,https://snort.org/rule_docs/1-22053,['T1571'],"alert tcp $EXTERNAL_NET 6666:7000 -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Insomnia variant inbound connection - post infection""; flow:to_client,established; content:""Asdf1|17|0"",depth 500; content:""irc.bhfirc.net"",within 50; service:ssl; classtype:trojan-activity; sid:22053; rev:4; )"
52256,https://snort.org/rule_docs/1-52256,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Dridex variant outbound connection""; flow:to_server,established; http_uri; content:""/login/process.php"",fast_pattern,nocase; http_cookie; content:""session=fnZEitY7BS0cuf1IWFxSWOimDVQ=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:52256; rev:2; )"
56862,https://snort.org/rule_docs/1-56862,['T1094'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC MultiOS.Malware.GORAT outbound communication attempt""; flow:to_server,established; http_method; content:""POST""; raw_data; content:""|0D 0A 0D 0A|murica"",fast_pattern,nocase; http_header; content:!""|0D 0A|Referer:""; content:!""|0D 0A|Accept""; content:!""|0D 0A|Cookie:""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56862; rev:1; )"
50949,https://snort.org/rule_docs/1-50949,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor installation attempt""; flow:established; file_data; content:""<?php @eval($_SERVER[|27|HTTP_""; content:""|27|])|3B| ?>"",within 100; metadata:policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:50949; rev:1; )"
19901,https://snort.org/rule_docs/1-19901,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Tong Keylogger outbound connection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""KeyLogged"",distance 0,nocase; content:""from"",distance 0,nocase; content:""|5B|Sync"",nocase; content:"" Manager|5D|"",distance 0,nocase; content:""|2D|"",distance 0,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:trojan-activity; sid:19901; rev:6; )"
37383,https://snort.org/rule_docs/1-37383,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Digi default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""dXNlcm5hbWU6cGFzc3dvcmQ="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37383; rev:3; )"
13480,https://snort.org/rule_docs/1-13480,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger findnot guarddog 4.0 runtime detection""; flow:to_server,established; flowbits:isset,FindNotGuardDog_detection; content:""X-Mailer|3A|"",nocase; content:""FindNot"",distance 0,nocase; content:""GuardDog"",distance 0,nocase; pcre:""/^X\x2DMailer\x3A[^\r\n]*FindNot\s+GuardDog/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13480; rev:6; )"
10100,https://snort.org/rule_docs/1-10100,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection - open website""; flow:to_client,established; flowbits:isset,Win32.RemoteKeylog.b.website; content:""WNDMicrosoft"",depth 12,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10100; rev:8; )"
654,https://snort.org/rule_docs/1-654,['T1190'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""SERVER-MAIL RCPT TO overflow""; flow:to_server,established; content:""rcpt to|3A|"",nocase; isdataat:256,relative; pcre:""/^RCPT TO\x3a\s*\x3c?[^\n\x3e]{256}/im""; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; classtype:attempted-admin; sid:654; rev:29; )"
12134,https://snort.org/rule_docs/1-12134,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - open url""; flow:to_client,established; flowbits:isset,RemoteKeyLog.b.Url_detection; content:""WND"",depth 3; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12134; rev:6; )"
7162,https://snort.org/rule_docs/1-7162,['T1056'],"alert tcp $HOME_NET 10050 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - download file server-to-client""; flow:to_client,established; flowbits:isset,winspy_download_client-to-server; content:""/CU"",fast_pattern,nocase; pcre:""/\x2FCU[^\r\n]*\x18\d+\x18\x16/ims""; classtype:successful-recon-limited; sid:7162; rev:9; )"
7163,https://snort.org/rule_docs/1-7163,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 10050 ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - execute file client-to-server""; flow:to_server,established; content:""/RF"",fast_pattern,nocase; pcre:""/\x2FRF[^\r\n]*\x16/ims""; flowbits:set,winspy_execute_client-to-server; flowbits:noalert; classtype:successful-recon-limited; sid:7163; rev:6; )"
2381,https://snort.org/rule_docs/1-2381,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP Checkpoint Firewall-1 HTTP parsing format string vulnerability attempt""; flow:to_server,established; http_method; content:""HEAD""; http_uri; content:""|3A|/"",offset 11; pcre:""/^[^\x3a\x3f]{11,}\x3a\x2f/ims""; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:2381; rev:21; )"
49449,https://snort.org/rule_docs/1-49449,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER ASP webshell upload attempt""; flow:to_server,established; file_data; content:""GIF8"",depth 4; content:""a"",within 1,distance 1; content:""<%"",distance 0; content:""language"",within 25,nocase; content:""%>"",within 35; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49449; rev:2; )"
51546,https://snort.org/rule_docs/1-51546,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected""; flow:to_server,established; http_uri; content:""/webkit_cookies""; http_header; content:""X-Finder-"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:51546; rev:1; )"
17265,https://snort.org/rule_docs/1-17265,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox plugin access control bypass attempt""; flow:to_client,established; file_data; content:""file|2E|initWithPath|28 22|c|3A 5C 5C 5C 5C|booom|2E|bat""; content:""xpcom|20 2B 3D 20 27|file|2E|createUnique""; content:""outputStream|2E|init|28|file|2C|0x04|7C|0x08|7C|0x20|2C|420""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:17265; rev:13; )"
20175,https://snort.org/rule_docs/1-20175,['T1021'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows Remote Desktop Client ActiveX clsid access""; flow:to_client,established; file_data; content:""7390f3d8-0439-4c05-91e3-cf5cb290c3d0"",fast_pattern,nocase; pcre:""/(<object\s*[^>]*\s*id\s*=\s*(?P<m1>\x22|\x27|)(?P<id1>.+?)(?P=m1)(\s|>)[^>]*\s*classid\s*=\s*(?P<q1>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7390f3d8-0439-4c05-91e3-cf5cb290c3d0\s*}?\s*(?P=q1)(\s|>).*(?P=id1)\s*\.\s*(MsRdpClientShell.RdpFileContents)|<object\s*[^>]*\s*classid\s*=\s*(?P<q2>\x22|\x27|)\s*clsid\s*\x3a\s*{?\s*7390f3d8-0439-4c05-91e3-cf5cb290c3d0\s*}?\s*(?P=q2)(\s|>)[^>]*\s*id\s*=\s*(?P<m2>\x22|\x27|)(?P<id2>.+?)(?P=m2)(\s|>).*(?P=id2)\s*\.\s*(MsRdpClientShell.RdpFileContents))\s*=/Ois""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:20175; rev:12; )"
30780,https://snort.org/rule_docs/1-30780,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 01|""; byte_jump:2,0,relative; content:""|18 03 01|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30780; rev:4; )"
41460,https://snort.org/rule_docs/1-41460,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Osx.Keylogger.Elite variant outbound connection""; flow:to_server,established; http_uri; content:""/Mac/getInstallScript/"",fast_pattern,nocase; content:""clickid="",nocase; content:""software="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41460; rev:3; )"
60302,https://snort.org/rule_docs/1-60302,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Cybershell outbound connection attempt""; flow:to_client,established; file_data; content:""<form name='zapros' method='get' action=''>"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60302; rev:1; )"
1325,https://snort.org/rule_docs/1-1325,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $SSH_PORTS ( msg:""INDICATOR-SHELLCODE ssh CRC32 overflow filler""; flow:to_server,established; content:""|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:shellcode-detect; sid:1325; rev:14; )"
53198,https://snort.org/rule_docs/1-53198,['T1056'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Keylogger.WindowsKeylogger variant download attempt""; flow:to_server,established; file_data; content:""user32.ShowWindow(kernel32.GetConsoleWindow(), 0)"",fast_pattern,nocase; content:""key_info.append(str(key.name)""; content:""key.on_press(write_key)""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:53198; rev:1; )"
56605,https://snort.org/rule_docs/1-56605,['T1071'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt""; flow:to_client,established; file_data; content:""{|22|navgd|22|:|22|<div class=gnt_n_dd_ls_w><div class=gnt_n_dd_nt>ONLY AT USA TODAY:</div><div class=gnt_n_dd_ls><a class=gnt_n_dd_ls_a href=https://supportlocal.usatoday.com/"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56605; rev:1; )"
49789,https://snort.org/rule_docs/1-49789,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zacinlo outbound connection""; flow:to_server,established; http_uri; content:""/updaterinfo.bin"",fast_pattern,nocase; http_header; content:""User-Agent: wget""; content:""Referer:""; content:""/updater/"",within 50; content:!""Accept-Encoding""; content:!""Accept-""; content:!""Content-""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:49789; rev:2; )"
30982,https://snort.org/rule_docs/1-30982,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Karnos variant outbound connection""; flow:to_server,established; http_uri; content:""/plugin/accept/searchlog"",fast_pattern,nocase; http_header; content:!""User-Agent:""; http_client_body; content:""data=eyJob3N0Ijo"",depth 16; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:30982; rev:3; )"
35109,https://snort.org/rule_docs/1-35109,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Angler exploit kit obfuscated Flash actionscript classname detected""; flow:to_client,established; file_data; content:""|0E|IIll1III111I11|0E|Illl1III111I11"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:35109; rev:3; )"
59049,https://snort.org/rule_docs/1-59049,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Andela inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?y=|2F|"",fast_pattern,nocase; content:""&x="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59049; rev:1; )"
30522,https://snort.org/rule_docs/1-30522,['T1123'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 02|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30522; rev:9; )"
7175,https://snort.org/rule_docs/1-7175,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 868 ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - log retrieve""; flow:to_server,established; content:""Send me the logs, please""; flowbits:set,ABSystemSpy_LogRetrieve; flowbits:noalert; classtype:successful-recon-limited; sid:7175; rev:6; )"
59218,https://snort.org/rule_docs/1-59218,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.C99Madnet outbound connection attempt""; flow:to_client,established; file_data; content:""<b>uname -a:&nbsp|3B|"",fast_pattern,nocase; content:""<b>Software:&nbsp|3B|"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59218; rev:1; )"
31070,https://snort.org/rule_docs/1-31070,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Rootkit.Necurs outbound connection""; flow:to_server,established; http_method; content:""POST""; http_raw_uri; bufferlen:15; http_uri; content:""/docs/index.php"",fast_pattern,nocase; http_header; content:""Content-Type|3A 20|application/octet-stream""; content:!""User-Agent|3A 20|""; content:!""Accept|3A 20|""; content:!""Referer|3A 20|""; metadata:impact_flag red,ruleset community; service:http; T1014; classtype:trojan-activity; sid:31070; rev:4; )"
7574,https://snort.org/rule_docs/1-7574,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger proagent 2.0 runtime detection""; flow:to_server,established; content:""HELO"",nocase; content:""ProAgent"",distance 0,nocase; pcre:""/^HELO\s+ProAgent/ims""; content:""From|3A|"",nocase; content:""ProAgent"",distance 0,nocase; pcre:""/^From\x3A\s+\x22ProAgent\s+v\d+\x2E\d+\x22/ims""; service:smtp; classtype:successful-recon-limited; sid:7574; rev:7; )"
45915,https://snort.org/rule_docs/1-45915,['T1027'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PHP obfuscated eval command execution attempt""; flow:to_server,established; http_client_body; content:""php"",nocase; content:""eval"",within 100,nocase; content:""base64_decode"",within 100,nocase; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:45915; rev:2; )"
60300,https://snort.org/rule_docs/1-60300,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Cybershell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?d=/"",fast_pattern,nocase; content:""&diz"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60300; rev:1; )"
36824,https://snort.org/rule_docs/1-36824,['T1027'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""EXPLOIT-KIT Known exploit kit obfuscation routine detected""; flow:to_client,established; content:""vbscript>""; content:""=Split("",within 40; content:""UBound("",within 40; content:""+Chrw(eval("",within 40; content:""End Function"",within 40; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:36824; rev:2; )"
31857,https://snort.org/rule_docs/1-31857,['T1189'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Scanbox exploit kit enumeration code detected""; flow:to_client,established; file_data; content:""document|2E|createElement|28|unescape|28 22 25|3Ciframe|25|20id|25|3D"",fast_pattern,nocase; content:""|2E|crypt|2E|_utf8_encode""; content:""|2E|push|28|""; content:""|3D 3D|c|3A 5C 5C|Program Files|5C 5C|"",within 30; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:31857; rev:3; )"
56608,https://snort.org/rule_docs/1-56608,['T1020'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Cobalt Strike beacon inbound connection attempt""; flow:to_client,established; file_data; content:""{|22|meta|22|:{},|22|status|22|:|22|OK|22|,|22|saved|22|:|22|1|22|,|22|starttime|22|:17656184060,|22|id|22|:|22 22|,|22|vims|22|:{|22|dtc|22|:|22|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56608; rev:1; )"
57907,https://snort.org/rule_docs/1-57907,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt""; flow:to_server,established; http_uri; content:""/autodiscover"",fast_pattern,nocase; content:""Email="",nocase; pcre:""/[?&]Email=[^&]*?\x2fautodiscover/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:57907; rev:7; )"
47900,https://snort.org/rule_docs/1-47900,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.OilRig variant outbound connection""; flow:to_server,established; http_uri; content:""/pser?"",depth 6; pcre:""/\x2fpser\x3f[A-F0-9]{3,84}(BBZ|BBY)/""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:47900; rev:2; )"
47138,https://snort.org/rule_docs/1-47138,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP HP VAN SDN Controller default credentials authentication attempt""; flow:to_server,established; http_uri; content:""/sdn/ui/app/login"",fast_pattern,nocase; pkt_data; content:""username=sdn"",nocase; content:""password=skyline"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:47138; rev:2; )"
58742,https://snort.org/rule_docs/1-58742,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""${"",fast_pattern,nocase; http_uri; content:""|2F|""; http_header; pcre:""/\x24\x7b(jndi|[^\x7d\x80-\xff]*?\x24\x7b[^\x7d\x80-\xff]*?\x3a[^\x7d]*?\x7d)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58742; rev:8; )"
7845,https://snort.org/rule_docs/1-7845,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger clogger 1.0 runtime detection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""Keylogger"",distance 0,nocase; pcre:""/^Subject\x3a[^\r\n]*Keylogger/ims""; flowbits:set,Clogger_SendLogOut1; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:7845; rev:7; )"
61074,https://snort.org/rule_docs/1-61074,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC JSP.Webshell.JSPShell outbound connection""; flow:to_client,established; file_data; content:""<FORM METHOD=|22|GET|22| NAME=|22|myform|22|"",fast_pattern,nocase; content:""<INPUT TYPE=|22|text|22| NAME=|22|cmd|22|>"",within 60,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61074; rev:1; )"
50102,https://snort.org/rule_docs/1-50102,['T1187'],"alert tcp any 389 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner LDAP attack attempt""; flow:to_client,established; content:""s|00|e|00|r|00|v|00|e|00|r|00|2|00|0|00|0|00|8|00|.|00|s|00|m|00|b|00|1|00|2|00|.|00|l|00|o|00|c|00|a|00|l|00|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ldap; classtype:misc-attack; sid:50102; rev:1; )"
13507,https://snort.org/rule_docs/1-13507,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC evilotus 1.3.2 variant outbound connection""; flow:to_server,established; flowbits:isset,Evilotus_detection; content:""|0C|~|7F D8|"",depth 4; content:""|00 00 00|d|C8 00 00|"",within 8,distance 1; content:""|00 00 00|"",within 3,distance 1; classtype:trojan-activity; sid:13507; rev:6; )"
29681,https://snort.org/rule_docs/1-29681,['T1220'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-PLUGINS Microsoft XML Core Services same origin policy bypass attempt""; flow:to_server,established; file_data; content:""MSXML2."",fast_pattern,nocase; content:""file|3A 2F 2F 2F|C|3A|"",nocase; content:""<msxsl"",nocase; content:"".open"",distance 0,nocase; content:"".send"",distance 0,nocase; pcre:""/(?P<obj>\w+)\s*?=\s*?(new\s+ActiveX|Create)Object\s*?\x28\s*?[\x22\x27]MSXML2\x2e.*?(?P=obj)\.open\s*?\x28?\s*?[\x22\x27]GET[\x22\x27].*(?P=obj)\.send/is""; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-recon; sid:29681; rev:7; )"
57462,https://snort.org/rule_docs/1-57462,['T1071'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE webshell variant access""; flow:to_client,established; file_data; content:""Results of |27|""; content:""|27| execution:|0A 0A|"",within 260; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57462; rev:1; )"
50467,https://snort.org/rule_docs/1-50467,['T1003'],"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Mimikatz use via SMB attempt""; flow:to_server,established; content:""Windows|5C|Temp|5C|mimikatz"",fast_pattern,nocase; content:""|FF|SMB|A2|"",depth 5,offset 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50467; rev:1; )"
19551,https://snort.org/rule_docs/1-19551,['T1078'],"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-OTHER self-signed SSL certificate with default Internet Widgits Pty Ltd organization name""; flow:to_client,established; ssl_state:server_hello; content:""|55 04 0A 13 18|Internet Widgits Pty Ltd"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:ssl; classtype:policy-violation; sid:19551; rev:12; )"
39930,https://snort.org/rule_docs/1-39930,['T1003'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Siemens IP-Camera credential disclosure attempt""; flow:to_server,established; http_uri; content:""/cgi-bin/readfile.cgi"",fast_pattern,nocase; content:""query=ADMINID"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:39930; rev:3; )"
42066,https://snort.org/rule_docs/1-42066,['T1070'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Wordpress plugin arbitrary file deletion attempt""; flow:to_server,established; http_uri; content:""/wp-admin/admin-ajax.php"",fast_pattern,nocase; http_client_body; content:""plugin="",nocase; content:""action=delete"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:42066; rev:3; )"
16573,https://snort.org/rule_docs/1-16573,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated ActiveX object instantiation via unescape""; flow:to_client,established; file_data; content:""ActiveXObject|28|"",nocase; content:""unescape|28|"",nocase; pcre:""/new\s*ActiveXObject\(\s*unescape\(/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:16573; rev:9; )"
59261,https://snort.org/rule_docs/1-59261,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.C0ders download attempt""; flow:to_client,established; file_data; content:""<?""; content:""c0derz shell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59261; rev:1; )"
48501,https://snort.org/rule_docs/1-48501,['T1070'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-TOOLS Win.Tool.Delete variant download detected""; flow:to_client,established; file_data; content:""/|00|q|00 20 00|&|00|&|00 20 00|s|00|h|00|u|00|t|00|d|00|o|00|w|00|n|00 20 00|/|00|r|00 20 00|/|00|f|00 20 00|/|00|t|00 20 00|0|00|0|00|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:48501; rev:2; )"
49864,https://snort.org/rule_docs/1-49864,['T1020'],"alert tcp any $HTTP_PORTS -> any any ( msg:""FILE-OTHER Multiple Products XML external entity injection attempt""; flow:to_client,established; file_data; content:""ENTITY"",fast_pattern,nocase; content:""://"",within 75; pcre:""/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)((?!\x3e|%3e).)*?(file|http|https|ftp|jar)\x3A\x2F\x2F/i""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; gid:1; sid:49864; rev:4; )"
31976,https://snort.org/rule_docs/1-31976,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; http_client_body; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:31976; rev:5; )"
58814,https://snort.org/rule_docs/1-58814,['T1190'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""POLICY-OTHER Java User-Agent remote class download attempt""; flow:to_server,established; http_uri; content:"".class"",fast_pattern,nocase; http_header; content:""|0D 0A|User-Agent: Java/"",nocase; metadata:ruleset community; service:http; classtype:policy-violation; sid:58814; rev:3; )"
7167,https://snort.org/rule_docs/1-7167,['T1056'],"alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 3""; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve2; content:""chkCli"",depth 6; flowbits:set,ABSystemSpy_Inforetrieve3; flowbits:noalert; classtype:successful-recon-limited; sid:7167; rev:8; )"
44559,https://snort.org/rule_docs/1-44559,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Word.Trojan.Emotet obfuscated powershell""; flow:to_client,established; file_data; flowbits:isset,file.doc|file.xls; content:""powershell"",fast_pattern,nocase; pcre:""/powershell\s*?-e\s*?[A-Za-z0-9+\/=]{20}/i""; metadata:impact_flag red; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:44559; rev:3; )"
13479,https://snort.org/rule_docs/1-13479,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger findnot guarddog 4.0 runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""|22|FindNot"",distance 0,nocase; content:""GuardDog|22|"",distance 0,nocase; pcre:""/^From\x3A[^\r\n]*\x22FindNot\s+GuardDog\x22/ims""; flowbits:set,FindNotGuardDog_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13479; rev:7; )"
38388,https://snort.org/rule_docs/1-38388,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FTPKeyLogger geolocation check""; flow:to_server,established; http_raw_uri; bufferlen:16; http_uri; content:""/geoip/geoip.php"",fast_pattern,nocase; http_header; content:!""Accept""; content:!""User-Agent""; content:!""Referer""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38388; rev:3; )"
16339,https://snort.org/rule_docs/1-16339,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer object clone deletion memory corruption attempt - obfuscated""; flow:to_client,established; isdataat:!2055; file_data; content:""CollectGarbage"",fast_pattern,nocase; content:""createElement"",nocase; content:""cloneNode"",within 128,nocase; content:""clearAttributes"",within 128,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:16339; rev:15; )"
7180,https://snort.org/rule_docs/1-7180,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger desktop detective 2000 runtime detection - init connection""; flow:to_client,established; flowbits:isset,DesktopDetective_InitConnection2; content:""|FE FE FE FE|90|00 00|"",fast_pattern,nocase; classtype:successful-recon-limited; sid:7180; rev:10; )"
7157,https://snort.org/rule_docs/1-7157,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 10050 ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - remote conn client-to-server""; flow:to_server,established; content:""/CLUserName|18|Password|16|"",depth 21,nocase; flowbits:set,winspy_conn_client-to-server; flowbits:noalert; classtype:successful-recon-limited; sid:7157; rev:5; )"
12758,https://snort.org/rule_docs/1-12758,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger/RAT digi watcher 2.32 runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""Digi-Watcher.com"",distance 0,nocase; pcre:""/^From\x3A[^\r\n]*Digi\x2DWatcher\x2Ecom/ims""; flowbits:set,DigiWatcher232_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:12758; rev:7; )"
28278,https://snort.org/rule_docs/1-28278,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP IBM Tivoli Provisioning Manager express user.updateUserValue sql injection attempt""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/tpmx/register.do""; http_client_body; content:"",""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:28278; rev:8; )"
12132,https://snort.org/rule_docs/1-12132,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - keylogging""; flow:to_client,established; flowbits:isset,RemoteKeyLog.b.Keylogging_detection; content:""KEY"",depth 3; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12132; rev:6; )"
8357,https://snort.org/rule_docs/1-8357,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spybuddy 3.72 runtime detection - send alert out through email""; flow:to_server,established; flowbits:isset,SpyBuddy_SMTP; content:""SpyBuddy"",nocase; content:""Alert"",distance 0,nocase; pcre:""/^SpyBuddy\s+Alert/ims""; service:smtp; classtype:successful-recon-limited; sid:8357; rev:7; )"
49456,https://snort.org/rule_docs/1-49456,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER PHP webshell upload attempt""; flow:to_server,established; file_data; content:""|89|PNG|0D 0A 1A 0A|"",depth 8; content:""<?php"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49456; rev:2; )"
35030,https://snort.org/rule_docs/1-35030,['T1094'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zeus variant outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:9; http_uri; content:""/diff.php"",fast_pattern,nocase; http_header; content:""|0D 0A|User-Agent: Mozilla/4.0|0D 0A|""; content:""|0D 0A|Content-Type: application/octet-stream|0D 0A|""; http_client_body; content:""|A0 CD 37 A4 5B|"",depth 5; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:35030; rev:2; )"
29519,https://snort.org/rule_docs/1-29519,['T1027'],"alert file ( msg:""INDICATOR-OBFUSCATION Javascript obfuscation using split reverse join""; file_data; content:"".split(|22 22|).reverse().join(|22 22|)"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:attempted-user; gid:1; sid:29519; rev:8; )"
59266,https://snort.org/rule_docs/1-59266,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C0ders inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?mode=upload"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59266; rev:1; )"
34446,https://snort.org/rule_docs/1-34446,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Odlanor information exfiltration attempt""; flow:to_server,established; http_uri; content:""/r.php?m=2&v="",fast_pattern,nocase; content:""&os="",nocase; content:""&c="",within 50,nocase; content:""&u="",within 50,nocase; http_header; content:""Connection: close|0D 0A 0D 0A|"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:34446; rev:3; )"
49455,https://snort.org/rule_docs/1-49455,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Perl webshell upload attempt""; flow:to_server,established; file_data; content:""GIF8"",depth 4; content:""a"",within 1,distance 1; content:""/usr/bin/perl"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49455; rev:2; )"
58789,https://snort.org/rule_docs/1-58789,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""$%257b"",fast_pattern,nocase; pcre:""/\x24%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58789; rev:4; )"
29379,https://snort.org/rule_docs/1-29379,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [777,778] ( msg:""MALWARE-CNC Win.Trojan.Dropper outbound encrypted traffic - potential exfiltration""; flow:to_server,established; isdataat:1440; content:""|03 2B 82 86 02 A0 05|"",fast_pattern,nocase; metadata:ruleset community; T1020; classtype:trojan-activity; sid:29379; rev:3; )"
57466,https://snort.org/rule_docs/1-57466,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/compcheckresult.cgi"",fast_pattern,nocase; http_client_body; content:""id="",nocase; pcre:""/(^|&)id=/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57466; rev:1; )"
26353,https://snort.org/rule_docs/1-26353,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE IP address check to dyndns.org detected""; flow:to_server,established; http_header; content:""Host|3A 20|checkip.dyndns.org"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:misc-activity; sid:26353; rev:3; )"
6365,https://snort.org/rule_docs/1-6365,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Sony rootkit runtime detection""; flow:to_server,established; http_header; content:""User-Agent|3A|"",nocase; content:""SecureNet"",fast_pattern,nocase; pkt_data; content:""Xtra"",distance 0,nocase; http_header; pcre:""/^User-Agent\x3A[^\r\n]*SecureNet\s+Xtra/ims""; pcre:""/^Host\x3A[^\r\n]*sonymusic\x2Ecom/ims""; service:http; classtype:misc-activity; sid:6365; rev:11; )"
60587,https://snort.org/rule_docs/1-60587,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Perl.Webshell.GammaShell outbound connection attempt""; flow:to_client,established; file_data; content:""<input class=|22|tool|22| type=|22|submit|22| value=|22|Execute|22| onClick=|22|return submit_execute()|22|></td>"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60587; rev:1; )"
40911,https://snort.org/rule_docs/1-40911,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Rootkit.Sednit variant outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:11; http_uri; content:""/search.php"",fast_pattern,nocase; http_client_body; content:""as_ft=""; content:""as_q=""; metadata:impact_flag red,ruleset community; service:http; T1014; classtype:trojan-activity; sid:40911; rev:4; )"
48573,https://snort.org/rule_docs/1-48573,['T1070'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP WordPress arbitrary file deletion attempt""; flow:to_server,established; http_uri; content:""/wp-admin/admin.php""; content:""page=wc.status"",fast_pattern,nocase; content:""handle="",nocase; content:""../""; pcre:""/[?&]handle=[^&]*?\x2e\x2e\x2f/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:48573; rev:2; )"
7168,https://snort.org/rule_docs/1-7168,['T1056'],"alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange - flowbit set 4""; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve3; content:""chkCap"",depth 6; flowbits:set,ABSystemSpy_Inforetrieve4; flowbits:noalert; classtype:successful-recon-limited; sid:7168; rev:7; )"
58731,https://snort.org/rule_docs/1-58731,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""${upper:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58731; rev:6; )"
1147,https://snort.org/rule_docs/1-1147,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP cat_ access""; flow:to_server,established; http_uri; content:""cat "",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-recon; sid:1147; rev:21; )"
27956,https://snort.org/rule_docs/1-27956,['T1014'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit download attempt""; flow:to_client,established; file_data; content:""|22|opener: Finished gather system-wide info |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:27956; rev:3; )"
53031,https://snort.org/rule_docs/1-53031,['T1571'],"alert tcp $HOME_NET 1025: -> $EXTERNAL_NET [443,1025:] ( msg:""MALWARE-CNC Win.Malware.Loda RAT beacon detected""; flow:to_server,established; content:""|7C|"",depth 3; content:""|7C|x|7C|"",within 23; content:""|7C|WIN"",within 24; content:""|7C|X64|7C|"",within 15; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:53031; rev:2; )"
21377,https://snort.org/rule_docs/1-21377,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Cisco Unified Communications Manager sql injection attempt""; flow:to_server,established; http_uri; content:""/ccmcip/xmldirectorylist"",fast_pattern,nocase; pcre:""/xmldirectorylist(\.utf-8|\.other)?\.jsp[^\n]*?[\x3F\x26][lfn]=[^\x26]*?[\x22\x27][^\x26]*?\x20(or|union|like|select)\x20/i""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:21377; rev:8; )"
30778,https://snort.org/rule_docs/1-30778,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 00|""; byte_jump:2,0,relative; content:""|18 03 00|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30778; rev:4; )"
6386,https://snort.org/rule_docs/1-6386,['T1056'],"alert udp $HOME_NET any -> $EXTERNAL_NET 15165 ( msg:""MALWARE-OTHER Keylogger stealthwatcher 2000 runtime detection - agent up notification""; content:""|00 00 00 00 0A 02 08 A6|"",depth 8; content:""|02 00 00|v"",distance 0; classtype:successful-recon-limited; sid:6386; rev:8; )"
37306,https://snort.org/rule_docs/1-37306,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN startup attempt""; flow:to_server,established; http_uri; content:""/be_client_cgi/perr?browser="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37306; rev:4; )"
59948,https://snort.org/rule_docs/1-59948,['T1190'],"alert http ( msg:""SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt""; flow:to_server,established; http_uri; content:""${""; content:""com.opensymphony."",distance 0,fast_pattern; content:""|28|"",distance 0; content:""}"",distance 0; pcre:""/\x24\x7b[^\x7d]*?com\x2eopensymphony\x2e(xwork2|webwork)\x2e(Servlet)?ActionContext[^\x7d]*?\x28/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:59948; rev:1; )"
58729,https://snort.org/rule_docs/1-58729,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_uri; content:""${upper:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58729; rev:5; )"
42332,https://snort.org/rule_docs/1-42332,['T1189'],"alert tcp any any -> $HOME_NET 445 ( msg:""MALWARE-CNC Win.Trojan.Doublepulsar variant ping command""; flow:to_server,established; content:""|FF|SMB|32 00 00 00 00|"",depth 9,offset 4; content:""|41 00|"",within 2,distance 21; content:""|0E 00 0D 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"",within 17,distance 29,fast_pattern,fast_pattern_offset 0,fast_pattern_length 10; flowbits:set,smb.trans2.mid65; flowbits:noalert; metadata:policy balanced-ips alert,policy max-detect-ips alert,policy security-ips alert,ruleset community; service:netbios-ssn; classtype:trojan-activity; sid:42332; rev:8; )"
49540,https://snort.org/rule_docs/1-49540,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER WordPress wp_user_roles configuration change attempt""; flow:to_server,established; http_uri; content:""/admin-post.php"",fast_pattern,nocase; http_client_body; content:""default_role"",nocase; content:""administrator"",within 45,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:49540; rev:1; )"
6207,https://snort.org/rule_docs/1-6207,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger winsession runtime detection - smtp""; flow:to_server,established; content:""===========>"",nocase; content:""WinSession Logger"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:6207; rev:10; )"
2278,https://snort.org/rule_docs/1-2278,['T1204'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP HTTP request with negative Content-Length attempt""; flow:to_server,established; http_header; content:""Content-Length|3A|"",nocase; content:!""|0D|"",within 10; content:!""|0A|"",within 10; pcre:""/Content-Length\x3A\s*[2-9][0-9]{9}/i""; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:misc-attack; sid:2278; rev:36; )"
19393,https://snort.org/rule_docs/1-19393,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger Monitor.win32.perflogger""; flow:to_server,established; flowbits:isset,w32.perflogger; content:""MKD"",nocase; pcre:""/MKD\s+\d{4}\x2d(\d{2}\x2d){4}/i""; metadata:policy max-detect-ips drop; service:ftp; classtype:trojan-activity; sid:19393; rev:6; )"
42395,https://snort.org/rule_docs/1-42395,['T1197'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Oddjob outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:80<=>120; http_method; content:""HEAD""; http_header; content:""User-Agent: Microsoft BITS"",fast_pattern,nocase; content:""Accept-Encoding: identity"",nocase; http_uri; pcre:""/\x2f[A-Z0-9\x3d\x2d\x2b\x2e\x20]{80,120}\x20/i""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:42395; rev:3; )"
6221,https://snort.org/rule_docs/1-6221,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger computerspy runtime detection""; flow:to_server,established; content:""From|3A| keys<keys@hotpop.com>"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:6221; rev:9; )"
38559,https://snort.org/rule_docs/1-38559,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger outbound connection - keystorkes""; flow:to_server,established; http_uri; content:""/News/gate.php?"",fast_pattern,nocase; http_client_body; content:""<br><br><b><big>""; http_uri; pcre:""/\/News\/gate\.php\x3f[a-f0-9]{32}\x3d\d/i""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38559; rev:3; )"
34944,https://snort.org/rule_docs/1-34944,['T1003'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER Arcserve Unified Data Protection Management credential disclosure attempt""; flow:to_server,established; http_uri; content:""/services/EdgeServiceImpl"",fast_pattern,nocase; http_client_body; content:""getBackupPolicy"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:34944; rev:6; )"
59219,https://snort.org/rule_docs/1-59219,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C99Madnet inbound connection attempt""; flow:to_server,established; http_client_body; content:""act=""; content:""&fullhexdump="",fast_pattern,nocase; content:""&d=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59219; rev:1; )"
32039,https://snort.org/rule_docs/1-32039,['T1204'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""OS-OTHER Bash environment variable injection attempt""; flow:to_server,established; content:""() {"",fast_pattern,nocase; content:""RCPT"",nocase; content:""TO|3A|"",distance 0,nocase; pcre:""/^\s*?RCPT\s+?TO\x3a[^\r\n]*?\x28\x29\s\x7b/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; classtype:attempted-admin; sid:32039; rev:3; )"
45967,https://snort.org/rule_docs/1-45967,['T1020'],"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration""; flow:to_server; isdataat:150; content:""|0F|""; content:""|03|trp"",within 4,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; T1020; classtype:trojan-activity; sid:45967; rev:2; )"
56603,https://snort.org/rule_docs/1-56603,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original outbound connection attempt""; flow:to_server,established; http_header; content:""Accept: */*|0D 0A|""; content:""Accept-Language: en-US|0D 0A|""; content:""Accept-Encoding: gzip, deflate|0D 0A|""; http_cookie; content:""display-culture=en|3B|check=true|3B|lbcs=0|3B|sess-id=""; content:""|3B|SIDCC=AN0-TY21iJHH32j2m|3B|FHBv3=B""; http_uri; pcre:""/(\/api2|\/en-us|\/gp|\/v1|\/v3|\/v4|\/wp-content|\/wp-includes)/i""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56603; rev:1; )"
42340,https://snort.org/rule_docs/1-42340,['T1189'],"alert tcp any any -> $HOME_NET 445 ( msg:""OS-WINDOWS Microsoft Windows SMB anonymous session IPC share access attempt""; flow:to_server,established; flowbits:isset,smb.null_session; content:""|FF|SMB|75 00 00 00 00|"",depth 9,offset 4; content:""|00 5C 00|I|00|P|00|C|00|$|00 00 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; T1077; classtype:attempted-recon; sid:42340; rev:4; )"
11307,https://snort.org/rule_docs/1-11307,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger computer monitor Keylogger runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Computer"",distance 0,nocase; content:""Monitor"",distance 0,nocase; content:""Keylogger"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*Computer[^\r\n]*Monitor[^\r\n]*Keylogger/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:11307; rev:10; )"
56585,https://snort.org/rule_docs/1-56585,['T1190'],"alert tcp any any -> any any ( msg:""MALWARE-TOOLS GhostPack Rubeus kerberos request attempt""; flow:to_server,established; content:""User32LogonProcesss"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; classtype:trojan-activity; gid:1; sid:56585; rev:2; )"
5780,https://snort.org/rule_docs/1-5780,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwpe word filtered echelon log""; flow:to_server,established; content:""Subject|3A| HWPE Word Filtered Echelon LOG"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5780; rev:9; )"
49532,https://snort.org/rule_docs/1-49532,['T1187'],"alert tcp any $FILE_DATA_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner download attempt""; flow:to_client,established; file_data; content:""#|21|/usr/bin/env python|0A|# This file is part of Responder"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:49532; rev:1; )"
12136,https://snort.org/rule_docs/1-12136,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - fun""; flow:to_client,established; flowbits:isset,RemoteKeyLog.b.Fun_detection; content:""WND"",depth 3; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12136; rev:5; )"
49453,https://snort.org/rule_docs/1-49453,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER CFM webshell upload attempt""; flow:to_server,established; file_data; content:""GIF8"",depth 4; content:""a"",within 1,distance 1; content:""cfexecute"",distance 0,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49453; rev:2; )"
43287,https://snort.org/rule_docs/1-43287,['T1087'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/inetd.conf file access attempt""; flow:to_server,established; http_uri; content:""/etc/inetd.conf"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:43287; rev:3; )"
58912,https://snort.org/rule_docs/1-58912,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.AcceptLanguage upload attempt""; flow:to_server,established; file_data; content:""<?php"",nocase; content:""passthru(getenv("",distance 0,fast_pattern,nocase; content:""HTTP_ACCEPT_LANGUAGE"",within 30; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:58912; rev:1; )"
41456,https://snort.org/rule_docs/1-41456,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC User-Agent known malicious user-agent string - Elite Keylogger""; flow:to_server,established; http_header; content:""User-Agent|3A| Elite%20Keylogger/"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41456; rev:4; )"
58741,https://snort.org/rule_docs/1-58741,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""${"",fast_pattern,nocase; pcre:""/\x24\x7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58741; rev:6; )"
1860,https://snort.org/rule_docs/1-1860,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:""SERVER-WEBAPP Linksys router default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; pcre:""/^Authorization\x3a(\s*|\s*\r?\n\s+)Basic\s+OmFkbWlu/ims""; metadata:ruleset community; service:http; T1078; classtype:default-login-attempt; sid:1860; rev:15; )"
19706,https://snort.org/rule_docs/1-19706,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Agent.cer variant outbound connection""; flow:to_server,established; http_uri; content:""/com_plugin.php"",nocase; http_client_body; content:""subject|3D|"",nocase; content:""|26|message|3D|"",distance 1,nocase; service:http; classtype:trojan-activity; sid:19706; rev:9; )"
56863,https://snort.org/rule_docs/1-56863,['T1094'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC MultiOS.Malware.GORAT command and control response attempt""; flow:to_client,established; http_header; content:""HTTP/1."",depth 7; raw_data; content:""|0D 0A 0D 0A|murica"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56863; rev:1; )"
31978,https://snort.org/rule_docs/1-31978,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; http_header; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:31978; rev:5; )"
17154,https://snort.org/rule_docs/1-17154,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox plugin parameter array dangling pointer exploit attempt - 2""; flow:to_client,established; file_data; content:""<object""; content:""data"",within 200; content:""|27 27|"",within 20,fast_pattern; pcre:""/\x3Cobject(?![^\x3E]+?src)[^\x3E]+?data\s*\x3D\s*\x27\x27/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:17154; rev:15; )"
33942,https://snort.org/rule_docs/1-33942,['T1218'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Executable control panel file download request""; flow:to_client,established; flowbits:isset,file.zip; file_data; content:""PK|03 04|""; byte_jump:2,22,relative,little,post_offset -2; content:"".cpl"",within 4,fast_pattern,nocase; content:!""bin/javacpl.cpl""; content:!""Office16/MLCFG32.CPL""; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:33942; rev:9; )"
8466,https://snort.org/rule_docs/1-8466,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger netobserve runtime detection - email notification""; flow:to_server,established; flowbits:isset,NETObserve_SMTP; content:""NETObserve"",nocase; content:""Requested"",distance 0,nocase; content:""Information"",distance 0,nocase; pcre:""/^NETObserve\s+Requested\s+Information/ims""; service:smtp; classtype:successful-recon-limited; sid:8466; rev:7; )"
12774,https://snort.org/rule_docs/1-12774,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated GlobalLink ConnectAndEnterRoom ActiveX exploit attempt""; flow:to_client,established; file_data; content:""<object classid=|22|clsid|3A|AE93C5DF-A990-11D1-AEBD-5254ABDD2B69|22|"",nocase; content:""LoveVChenzi"",distance 0,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12774; rev:13; )"
24629,https://snort.org/rule_docs/1-24629,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Oracle Fusion Middleware WebCenter selectedLocale parameter sql injection attempt""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/cs/ContentServer"",fast_pattern,nocase; http_client_body; content:""selectedLocale="",nocase; pcre:""/(^|&)selectedLocale=[^&]+?([\x22\x27]|%22|%27)/i""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:24629; rev:4; )"
33547,https://snort.org/rule_docs/1-33547,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Turla outbound connection""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""?uid=""; content:""&context="",distance 0; content:""&mode=text"",distance 0,fast_pattern; content:""&data="",distance 0; metadata:impact_flag red,ruleset community; service:http; T1065; classtype:trojan-activity; sid:33547; rev:4; )"
49790,https://snort.org/rule_docs/1-49790,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zacinlo outbound connection""; flow:to_server,established; http_uri; content:""/entry/exe/runinfo"",fast_pattern,nocase; content:""&mac=""; http_header; content:""User-Agent: wget""; content:""Referer:""; content:""/entry/"",within 50; content:!""Accept-""; content:!""Content-""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:49790; rev:1; )"
30521,https://snort.org/rule_docs/1-30521,['T1123'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 01|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30521; rev:9; )"
32043,https://snort.org/rule_docs/1-32043,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:""OS-OTHER Bash environment variable injection attempt""; flow:to_server,established; content:""USER "",depth 5; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; classtype:attempted-admin; sid:32043; rev:3; )"
57901,https://snort.org/rule_docs/1-57901,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Doc.Downloader.Emotet variant outbound connection attempt""; flow:to_server,established; http_raw_uri; bufferlen:>12; http_uri; content:""/unraid-map/"",fast_pattern,nocase; http_header; content:!""User-Agent:"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:57901; rev:2; )"
44561,https://snort.org/rule_docs/1-44561,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; http_uri; content:""/admin/get.php"",fast_pattern,nocase; http_cookie; content:""SESSION""; http_header; content:""User-Agent: Mozilla/5.0 (Windows NT 6.1|3B| WOW64|3B| Trident/7.0|3B| rv:11.0) like Gecko""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:44561; rev:4; )"
7592,https://snort.org/rule_docs/1-7592,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger keylogger pro runtime detection""; flow:to_server,established; flowbits:isset,KeyloggerPro_SMTP; content:""Keylogger"",nocase; content:""Pro"",distance 0,nocase; content:""Activity"",distance 0,nocase; content:""Logs"",distance 0; pcre:""/^Keylogger\s+Pro\s+Activity\s+Logs/ims""; service:smtp; classtype:successful-recon-limited; sid:7592; rev:7; )"
7597,https://snort.org/rule_docs/1-7597,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spy lantern keylogger runtime detection""; flow:to_server,established; flowbits:isset,LanternKeylogger; content:""filename="",nocase; content:"".ltr"",distance 0,nocase; pcre:""/filename=\x22[^\r\n]*\x2Eltr\x22/ims""; service:smtp; classtype:successful-recon-limited; sid:7597; rev:9; )"
862,https://snort.org/rule_docs/1-862,['T1204'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP csh access""; flow:to_server,established; http_uri; content:""/csh"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-recon; sid:862; rev:21; )"
57983,https://snort.org/rule_docs/1-57983,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt""; flow:to_server,established; http_uri; content:""/autodiscover"",fast_pattern,nocase; http_cookie; content:""Email="",nocase; pcre:""/Email=[^\x3b\r\n]*?(\x2f|%(25)?2f)autodiscover/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:57983; rev:5; )"
19741,https://snort.org/rule_docs/1-19741,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER PWS.Win32.Scofted keylogger runtime detection""; flow:to_server,established; content:""STOR JUNIPER-"",depth 13,nocase; content:"".log|0D 0A|"",within 10; metadata:policy max-detect-ips drop; service:ftp; classtype:trojan-activity; sid:19741; rev:6; )"
17571,https://snort.org/rule_docs/1-17571,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated instantiation of ActiveX object - likely malicious""; flow:to_client,established; file_data; content:""new ActiveXObject|28|"",nocase; content:""unescape|28|"",within 20,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:17571; rev:9; )"
57468,https://snort.org/rule_docs/1-57468,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.SLIGHTPULSE variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/meeting_testjs.cgi"",fast_pattern,nocase; http_method; content:""POST""; http_client_body; pcre:""/(^|&)(name|img|cert)=/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57468; rev:1; )"
33222,https://snort.org/rule_docs/1-33222,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot""; flow:to_server,established; flowbits:isset,hawk.lgr; content:""=0D=0AClipboard"",fast_pattern,nocase; content:""=0D=0AKeyboard"",nocase; metadata:impact_flag red,ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:33222; rev:3; )"
41978,https://snort.org/rule_docs/1-41978,['T1189'],"alert tcp any any -> $HOME_NET 445 ( msg:""OS-WINDOWS Microsoft Windows SMB remote code execution attempt""; flow:to_server,established; content:""|FF|SMB3|00 00 00 00|"",depth 9,offset 4; byte_extract:2,26,TotalDataCount,relative,little; byte_test:2,>,TotalDataCount,20,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; classtype:attempted-admin; sid:41978; rev:5; )"
7164,https://snort.org/rule_docs/1-7164,['T1056'],"alert tcp $HOME_NET 10050 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - execute file server-to-client""; flow:to_client,established; flowbits:isset,winspy_execute_client-to-server; content:""/RF|16|"",fast_pattern,nocase; classtype:successful-recon-limited; sid:7164; rev:8; )"
23620,https://snort.org/rule_docs/1-23620,['T1102'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Malvertising network attempted redirect""; flow:to_client,established; file_data; content:"".php|22| name=|22|Twitter|22| scrolling=|22|auto|22| frameborder=|22|no|22| align=|22|center|22| height=|22|2|22| width=|22|2|22|></iframe>"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:23620; rev:6; )"
30515,https://snort.org/rule_docs/1-30515,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established,only_stream; content:""|18 03 01|"",depth 3; byte_test:2,>,128,0,relative; content:""|02|"",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30515; rev:11; )"
4917,https://snort.org/rule_docs/1-4917,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer javascript onload prompt obfuscation overflow attempt""; flow:to_client,established; file_data; content:""prompt"",nocase; content:""fillmem"",distance 0,nocase; content:""body"",nocase; content:""onLoad"",distance 0,nocase; content:""setTimeout"",distance 0,nocase; pcre:""/prompt\(fillmem[^\)]*\).*?<body\s+[^>]*onLoad\s*=\s*[\x22\x27]?setTimeout\(/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:4917; rev:16; )"
39911,https://snort.org/rule_docs/1-39911,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.HawkEye keylogger exfiltration attempt""; flow:to_server,established; content:""Subject: HawkEye Keylogger |7C|"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:39911; rev:3; )"
60496,https://snort.org/rule_docs/1-60496,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Exoshell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?"",nocase; content:""&scdir=/"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60496; rev:1; )"
50097,https://snort.org/rule_docs/1-50097,['T1566'],"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; http_header; content:""Last-Modified: Wed, 24 Nov 2010 00:39:06 GMT|0D 0A|"",fast_pattern,nocase; content:""Date: Thu, 24 Oct 2013 22:35:46 GMT""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:misc-attack; sid:50097; rev:2; )"
7169,https://snort.org/rule_docs/1-7169,['T1056'],"alert tcp $HOME_NET 868 <> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - information exchange""; flow:established; flowbits:isset,ABSystemSpy_Inforetrieve4; content:""chkCtr"",depth 6; classtype:successful-recon-limited; sid:7169; rev:9; )"
37384,https://snort.org/rule_docs/1-37384,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Emerson default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46ZGVmYXVsdA=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37384; rev:3; )"
58784,https://snort.org/rule_docs/1-58784,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""%2524%257B"",fast_pattern,nocase; pcre:""/%2524%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58784; rev:4; )"
39341,https://snort.org/rule_docs/1-39341,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FastPOS credit card data exfiltration""; flow:to_server,established; http_uri; content:""/cdosys.php?"",fast_pattern,nocase; content:""add&log="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:39341; rev:3; )"
5882,https://snort.org/rule_docs/1-5882,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spyagent runtime detect - alert notification""; flow:to_server,established; content:""This is an alert notification from SpyAgent"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5882; rev:9; )"
60824,https://snort.org/rule_docs/1-60824,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.GReatPost outbound connection attempt""; flow:to_client,established; file_data; content:""<title>GRP WebShell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60824; rev:1; )"
41459,https://snort.org/rule_docs/1-41459,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Osx.Keylogger.Elite variant outbound connection""; flow:to_server,established; http_uri; content:""/tracking/cm_mac.php"",fast_pattern,nocase; content:""clickid="",nocase; content:""funnel="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41459; rev:3; )"
37390,https://snort.org/rule_docs/1-37390,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Rockwell Automation default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW5pc3RyYXRvcjptbDExMDA="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37390; rev:3; )"
21037,https://snort.org/rule_docs/1-21037,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION randomized javascript encodings detected""; flow:to_client,established; file_data; content:""script""; content:""%u""; pcre:""/%u[0-1][0-9a-f]{2}[^\x29]*%u[0-1][0-9a-f]{2}[^\x29]*%u[0-1][0-9a-f]{2}[^\x29]*%u[0-1][0-9a-f]{2}/""; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:21037; rev:11; )"
25503,https://snort.org/rule_docs/1-25503,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Necurs Rootkit sba.cgi""; flow:to_server,established; http_method; content:""POST""; http_raw_uri; bufferlen:16; http_uri; content:""/cgi-bin/sba.cgi"",fast_pattern,nocase; http_client_body; pcre:""/[^\x20-\x7e\x0d\x0a]{4}/""; metadata:ruleset community; service:http; T1014; classtype:trojan-activity; sid:25503; rev:4; )"
32772,https://snort.org/rule_docs/1-32772,['T1566'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Adobe License Key email scam phishing attempt""; flow:to_server,established; content:""Content-Disposition|3A 20|attachment"",nocase; content:""License_Key_"",within 50,fast_pattern,nocase; content:"".zip"",within 4,distance 6,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; classtype:trojan-activity; sid:32772; rev:3; )"
38724,https://snort.org/rule_docs/1-38724,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Renegin outbound GET attempt""; flow:to_server,established; content:""Logger%20Details|3A|%20%0D%0AServer%20Name|3A|%20"",fast_pattern,nocase; content:""%0D%0AKeylogger%20Enabled|3A|%20""; content:""0D%0AClipboard-Logger%20Enabled|3A|%20""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:38724; rev:3; )"
31303,https://snort.org/rule_docs/1-31303,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Hadeki variant outbound connection""; flow:to_server,established; http_uri; content:""Keylogger-Output"",fast_pattern,nocase; content:""Date:""; content:""Time:""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:31303; rev:4; )"
59023,https://snort.org/rule_docs/1-59023,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.Antichat outbound connection attempt""; flow:to_client,established; file_data; content:""<title>"",nocase; content:""Antichat Shell"",within 100,fast_pattern,nocase; content:""</title>"",within 30; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59023; rev:1; )"
58722,https://snort.org/rule_docs/1-58722,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_uri; content:""${jndi:"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58722; rev:5; )"
47899,https://snort.org/rule_docs/1-47899,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.OilRig variant outbound connection""; flow:to_server,established; http_uri; content:""/khc?"",depth 5; pcre:""/\x2fkhc\x3f[A-F0-9]{3,84}$/""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:47899; rev:2; )"
10181,https://snort.org/rule_docs/1-10181,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger systemsleuth runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""SystemSleuth"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*SystemSleuth/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10181; rev:11; )"
37391,https://snort.org/rule_docs/1-37391,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Samsung default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""cm9vdDpya3dqc2R1c3JudGg="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37391; rev:3; )"
27756,https://snort.org/rule_docs/1-27756,['T1078'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP RedHat Piranha Virtual Server Package default passwd and arbitrary command execution attempt""; flow:to_server,established; http_uri; content:""/piranha/secure/passwd.php3"",fast_pattern,nocase; content:""passwd=ACCEPT"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:27756; rev:4; )"
13568,https://snort.org/rule_docs/1-13568,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger sys keylog 1.3 advanced runtime detection""; flow:to_server,established; content:""This is the file kept 'LOG', of the program Sys="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13568; rev:9; )"
51923,https://snort.org/rule_docs/1-51923,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-OBFUSCATION Possible PHP eval backdoor upload attempt""; flow:to_server,established; content:""eval($ud4d324d("",fast_pattern,nocase; content:""<?""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:51923; rev:1; )"
57385,https://snort.org/rule_docs/1-57385,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION Javascript obfuscation using meaningless bitshift""; flow:to_client,established; file_data; content:""|28|0>>|28|0>>0|29 29|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:57385; rev:1; )"
59262,https://snort.org/rule_docs/1-59262,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.C0ders outbound connection attempt""; flow:to_client,established; file_data; content:""|3C|TITLE|3E 2E 3A 5B|csh|5D 3A 2E 7C 20 5B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59262; rev:1; )"
29580,https://snort.org/rule_docs/1-29580,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox SVG data processing obfuscated memory corruption attempt""; flow:to_client,established; file_data; content:""split|28 22 22 29 2E|reverse|28 29 2E|join|28 22 22 29|""; content:""appendItem"",distance 1; content:""replaceItem"",distance 1; pcre:""/(?P<N1>[a-zA-Z\x5f][a-zA-Z\x5f0-9]*\x2e)appendItem(?!.+?(?P=N1)appendItem).+?(?P=N1)replaceItem/s""; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:29580; rev:4; )"
52081,https://snort.org/rule_docs/1-52081,['T1187'],"alert tcp any any -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner service negotiation attack attempt""; flow:to_client,established; content:""|3B E1 80 8E 04 61 1C FF 73 6F 56 AF 01 BF 72 83 C2 72 18 E8|"",fast_pattern,nocase; content:""|30 1E 17 0D 31 39 30 38 31 36 32 32 30 36 31 31 5A 17 0D 32 39 30 38 31 33 32 32 30 36 31 31 5A|""; metadata:policy max-detect-ips drop,policy security-ips drop; classtype:misc-attack; sid:52081; rev:1; )"
8544,https://snort.org/rule_docs/1-8544,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger nicespy runtime detection - smtp""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""JMail"",distance 0,nocase; content:""by"",distance 0,nocase; content:""Dimac"",distance 0,nocase; content:""NiceSpy's"",nocase; content:""email"",distance 0,nocase; content:""assistant"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*JMail[^\r\n]*by[^\r\n]*Dimac/ims""; pcre:""/^NiceSpy\x27s\s+email\s+assistant/ims""; service:smtp; classtype:successful-recon-limited; sid:8544; rev:9; )"
30781,https://snort.org/rule_docs/1-30781,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|16 03 02|""; byte_jump:2,0,relative; content:""|18 03 02|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30781; rev:5; )"
7505,https://snort.org/rule_docs/1-7505,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger actualspy runtime detection - smtp""; flow:to_server,established; content:""<title>"",nocase; content:""Actual"",distance 0,nocase; content:""Spy"",distance 0,nocase; content:""software"",distance 0,nocase; content:""report"",distance 0,nocase; content:""</title>"",distance 0,nocase; pcre:""/\<title\>Actual\s+Spy\s+software\s+report\<\x2Ftitle\>/ims""; service:smtp; classtype:successful-recon-limited; sid:7505; rev:10; )"
9648,https://snort.org/rule_docs/1-9648,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger emailspypro runtime detection""; flow:to_server,established; content:""X-FILTERED-BY-GHOST|3A|"",fast_pattern,nocase; content:""1""; pcre:""/^X-FILTERED-BY-GHOST\x3a[^\r\n]*1/ims""; service:smtp; classtype:successful-recon-limited; sid:9648; rev:10; )"
10099,https://snort.org/rule_docs/1-10099,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection""; flow:to_server,established; content:""url"",depth 3,nocase; flowbits:set,Win32.RemoteKeylog.b.website; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:10099; rev:7; )"
19318,https://snort.org/rule_docs/1-19318,['T1078'],"alert udp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Dos.Tool.LOIC UDP default U dun goofed attack""; flow:stateless,no_stream; content:""U dun goofed"",fast_pattern,nocase; detection_filter:track by_src,count 10,seconds 2; metadata:policy max-detect-ips drop; classtype:attempted-dos; sid:19318; rev:6; )"
56611,https://snort.org/rule_docs/1-56611,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Cobalt Strike beacon outbound connection attempt""; flow:to_server,established; http_uri; content:""/notification""; http_header; content:""Accept: */*""; content:""Accept-Encoding: gzip, deflate, br""; content:""Accept-Language: en-US|0D 0A|""; content:""{|22|locale|22|:|22|en|22|,|22|channel|22|:|22|prod|22|,|22|addon|22|:|22|"",fast_pattern,nocase; content:""nid""; content:""msg-""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56611; rev:1; )"
35471,https://snort.org/rule_docs/1-35471,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666 ( msg:""MALWARE-CNC Win.Trojan.Baisogu outbound connection""; flow:to_server; content:""/9hao/count.asp?"",fast_pattern,nocase; content:""mac="",depth 4,offset 21; content:""&ver="",within 25; content:""&tjuser="",within 35; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:35471; rev:3; )"
12141,https://snort.org/rule_docs/1-12141,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger logit v1.0 runtime detection""; flow:to_server,established; content:""Subject|3A| Logger Results"",nocase; content:""|0D 0A 0D 0A|<|7C|"",distance 0; content:""|7C|>|0D 0A 0D 0A|"",distance 0; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12141; rev:7; )"
1122,https://snort.org/rule_docs/1-1122,['T1087'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/passwd file access attempt""; flow:to_server,established; http_uri; content:""/etc/passwd"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:1122; rev:16; )"
33941,https://snort.org/rule_docs/1-33941,['T1218'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Executable control panel file download request""; flow:to_server,established; http_uri; content:"".cpl"",fast_pattern,nocase; pcre:""/\x2ecpl([\?\x5c\x2f]|$)/ims""; metadata:policy max-detect-ips drop,policy security-ips alert; service:http; classtype:misc-activity; sid:33941; rev:5; )"
32335,https://snort.org/rule_docs/1-32335,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; content:"" () {"",depth 50; http_uri; bufferlen:>0; pkt_data; content:!""HTTP/""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:32335; rev:2; )"
885,https://snort.org/rule_docs/1-885,['T1204'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP bash access""; flow:to_server,established; http_uri; content:""/bash"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:885; rev:21; )"
7545,https://snort.org/rule_docs/1-7545,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger PerfectKeylogger runtime detection - flowbit set 2""; flow:to_server,established; flowbits:isset,PerfectKeylogger1; content:""filename=|22|keystrokes.html|22|"",depth 300,nocase; flowbits:set,PerfectKeylogger2; flowbits:noalert; service:smtp; classtype:successful-recon-limited; sid:7545; rev:6; )"
10097,https://snort.org/rule_docs/1-10097,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 456 ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection""; flow:to_server,established; content:""info"",depth 4,nocase; flowbits:set,Win32.RemoteKeylog.b.info; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:successful-recon-limited; sid:10097; rev:7; )"
19325,https://snort.org/rule_docs/1-19325,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger WL-Keylogger outbound connection""; flow:to_server,established; flowbits:isset,Malware_Keylogger_InitConnection; content:""ServerDetails|7C|"",depth 14,nocase; pcre:""/^ServerDetails\x7c[^\r\n]*\x7c[^\r\n]*\x7c/ims""; metadata:policy max-detect-ips drop; classtype:trojan-activity; sid:19325; rev:5; )"
38876,https://snort.org/rule_docs/1-38876,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Obfuscated exploit download attempt""; flow:to_client,established; file_data; content:""56,55,44,49,49,53,44,57,57,44,49,49,52,44,49,48,53,44,49,49,50,44,49,49,54,44,52,54,44,56,51,44,49,48,52,44,49,48,49,44,49,48,56,44,49,48,56"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:38876; rev:2; )"
7161,https://snort.org/rule_docs/1-7161,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 10050 ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - download file client-to-server""; flow:to_server,established; content:""/CD"",fast_pattern,nocase; pcre:""/\x2FCD[^\r\n]*\x18\x16/ims""; flowbits:set,winspy_download_client-to-server; flowbits:noalert; classtype:successful-recon-limited; sid:7161; rev:6; )"
2547,https://snort.org/rule_docs/1-2547,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER HP Web JetAdmin remote file upload attempt""; flow:to_server,established; http_uri; content:""/plugins/hpjwja/script/devices_update_printer_fw_upload.hts"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:2547; rev:11; )"
42835,https://snort.org/rule_docs/1-42835,"['T1505', 'T1219']","alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""=edoced_46esab"",fast_pattern,nocase; content:""z0=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:42835; rev:5; )"
30549,https://snort.org/rule_docs/1-30549,['T1005'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:""SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt""; flow:to_server,established; content:""[masscan/1.0]""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30549; rev:2; )"
44563,https://snort.org/rule_docs/1-44563,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; http_header; content:""CF-RAY: ""; content:""=|0D 0A|"",within 3,distance 27; pcre:""/CF-RAY: [a-z0-9]{27}=\x0d\x0a/i""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:44563; rev:4; )"
25504,https://snort.org/rule_docs/1-25504,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Necurs Rootkit op.cgi""; flow:to_server,established; http_method; content:""POST""; http_raw_uri; bufferlen:15; http_uri; content:""/cgi-bin/op.cgi"",fast_pattern,nocase; http_client_body; pcre:""/[^\x20-\x7e\x0d\x0a]{4}/""; metadata:ruleset community; service:http; T1014; classtype:trojan-activity; sid:25504; rev:4; )"
29789,https://snort.org/rule_docs/1-29789,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Careto plugin download""; flow:to_server,established; http_uri; content:""/ag/plugin.crx"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; T1176; classtype:trojan-activity; sid:29789; rev:4; )"
29756,https://snort.org/rule_docs/1-29756,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP IBM Tivoli Provisioning Manager express user.updateUserValue sql injection attempt""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/tpmx/register.do""; http_client_body; content:""|25|2c""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:29756; rev:8; )"
31859,https://snort.org/rule_docs/1-31859,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 8087 ( msg:""EXPLOIT-KIT Scanbox exploit kit exfiltration attempt""; flow:to_server,established; content:""projectid="",depth 10,nocase; content:""&seed="",within 40,nocase; content:""&ip="",within 40,nocase; content:""&referrer="",within 40,nocase; content:""&agent="",within 40,nocase; content:""&location="",within 250,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:31859; rev:3; )"
24801,https://snort.org/rule_docs/1-24801,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP IBM Tivoli Provisioning Manager Express asset.getmimetype sql injection attempt""; flow:to_server,established; http_uri; content:""/tpmx/getAttachment"",fast_pattern,nocase; pcre:""/^.*?\/tpmx\/getAttachment.*?file(Type|Name)=[^&$]*?\x27/i""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:24801; rev:9; )"
56892,https://snort.org/rule_docs/1-56892,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 445 ( msg:""MALWARE-CNC Win.Trojan.BasicPipeShell variant communication attempt""; flow:to_server,established; content:""|FE|SMB"",depth 4,offset 4; content:""|05 00|"",within 2,distance 8; content:""|70 00 69 00 70 00 65 00 73 00 68 00 65 00 6C 00 6C 00 2D 00 70 00 69 00 70 00 65 00 6E 00 61 00 6D 00 65 00|""; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; classtype:trojan-activity; sid:56892; rev:1; )"
44560,https://snort.org/rule_docs/1-44560,['T1059'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-CNC Word.Trojan.Emotet obfuscated powershell""; flow:to_server,established; file_data; flowbits:isset,file.doc|file.xls; content:""powershell"",fast_pattern,nocase; pcre:""/powershell\s*?-e\s*?[A-Za-z0-9+\/=]{20}/i""; metadata:impact_flag red; service:smtp; classtype:trojan-activity; sid:44560; rev:3; )"
59927,https://snort.org/rule_docs/1-59927,['T1094'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Jsp.Webshell.TinyUploader upload attempt""; flow:to_server,established; content:""java.io.FileOutputStream"",fast_pattern,nocase; content:""<%""; content:""request"",within 100; content:""write""; content:""getParameter"",within 100; isdataat:!600; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59927; rev:2; )"
49531,https://snort.org/rule_docs/1-49531,['T1187'],"alert tcp any any -> $SMTP_SERVERS 25 ( msg:""INDICATOR-COMPROMISE Responder poisoner download attempt""; flow:to_server,established; file_data; content:""#|21|/usr/bin/env python|0A|# This file is part of Responder"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-attack; sid:49531; rev:1; )"
56593,https://snort.org/rule_docs/1-56593,['T1043'],"alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:""MALWARE-CNC Cobalt Strike DNS beacon inbound TXT record""; flow:to_client; content:""|00 01 00 01|"",depth 4,offset 4; content:""|03|"",within 15; content:""|0A|_domainkey"",within 11,distance 3; content:""|00 00 10 00 01 C0 0C 00 10 00 01 00 00 00 02 01 00 FF|v=DKIM1|5C 3B| p=""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:dns; classtype:trojan-activity; sid:56593; rev:1; )"
60296,https://snort.org/rule_docs/1-60296,['T1505'],"alert file ( msg:""MALWARE-OTHER Php.Webshell.Cybershell download attempt""; flow:to_client,established; file_data; content:""header(|22|Expires: |22|.date(|22|r|22|,mktime(0,0,0,1,1,2030)))|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:60296; rev:1; )"
7159,https://snort.org/rule_docs/1-7159,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 10050 ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - upload file client-to-server""; flow:to_server,established; content:""/CU"",nocase; content:""True"",distance 0,nocase; pcre:""/\x2FCU[^\r\n]*\x18\d+\x18True\x18\x16/ims""; flowbits:set,winspy_upload_client-to-server; flowbits:noalert; classtype:successful-recon-limited; sid:7159; rev:5; )"
7551,https://snort.org/rule_docs/1-7551,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger ardamax keylogger runtime detection - smtp""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""ATL"",distance 0,nocase; content:""CSmtp"",distance 0,nocase; content:""Class"",distance 0,nocase; content:""Mailer"",distance 0,nocase; content:""by"",distance 0,nocase; content:""Robert"",distance 0,nocase; content:""Simpson"",distance 0,nocase; pcre:""/^X-Mailer\x3A[^\r\n]*ATL\s+CSmtp\s+Class\s+Mailer\s+by\s+Robert\s+Simpson\s+\x28robert\x40blackcastlesoft\x2Ecom\x29/ims""; service:smtp; classtype:successful-recon-limited; sid:7551; rev:9; )"
6384,https://snort.org/rule_docs/1-6384,['T1056'],"alert udp $EXTERNAL_NET any -> 255.255.255.255 15164 ( msg:""MALWARE-OTHER Keylogger stealthwatcher 2000 runtime detection - agent discover broadcast""; flow:to_server; content:""|00|]B|00 0A 02 08 FE 01 FC 12 00|"",depth 12; classtype:successful-recon-limited; sid:6384; rev:9; )"
28931,https://snort.org/rule_docs/1-28931,['T1218'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer CHM file load attempt""; flow:to_client,established; file_data; content:""showHelp("",fast_pattern,nocase; content:"".chm"",within 40,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:28931; rev:3; )"
39343,https://snort.org/rule_docs/1-39343,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FastPOS keylog exfiltration""; flow:to_server,established; http_uri; content:""/cdosys.php?"",fast_pattern,nocase; content:""key&log=TWND"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:39343; rev:3; )"
37313,https://snort.org/rule_docs/1-37313,['T1020'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-OTHER Multiple products external entity data exfiltration attempt""; flow:to_server,established; file_data; content:""<!ENTITY"",nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; content:""<!ENTITY"",distance 0,nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-attack; sid:37313; rev:5; )"
12130,https://snort.org/rule_docs/1-12130,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - get sys info""; flow:to_client,established; flowbits:isset,RemoteKeyLog.b.Info_detection; content:""Product Name"",depth 12; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12130; rev:5; )"
47137,https://snort.org/rule_docs/1-47137,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP HP VAN SDN Controller default token authentication attempt""; flow:to_server,established; http_header; content:""X-Auth-Token|3A|"",nocase; content:""AuroraSdnToken37"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:47137; rev:2; )"
47399,https://snort.org/rule_docs/1-47399,['T1059'],"alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE Microsoft cmd.exe outbound shell attempt""; content:""Microsoft Windows XP [Version"",depth 29; metadata:policy max-detect-ips drop; classtype:attempted-user; sid:47399; rev:2; )"
26592,https://snort.org/rule_docs/1-26592,['T1220'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-WEBKIT Apple Safari Webkit libxslt arbitrary file creation attempt""; flow:to_server,established; file_data; content:""http://icl.com/saxon"",fast_pattern,nocase; content:"":output"",nocase; pcre:""/\s*[^>]file=/Ri""; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:26592; rev:6; )"
23611,https://snort.org/rule_docs/1-23611,['T1027'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt""; flow:to_server,established; flowbits:isset,file.pdf; file_data; content:""<template xmlns=""; content:""http|3A|//www.xfa.org/"",distance 1; content:""<event activity"",distance 0; content:""initialize"",within 50,distance 1; content:""application/x-javascript"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:23611; rev:10; )"
59259,https://snort.org/rule_docs/1-59259,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Bypass inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?path=|2F|"",fast_pattern,nocase; content:""&x="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59259; rev:1; )"
36666,https://snort.org/rule_docs/1-36666,['T1571'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Tentobr outbound connection""; flow:to_server,established; http_uri; content:""/botnet/suca.php"",fast_pattern,nocase; http_raw_uri; bufferlen:16; http_client_body; content:""entradatrasera="",depth 15,nocase; content:""&key="",distance 0; content:""&pais="",distance 0; content:""&timeout="",distance 0; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36666; rev:3; )"
30516,https://snort.org/rule_docs/1-30516,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established,only_stream; content:""|18 03 02|"",depth 3; byte_test:2,>,128,0,relative; content:""|02|"",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30516; rev:11; )"
23934,https://snort.org/rule_docs/1-23934,['T1190'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP Symantec Web Gateway blocked.php blind sql injection attempt""; flow:to_server,established; http_uri; content:""/blocked.php"",fast_pattern,nocase; content:""id="",nocase; pcre:""/[\x3f\x26]id=\d*?[\x28\x29\x22\x27]/is""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:23934; rev:11; )"
59348,https://snort.org/rule_docs/1-59348,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.CWShell outbound connection attempt""; flow:to_client,established; file_data; content:""<b>uname -a:"",fast_pattern,nocase; content:""<b>Server Name:"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59348; rev:1; )"
57463,https://snort.org/rule_docs/1-57463,['T1071'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE webshell variant access""; flow:to_client,established; file_data; content:""<form action=|22 22| method=|22|GET|22|>""; content:""<input type=|22|text|22| name=|22|cmd|22|"",distance 0; content:""<input type=|22|text|22| name=|22|serverid|22|"",distance 0,fast_pattern; content:""<input type=|22|submit|22| value=|22|Run|22|>"",distance 0; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57463; rev:1; )"
7513,https://snort.org/rule_docs/1-7513,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger watchdog runtime detection - init connection""; flow:to_server,established; flowbits:isset,WatchDog_Init_Connection; content:""I|3A|NAME|3A|"",fast_pattern,nocase; pcre:""/^I\x3aNAME\x3a/ims""; metadata:impact_flag red; classtype:successful-recon-limited; sid:7513; rev:7; )"
13567,https://snort.org/rule_docs/1-13567,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger msn spy monitor runtime detection""; flow:to_server,established; content:""<TITLE>MSN Spy Monitor Logging Report</TITLE>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13567; rev:8; )"
5778,https://snort.org/rule_docs/1-5778,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwpe windows activity logs""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""HWPE Windows Activity LOG"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5778; rev:9; )"
36338,https://snort.org/rule_docs/1-36338,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Apple iTunes Connect HTTP response phishing attempt""; flow:to_client,established; file_data; content:""<!-- PHOEN!X -->"",fast_pattern,nocase; content:""apass""; content:""submit.x"",within 100; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:36338; rev:3; )"
7837,https://snort.org/rule_docs/1-7837,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spyoutside runtime detection - email delivery""; flow:to_server,established; content:""From|3A|"",nocase; content:""SpyOuTSiDe@CurrenTChaoS.Tk"",distance 0,nocase; pcre:""/^From\x3A\s+SpyOuTSiDe\x40CurrenTChaoS\x2ETk/ims""; content:""Subject|3A|"",nocase; content:""SpYOuTSiDe"",distance 0,nocase; content:""transmission"",distance 0,nocase; content:""with"",distance 0,nocase; content:""log"",distance 0,nocase; pcre:""/^Subject\x3A\s+\x5B\d+\x5D\x2D\s+SpYOuTSiDe\s+transmission\s+with\s+log\s+\x2D/ims""; service:smtp; classtype:successful-recon-limited; sid:7837; rev:9; )"
28255,https://snort.org/rule_docs/1-28255,['T1566'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Kuluoz Potential phishing URL""; flow:to_server,established; http_uri; content:""/get.php?invite="",fast_pattern,nocase; http_header; content:""Accept-Encoding: gzip""; http_uri; pcre:""/^\/get.php\?invite=.*?=$/m""; http_header; content:!""Referer:""; metadata:impact_flag red,ruleset community; service:http; T1192; classtype:trojan-activity; sid:28255; rev:4; )"
13278,https://snort.org/rule_docs/1-13278,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger advanced spy 4.0 runtime detection""; flow:to_server,established; content:""Advanced"",nocase; content:""Spy"",distance 0,nocase; content:""Report"",distance 0,nocase; content:""for"",distance 0,nocase; pcre:""/Advanced\s+Spy\s+Report\s+for/ims""; flowbits:set,AdvancedSpy_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13278; rev:7; )"
50099,https://snort.org/rule_docs/1-50099,['T1187'],"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; http_header; content:""Date: Wed, 12 Sep 2012 13:06:55 GMT|0D 0A|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:misc-attack; sid:50099; rev:1; )"
12128,https://snort.org/rule_docs/1-12128,['T1056'],"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger remotekeylog.b runtime detection - init connection""; flow:to_client,established; content:""WNDkServer"",depth 10; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:12128; rev:5; )"
29886,https://snort.org/rule_docs/1-29886,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Crypi.A outbound keylogger traffic""; flow:to_server,established; http_uri; content:""/key2/gate.php?name="",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:29886; rev:4; )"
59265,https://snort.org/rule_docs/1-59265,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C0ders upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""c0derz shell"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59265; rev:1; )"
50954,https://snort.org/rule_docs/1-50954,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:""JHg9JF9QT1NUWy"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50954; rev:1; )"
31858,https://snort.org/rule_docs/1-31858,['T1189'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""EXPLOIT-KIT Scanbox exploit kit enumeration code detected""; flow:to_server,established; file_data; content:""document|2E|createElement|28|unescape|28 22 25|3Ciframe|25|20id|25|3D"",fast_pattern,nocase; content:""|2E|crypt|2E|_utf8_encode""; content:""|2E|push|28|""; content:""|3D 3D|c|3A 5C 5C|Program Files|5C 5C|"",within 30; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:31858; rev:3; )"
12226,https://snort.org/rule_docs/1-12226,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger overspy runtime detection""; flow:to_server,established; content:""Subject|3A| OverSpy Surveillance Data"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12226; rev:8; )"
60284,https://snort.org/rule_docs/1-60284,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CrewShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?"",nocase; content:""&dir&pic="",fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60284; rev:1; )"
31975,https://snort.org/rule_docs/1-31975,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; content:""%3D%28%29+%7B"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:31975; rev:6; )"
7158,https://snort.org/rule_docs/1-7158,['T1056'],"alert tcp $HOME_NET 10050 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - remote conn server-to-client""; flow:to_client,established; flowbits:isset,winspy_conn_client-to-server; content:""/CK|16|"",depth 4,nocase; classtype:successful-recon-limited; sid:7158; rev:7; )"
36603,https://snort.org/rule_docs/1-36603,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $FTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.QVKeylogger outbound variant connection""; flow:to_server,established; content:""STOR public_html"",nocase; content:"".rar|0D 0A|"",within 25,nocase; metadata:impact_flag red; service:ftp; classtype:trojan-activity; sid:36603; rev:3; )"
56596,https://snort.org/rule_docs/1-56596,['T1094'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC MultiOS.Malware.GORAT outbound communications attempt""; flow:to_server,established; http_method; content:""GET""; pkt_data; content:""|0D 0A|Cookie: SID1="",fast_pattern,nocase; http_header; content:!""|0D 0A|Referer:""; content:!""|0D 0A|Accept""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56596; rev:1; )"
45483,https://snort.org/rule_docs/1-45483,['T1102'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Pdf.Phishing.Agent variant outbound connection detected""; flow:to_server,established; http_uri; content:""/cache/dropbox1/dropbox/"",fast_pattern,nocase; pkt_data; content:""//cache/dropbox1/dropbox/"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:45483; rev:3; )"
50277,https://snort.org/rule_docs/1-50277,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt""; flow:to_server,established; http_uri; content:""/temporary_listen_addresses/wsman"",fast_pattern,nocase; http_cookie; content:""_reguestguid"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:50277; rev:4; )"
18241,https://snort.org/rule_docs/1-18241,['T1047'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""2745E5F5-D234-11D0-847A-00C04FD7BB08"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18241; rev:17; )"
27961,https://snort.org/rule_docs/1-27961,['T1014'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit upload attempt""; flow:to_server,established; file_data; content:""|22|opener: wrote LittleSnitch StartupParameters.plist |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:27961; rev:3; )"
46067,https://snort.org/rule_docs/1-46067,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.yty plugin downloader initial outbound connection""; flow:to_server,established; http_header; content:""Expect: 100-continue"",fast_pattern,nocase; http_client_body; content:""pc=""; content:""pc_data=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1176; classtype:trojan-activity; sid:46067; rev:2; )"
59931,https://snort.org/rule_docs/1-59931,['T1094'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Chopper upload attempt""; flow:to_server,established; content:""DriverManager.getConnection""; content:""ServletOutputStream""; content:""ResultSetMetaData""; content:""request.getParameter""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59931; rev:2; )"
10088,https://snort.org/rule_docs/1-10088,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger beyond Keylogger runtime detection - log sent by smtp""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""Beyond"",distance 0,nocase; content:""Keylogger"",distance 0,nocase; content:""Report"",distance 0,nocase; pcre:""/^Subject\x3a[^\r\n]*Beyond\s+Keylogger\s+Report\x2E\s+Id\x3d\x5b.*\x5d/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10088; rev:10; )"
300369,https://snort.org/rule_docs/1-300369,['T1505'],"alert file ( msg:""MALWARE-OTHER JSP.Webshell.JSP2Shell transfer attempt""; file_data; content:""<%@""; content:""request.getParameter(|22|editfile|22|)|3B|"",distance 0,nocase; content:""request.getParameter(|22|path|22|)|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:300369; rev:1; )"
58725,https://snort.org/rule_docs/1-58725,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_uri; content:""${lower:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58725; rev:5; )"
60642,https://snort.org/rule_docs/1-60642,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Microsoft Exchange Server remote code execution attempt""; flow:to_server,established; http_uri; content:""autodiscover.json"",fast_pattern,nocase; content:""Powershell"",distance 0,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:60642; rev:3; )"
59347,https://snort.org/rule_docs/1-59347,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CWShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; http_client_body; content:""filelist=File+List"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59347; rev:1; )"
16268,https://snort.org/rule_docs/1-16268,['T1014'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.tdss.1.gen install-time detection - yournewsblog.net""; flow:to_server,established; http_uri; content:""/tdss/""; pkt_data; content:""Host|3A| yournewsblog.net"",nocase; service:http; classtype:trojan-activity; sid:16268; rev:8; )"
33223,https://snort.org/rule_docs/1-33223,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET [25,587] ( msg:""MALWARE-CNC Win.Trojan.HawkEye Keylogger exfiltration attempt - clipboard and screenshot""; flow:to_server,established; flowbits:isset,hawk.lgr; content:""name=screenshot"",fast_pattern,nocase; pcre:""/name\x3dscreenshot\d+\x2e/i""; metadata:impact_flag red,ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:33223; rev:3; )"
38259,https://snort.org/rule_docs/1-38259,['T1059'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; content:""/news.php HTTP/1.1|0D 0A|Cookie: SESSION"",fast_pattern,nocase; http_header; content:""User-Agent: Mozilla/5.0 (Windows NT 6.1|3B| WOW64|3B| Trident/7.0|3B| rv:11.0) like Gecko""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:38259; rev:5; )"
45968,https://snort.org/rule_docs/1-45968,['T1020'],"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""MALWARE-CNC Win.Trojan.UDPOS outbound data exfiltration""; flow:to_server; isdataat:150; content:""|0F|""; content:""|04|note"",within 5,distance 15,fast_pattern; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dns; T1020; classtype:trojan-activity; sid:45968; rev:2; )"
59926,https://snort.org/rule_docs/1-59926,['T1059'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE Python remote shell spawn attempt""; flow:to_server,established; http_uri; content:""pty.spawn(|22|/bin/""; content:""sh"",within 10; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:misc-attack; gid:1; sid:59926; rev:2; )"
57541,https://snort.org/rule_docs/1-57541,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/compcheckresult.cgi"",fast_pattern,nocase; content:""id="",nocase; pcre:""/[?&]id=/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57541; rev:1; )"
300357,https://snort.org/rule_docs/1-300357,['T1505'],"alert file ( msg:""MALWARE-OTHER Php.Webshell.HiddenShell transfer attempt""; file_data; content:""<?$"",depth 3; content:!""|0A|"",within 1000; content:""|3B|eval(gzuncompress(base64_decode("",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:300357; rev:1; )"
38386,https://snort.org/rule_docs/1-38386,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection""; flow:to_server,established; content:""PASS Goodman1986|0D 0A|"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ftp; T1056; classtype:trojan-activity; sid:38386; rev:3; )"
30785,https://snort.org/rule_docs/1-30785,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|18 03 00|""; byte_jump:2,0,relative; content:""|18 03 00|"",within 3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30785; rev:4; )"
60452,https://snort.org/rule_docs/1-60452,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Erne inbound connection attempt""; flow:to_server,established; http_client_body; content:""execfunc="",nocase; content:""command="",nocase; content:""Run=command"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60452; rev:1; )"
27966,https://snort.org/rule_docs/1-27966,"['T1505', 'T1219']","alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""=Response"",nocase; content:""FromBase64String"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:27966; rev:7; )"
43113,https://snort.org/rule_docs/1-43113,['T1070'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 ( msg:""SERVER-WEBAPP Schneider Electric IGSS dashboard deletion attempt""; flow:to_server,established; content:""|01 00 34 12 0D 00 00 00 00 00 00 00|"",depth 12,offset 2,fast_pattern; content:""|04|"",within 1,distance 4; content:""DASH"",distance 3,nocase; metadata:policy max-detect-ips drop; classtype:web-application-attack; sid:43113; rev:3; )"
16455,https://snort.org/rule_docs/1-16455,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger egyspy keylogger 1.13 runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""EgySpy"",distance 0,nocase; content:""Victim"",distance 0,nocase; pcre:""/^From\x3a[^\r\n]*EgySpy\s+Victim/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:16455; rev:6; )"
30517,https://snort.org/rule_docs/1-30517,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established,only_stream; content:""|18 03 03|"",depth 3; byte_test:2,>,128,0,relative; content:""|02|"",within 1,distance 2; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30517; rev:11; )"
12770,https://snort.org/rule_docs/1-12770,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows obfuscated RDS.Dataspace ActiveX exploit attempt""; flow:to_client,established; file_data; content:""00C04FC29E36|7C|983A|7C|11D0|7C|65A3|7C 7C|BD96C556|7C 7C|clsid"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12770; rev:16; )"
49460,https://snort.org/rule_docs/1-49460,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER ASP webshell upload attempt""; flow:to_server,established; file_data; content:""|89|PNG|0D 0A 1A 0A|"",depth 8; content:""<%"",distance 0; content:""language"",within 25,nocase; content:""%>"",within 35; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49460; rev:2; )"
7156,https://snort.org/rule_docs/1-7156,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger win-spy runtime detection - email delivery""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""_ANSMTP_"",distance 0,nocase; content:""Subject|3A|"",nocase; content:""LOG"",distance 0,nocase; content:""FILE"",distance 0,nocase; content:""Current"",distance 0,nocase; content:""User|3A|"",distance 0,nocase; pcre:""/^X-Mailer\x3A[^\r\n]*_\d+_ANSMTP_\d+_.*Subject\x3A[^\r\n]*LOG\s+FILE\s+Current\s+User\x3A/ims""; service:smtp; classtype:successful-recon-limited; sid:7156; rev:7; )"
43289,https://snort.org/rule_docs/1-43289,['T1087'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/shadow file access attempt""; flow:to_server,established; http_uri; content:""/etc/shadow"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:43289; rev:3; )"
7185,https://snort.org/rule_docs/1-7185,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger 007 spy software runtime detection - ftp""; flow:to_server,established; content:""STOR"",fast_pattern,nocase; pcre:""/^STOR\s+\x2E\x2F(kys|scr|Apps|Urls)[0-9]+\x2Etxt/ims""; service:ftp; classtype:successful-recon-limited; sid:7185; rev:10; )"
27538,https://snort.org/rule_docs/1-27538,['T1078'],"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-OTHER self-signed SSL certificate with default MyCompany Ltd organization name""; flow:to_client,established; ssl_state:server_hello; content:""|55 04 0A|""; content:""|0E|MyCompany Ltd"",within 14,distance 1; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:ssl; T1078; classtype:policy-violation; sid:27538; rev:4; )"
13281,https://snort.org/rule_docs/1-13281,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger email spy monitor 6.9 runtime detection""; flow:to_server,established; flowbits:isset,EmailSpyMonitor_detection; content:""<title>"",nocase; content:""Email"",distance 0,nocase; content:""Spy"",distance 0,nocase; content:""Monitor"",distance 0,nocase; content:""Logging"",distance 0,nocase; content:""Report"",distance 0,nocase; content:""</title>"",distance 0,nocase; pcre:""/\x3CTitle\x3EEmail\s+Spy\s+Monitor\s+Logging\s+Report\x3C\x2Ftitle\x3E/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13281; rev:6; )"
36198,https://snort.org/rule_docs/1-36198,['T1021'],"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Yakes variant certificate""; flow:to_client,established; content:""C00230-01..yiba6p"",fast_pattern; content:""|55 04 03 13 1E|C00230-01-f002 VPN Certificate"",within 35,distance 6; metadata:impact_flag red; service:ssl; classtype:trojan-activity; sid:36198; rev:3; )"
45174,https://snort.org/rule_docs/1-45174,['T1070'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-FIREFOX Mozilla download directory file deletion attempt""; flow:to_server,established; file_data; content:""<a href=|22|data:application/octet-stream,hello|22|>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:45174; rev:3; )"
1861,https://snort.org/rule_docs/1-1861,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 8080 ( msg:""SERVER-WEBAPP Linksys router default username and password login attempt""; flow:to_server,established; content:""YWRtaW46YWRtaW4""; pcre:""/^Authorization\x3a\s*Basic\s+(?-i)YWRtaW46YWRtaW4[=\s]/ims""; metadata:ruleset community; service:http; T1078; classtype:default-login-attempt; sid:1861; rev:18; )"
24435,https://snort.org/rule_docs/1-24435,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Novell ZENworks Asset Management default admin credentials function call attempt""; flow:to_server,established; http_uri; content:""/rtrlet/rtr"",fast_pattern,nocase; http_client_body; content:""username=ivanhoe"",nocase; content:""password=scott"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:24435; rev:8; )"
6190,https://snort.org/rule_docs/1-6190,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger eblaster 5.0 runtime detection""; flow:to_server,established; content:""X-SpectorSerial|3A|"",nocase; content:""X-SpectorMachineID|3A|"",fast_pattern,nocase; content:""X-SpectorBuild|3A|"",nocase; content:""eBlaster"",nocase; service:smtp; classtype:successful-recon-limited; sid:6190; rev:8; )"
48818,https://snort.org/rule_docs/1-48818,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Trojan.Agent variant outbound connection""; flow:to_server,established; http_header; content:""User-Agent|3A| xmsSofts_1.0.0_"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:48818; rev:2; )"
30569,https://snort.org/rule_docs/1-30569,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Trojan.Agent Funeral ceremony phishing attempt""; flow:to_client,established; http_header; content:""filename=FuneralCeremony_"",fast_pattern,nocase; content:"".zip"",nocase; file_data; content:""FuneralCeremony_""; content:"".exe"",distance 0,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:30569; rev:3; )"
33656,https://snort.org/rule_docs/1-33656,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Carbanak data exfiltration attempt""; flow:to_server,established; http_client_body; content:""Content-Disposition: form-data|3B| name=""; content:""upload"",within 10; content:""filename="",within 50; content:""listprocess.txt"",within 20,fast_pattern; http_raw_uri; bufferlen:168<=>184; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:33656; rev:3; )"
52621,https://snort.org/rule_docs/1-52621,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt""; flow:to_client,established; file_data; content:""window.onkeydown=function(e){if(""; content:""keyCode=="",within 100; content:""document.location.href="",within 1000; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:52621; rev:1; )"
41917,https://snort.org/rule_docs/1-41917,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Carel PlantVisorPRO default login attempt""; flow:to_server,established; http_uri; content:""/PlantVisorPRO/arch/manager/"",fast_pattern,nocase; http_client_body; content:""param1=debug"",nocase; content:""param2=pvprod3bug"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:41917; rev:3; )"
48531,https://snort.org/rule_docs/1-48531,['T1220'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer 11 VBScript execution policy bypass attempt""; flow:to_client,established; file_data; content:""ex = xml.transformNode(xsl)|3B 20|document.getElementById"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:48531; rev:2; )"
1394,https://snort.org/rule_docs/1-1394,['T1204'],"alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:""INDICATOR-SHELLCODE x86 inc ecx NOOP""; content:""AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA""; metadata:ruleset community; classtype:shellcode-detect; sid:1394; rev:17; )"
10089,https://snort.org/rule_docs/1-10089,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger beyond Keylogger runtime detection - log sent by ftp""; flow:to_server,established; content:""Open Beyond Keylogger"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10089; rev:11; )"
25391,https://snort.org/rule_docs/1-25391,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Sweet Orange exploit kit obfuscated payload download""; flow:to_client,established; flowbits:isset,java_user_agent; file_data; content:""|22 2A|"",depth 2; content:""s"",within 1,distance 2; content:""|27|"",within 1,distance 3; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:25391; rev:5; )"
18434,https://snort.org/rule_docs/1-18434,['T1574'],"alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:""FILE-OTHER Adobe Acrobat Reader plugin ace.dll dll-load exploit attempt""; flow:to_server,established; content:""a|00|c|00|e|00|.|00|d|00|l|00|l|00|"",fast_pattern,nocase; content:!""|00|a|00|c|00|e|00|.|00|d|00|l|00|l|00|"",nocase; service:netbios-ssn; classtype:attempted-user; sid:18434; rev:13; )"
57906,https://snort.org/rule_docs/1-57906,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt""; flow:to_server,established; http_uri; content:""/autodiscover"",fast_pattern,nocase; http_client_body; content:""Email="",nocase; pcre:""/(^|&)Email=[^&]*?(\x2f|%(25)?2f)autodiscover/im""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:57906; rev:6; )"
56583,https://snort.org/rule_docs/1-56583,['T1190'],"alert tcp any any -> any 88 ( msg:""MALWARE-TOOLS GhostPack Rubeus kerberos request attempt""; flow:to_server,established; content:""|05|"",depth 30; content:""|0A|"",within 1,distance 4; content:""Z""; content:""|A7 06 02 04 6C 69 6C 00|"",within 25; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; classtype:trojan-activity; gid:1; sid:56583; rev:2; )"
31564,https://snort.org/rule_docs/1-31564,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC Win.Trojan.CosmicDuke FTP data exfiltration""; flow:to_server,established; content:""STOR fp"",depth 7,fast_pattern; content:"".bin|0D 0A|"",within 6,distance 44; pcre:""/STOR fp[0-9A-F]{44}\x2ebin/""; metadata:impact_flag red; service:ftp-data; classtype:trojan-activity; sid:31564; rev:3; )"
37387,https://snort.org/rule_docs/1-37387,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Moxa default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46cm9vdA=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37387; rev:3; )"
12372,https://snort.org/rule_docs/1-12372,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger mg-shadow 2.0 runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Mailer"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*Mailer/ims""; content:""+++ MG-Shadow 2.0"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12372; rev:8; )"
7504,https://snort.org/rule_docs/1-7504,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 20 ( msg:""MALWARE-OTHER Keylogger actualspy runtime detection - ftp-data""; flow:to_client,established; content:""<title>"",nocase; content:""Actual"",distance 0,nocase; content:""Spy"",distance 0,nocase; content:""software"",distance 0,nocase; content:""report"",distance 0,nocase; content:""</title>"",distance 0,nocase; pcre:""/\<title\>Actual\s+Spy\s+software\s+report\<\x2Ftitle\>/ims""; classtype:successful-recon-limited; sid:7504; rev:10; )"
12792,https://snort.org/rule_docs/1-12792,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spy lantern Keylogger pro 6.0 runtime detection""; flow:to_server,established; content:""Attachment"",nocase; content:""contains"",distance 0,nocase; content:""Spy"",distance 0,nocase; content:""Lantern"",distance 0,nocase; content:""Keylogger"",distance 0,nocase; content:""log"",distance 0,nocase; content:""file"",distance 0,nocase; pcre:""/Attachment\s+contains\s+Spy\s+Lantern\s+Keylogger.*log\s+file\x2E/ims""; flowbits:set,SpyLanternKeylogger6_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:12792; rev:7; )"
25578,https://snort.org/rule_docs/1-25578,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake postal receipt HTTP Response phishing attack""; flow:to_client,established; http_header; content:""|3B 20|filename=PostalReceipt.zip|0D 0A|"",fast_pattern,nocase; file_data; content:""PostalReceipt.exe""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:25578; rev:4; )"
59925,https://snort.org/rule_docs/1-59925,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Multiple products OGNL expression injection attempt""; flow:to_server,established; http_uri; content:"".action"",nocase; content:""getRuntime""; content:""exec"",within 15; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:59925; rev:2; )"
19079,https://snort.org/rule_docs/1-19079,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer getElementById object corruption""; flow:to_client,established; file_data; content:""function post_info(info_array)""; content:""info_array.length|3B| i ++)"",distance 0; pcre:""/^\s*\x7B[^\x7D]*document\.createElement\('input'\)[^\x7D]*form\.appendChild\(plugin\)\s*\x7D/Rims""; content:""document.body.removeChild(form)|3B|""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19079; rev:9; )"
32950,https://snort.org/rule_docs/1-32950,['T1102'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Bladabindi variant outbound connection""; flow:to_server,established; http_header; content:""Host: pastebin.com"",fast_pattern,nocase; content:!""User-Agent""; http_uri; content:""download.php""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:32950; rev:4; )"
8356,https://snort.org/rule_docs/1-8356,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger spybuddy 3.72 runtime detection - send log out through email""; flow:to_server,established; flowbits:isset,SpyBuddy_SMTP; content:""SpyBuddy"",nocase; content:""Activity"",distance 0,nocase; content:""Logs"",distance 0; pcre:""/^SpyBuddy\s+Activity\s+Logs/ims""; service:smtp; classtype:successful-recon-limited; sid:8356; rev:7; )"
4060,https://snort.org/rule_docs/1-4060,['T1021'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:""APP-DETECT remote desktop protocol attempted administrator connection request""; flow:to_server,established; content:""|E0|"",depth 1,offset 5; content:""mstshash=Administr"",distance 0,nocase; classtype:misc-activity; sid:4060; rev:9; )"
26349,https://snort.org/rule_docs/1-26349,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Redkit exploit kit obfuscated portable executable""; flow:to_client,established; http_header; content:""filename=setup.exe"",fast_pattern,nocase; file_data; content:""|8B 7F AA 11 CE 52 0A 3D 76|"",depth 9; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:26349; rev:5; )"
24088,https://snort.org/rule_docs/1-24088,['T1048'],"alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.Bledoor TCP tunnel in ICMP""; content:""|08 00 45|"",depth 3,offset 12; content:""|00 00|"",within 2,distance 5; content:""|06|"",within 1,distance 1; content:""|00 00 00 00|"",within 4,distance 18; metadata:impact_flag red,policy max-detect-ips drop; classtype:trojan-activity; sid:24088; rev:6; )"
50468,https://snort.org/rule_docs/1-50468,['T1187'],"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_client,established; content:""|00 00 00 00 FD F3 01 80 84 D6 FB A3 01 35 CD 01 F0 00 00 10 00|"",fast_pattern,nocase; content:""|FF|SMB|72|"",depth 5,offset 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50468; rev:1; )"
43672,https://snort.org/rule_docs/1-43672,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla products obfuscated cross site scripting attempt""; flow:to_client,established; file_data; content:""&#xdc"",fast_pattern,nocase; content:""&#xdc""; content:""&#xdc"",distance 0; content:""&#xdc"",distance 0; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:43672; rev:3; )"
33566,https://snort.org/rule_docs/1-33566,['T1220'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox 3 xsl parsing heap overflow attempt""; flow:to_client,established; file_data; content:""<xsl:key name=|22|"",depth 15,offset 117,fast_pattern; content:""match=|22|"",within 7,distance 10; content:""use=|22|"",within 5,distance 10; content:""</xsl:stylesheet>"",within 17,distance 101; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:33566; rev:3; )"
15425,https://snort.org/rule_docs/1-15425,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP phpBB mod tag board sql injection attempt""; flow:to_server,established; http_uri; content:""tag_board.php"",fast_pattern,nocase; content:""action=delete"",nocase; content:""id="",nocase; pcre:""/tag_board\.php\x3F[^\r\n]*action=delete[^\r\n]*id=[^\r\n\x26]*(select|insert|delete)/ims""; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:15425; rev:14; )"
39755,https://snort.org/rule_docs/1-39755,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Trojan.Retefe variant malicious certificate installation page""; flow:to_client,established; file_data; content:""icanhazip.com"",fast_pattern,nocase; content:""powershell"",nocase; content:""-Exec"",within 35,nocase; content:""Sleep"",nocase; content:""taskkill"",within 35,nocase; content:""iexplore"",within 35,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:39755; rev:3; )"
37380,https://snort.org/rule_docs/1-37380,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP BinTec Elmeg default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46ZnVud2Vyaw=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37380; rev:3; )"
58739,https://snort.org/rule_docs/1-58739,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""lower"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58739; rev:5; )"
37385,https://snort.org/rule_docs/1-37385,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Hirschmann default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46cHJpdmF0ZQ=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37385; rev:3; )"
52259,https://snort.org/rule_docs/1-52259,['T1071'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Trojan.FakeUpdate outbound connection""; flow:to_server,established; content:""POST /1x1.png HTTP/"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:52259; rev:1; )"
300131,https://snort.org/rule_docs/1-300131,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP F5 BIG-IP iControl remote code execution attempt""; flow:to_server,established; http_header; content:""Connection|3A|"",nocase; content:""X-F5-Auth"",distance 0,fast_pattern,nocase; pcre:""/^Connection:[^\r\n]*?X-F5-Auth/im""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:300131; rev:2; )"
57465,https://snort.org/rule_docs/1-57465,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/licenseserverproto.cgi"",fast_pattern,nocase; http_client_body; content:""id="",nocase; pcre:""/(^|&)(server)?id=/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57465; rev:2; )"
26040,https://snort.org/rule_docs/1-26040,['T1218'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""EXPLOIT-KIT Crimeboss exploit kit - Portable Executable download attempt""; flow:to_server,established; http_uri; content:""/Plugin.cpl"",fast_pattern,nocase; http_header; content:"" Java/1""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:26040; rev:4; )"
42857,https://snort.org/rule_docs/1-42857,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP MVPower DVR Shell arbitrary command execution attempt""; flow:to_server,established; http_uri; bufferlen:>13; content:""/shell?"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:42857; rev:4; )"
36201,https://snort.org/rule_docs/1-36201,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""EXPLOIT-KIT Scanbox exploit kit exfiltration attempt""; flow:to_server,established; http_uri; content:""/new/newscan/i/?10"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:36201; rev:3; )"
19171,https://snort.org/rule_docs/1-19171,['T1574'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""BROWSER-IE Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt""; flow:to_server,established; http_uri; content:""|2F|ieshims.dll"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19171; rev:12; )"
38510,https://snort.org/rule_docs/1-38510,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.iSpySoft variant exfiltration attempt""; flow:to_server,established; http_raw_uri; bufferlen:11; http_method; content:""POST""; http_uri; content:""/api?upload"",fast_pattern,nocase; http_header; content:""Expect|3A 20|""; content:!""User-Agent""; content:!""Accept""; content:!""Referer""; metadata:impact_flag red,ruleset community; service:http; T1020; classtype:trojan-activity; sid:38510; rev:3; )"
5781,https://snort.org/rule_docs/1-5781,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwae windows activity logs""; flow:to_server,established; content:""Subject|3A| "",nocase; content:""HWAE Windows Activity LOG"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:5781; rev:9; )"
50951,https://snort.org/rule_docs/1-50951,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_client_body; content:""phpSpl01t="",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50951; rev:1; )"
6220,https://snort.org/rule_docs/1-6220,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger boss everyware runtime detection""; flow:to_server,established; content:""X-Mailer|3A| Boss Everyware"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:6220; rev:11; )"
12775,https://snort.org/rule_docs/1-12775,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS RealNetworks RealPlayer obfuscated Ierpplug.dll ActiveX exploit attempt""; flow:to_client,established; file_data; content:""VulObject = |22|IER|22| + |22|PCtl.I|22| + |22|ERP|22| + |22|Ctl.1|22 3B|"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12775; rev:13; )"
41461,https://snort.org/rule_docs/1-41461,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Osx.Keylogger.Elite variant outbound connection""; flow:to_server,established; http_uri; content:""/Mac/getInstallerSpecs/"",fast_pattern,nocase; content:""channel="",nocase; content:""info="",nocase; content:""enc-info="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41461; rev:3; )"
12049,https://snort.org/rule_docs/1-12049,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger apophis spy 1.0 runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""A-Spy"",distance 0,nocase; content:""Server"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*A-Spy[^\r\n]*Server/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12049; rev:6; )"
61083,https://snort.org/rule_docs/1-61083,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.IronShell outbound connection""; flow:to_client,established; file_data; content:""<title>"",nocase; content:"" ~ Shell I</title>"",within 100,fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61083; rev:1; )"
16137,https://snort.org/rule_docs/1-16137,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger cheat monitor runtime detection""; flow:to_server,established; content:""Report"",nocase; content:""@"",nocase; content:""name=cheatmonitorR_SCREEN.DATETIME."",fast_pattern,nocase; pcre:""/Report\x20\x40.*name\x3dcheatmonitorR\x5fSCREEN\x2eDATETIME/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:16137; rev:7; )"
5782,https://snort.org/rule_docs/1-5782,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger runtime detection - hwae word filtered echelon log""; flow:to_server,established; content:""Subject|3A| HWAE Word Filtered Echelon LOG"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5782; rev:9; )"
59094,https://snort.org/rule_docs/1-59094,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Generic upload attempt""; flow:to_server,established; file_data; content:""<?""; content:""function deltree($deldir) "",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59094; rev:1; )"
59930,https://snort.org/rule_docs/1-59930,['T1094'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Noop download attempt""; flow:to_client,established; file_data; content:""java.util.*""; content:""java.io.FileOutputStream"",distance 0; content:""request.getParameter(|22|name|22|)"",within 200,fast_pattern; content:""request.getParameter(|22|contentString|22|)""; isdataat:!300,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59930; rev:2; )"
32069,https://snort.org/rule_docs/1-32069,['T1204'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:""OS-OTHER Bash environment variable injection attempt""; flow:to_server,established; content:""PASS "",depth 5; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; classtype:attempted-admin; sid:32069; rev:3; )"
38557,https://snort.org/rule_docs/1-38557,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger outbound connection""; flow:to_server,established; http_uri; content:""/News/gate.php"",fast_pattern,nocase; http_header; content:""Connection|3A 20|Keep-Alive""; content:!""Accept""; content:!""Content-Type""; content:""User-Agent|3A 20|""; pcre:""/User-Agent\x3a\x20[A-F0-9]{32}\x0d\x0a/""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38557; rev:4; )"
59947,https://snort.org/rule_docs/1-59947,['T1190'],"alert http ( msg:""SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt""; flow:to_server,established; http_uri; content:""${""; content:""sun.misc.Unsafe"",distance 0,fast_pattern; content:""|28|"",distance 0; content:""}"",distance 0; pcre:""/\x24\x7b[^\x7d]*?sun\x2emisc\x2eUnsafe[^\x7d]*?\x28/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:59947; rev:1; )"
18245,https://snort.org/rule_docs/1-18245,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Oracle Java browser plugin docbase overflow attempt""; flow:to_client,established; file_data; content:""name=|22|docbase|22| value=|22 27| + "",nocase; content:""sBoF"",within 20,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:18245; rev:15; )"
7541,https://snort.org/rule_docs/1-7541,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger starlogger runtime detection""; flow:to_server,established; content:""From|3A|"",nocase; content:""|22|StarLogger|22|"",distance 0,nocase; content:""Subject|3A| StarLogger information"",distance 0,nocase; content:""Please find attached the StarLogger log file named"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:7541; rev:9; )"
46026,https://snort.org/rule_docs/1-46026,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP EventManager page.php sql injection attempt SQL injection attempt""; flow:to_server,established; http_uri; content:""/page.php"",fast_pattern,nocase; content:""slug="",nocase; pcre:""/[?&]slug=[^&]*?([\x27\x22\x3b\x23]|\x2f\x2a|\x2d\x2d)/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:46026; rev:2; )"
59264,https://snort.org/rule_docs/1-59264,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C0ders inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?mode=phpcode"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59264; rev:1; )"
47848,https://snort.org/rule_docs/1-47848,['T1559'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_client,established; file_data; content:""msiexec|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?msiexec\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:47848; rev:3; )"
56613,https://snort.org/rule_docs/1-56613,['T1041'],"alert tcp $HOME_NET any -> any $HTTP_PORTS ( msg:""MALWARE-CNC Rat.Tool.FeyeYelp variant outbound beacon attempt""; flow:to_server,established; content:""_gat_global=1"",fast_pattern,nocase; http_cookie; content:""_gat_global=1"",nocase; content:""recent_locations"",nocase; content:""_gat_www=1"",nocase; content:""bse="",nocase; pcre:""/bse=[^&\x3B]{128}/i""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56613; rev:1; )"
30784,https://snort.org/rule_docs/1-30784,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 03|""; byte_jump:2,0,relative; content:""|18 03 03|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30784; rev:4; )"
47461,https://snort.org/rule_docs/1-47461,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS CTSWebProxy ActiveX privilege escalation attempt""; flow:to_client,established; flowbits:isset,file.exe; file_data; content:""TSWbPrxy.exe"",fast_pattern,nocase; content:""PSHCMD"",nocase; content:""powershell.exe"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-admin; sid:47461; rev:2; )"
24704,https://snort.org/rule_docs/1-24704,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP CA Total Defense management.asmx sql injection attempt""; flow:to_server,established; http_method; content:""POST""; http_uri; content:""/UNCWS/Management.asmx"",fast_pattern,nocase; http_header; content:!""SOAP"",nocase; http_client_body; pcre:""/(^|&)SelectedID=[^&]+?(\x3B|%3B)/im""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:24704; rev:10; )"
42837,https://snort.org/rule_docs/1-42837,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For""; http_client_body; content:""=Ev al ""; content:""If+IsNumeric"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:42837; rev:5; )"
61084,https://snort.org/rule_docs/1-61084,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.IronShell inbound connection""; flow:to_server,established; http_uri; content:"".php?p="",fast_pattern,nocase; content:""&dir="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:61084; rev:1; )"
29791,https://snort.org/rule_docs/1-29791,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Careto plugin download""; flow:to_server,established; http_uri; content:""/m/f_l_addon.xpi"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; T1176; classtype:trojan-activity; sid:29791; rev:4; )"
30786,https://snort.org/rule_docs/1-30786,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|18 03 01|""; byte_jump:2,0,relative; content:""|18 03 01|"",within 3; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30786; rev:4; )"
39756,https://snort.org/rule_docs/1-39756,['T1059'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Trojan.Retefe variant malicious certificate installation page""; flow:to_server,established; file_data; content:""icanhazip.com"",fast_pattern,nocase; content:""powershell"",nocase; content:""-Exec"",within 35,nocase; content:""Sleep"",nocase; content:""taskkill"",within 35,nocase; content:""iexplore"",within 35,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:39756; rev:3; )"
32102,https://snort.org/rule_docs/1-32102,['T1218'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Oracle WebCenter Content CheckOutAndOpen.dll ActiveX control code execution ActiveX clsid access""; flow:to_client,established; file_data; content:""A200D7A4-CA91-4165-9885-AB618A39B3F0"",fast_pattern,nocase; content:"".openwebdav|28|"",nocase; content:"".hta"",nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:32102; rev:8; )"
36054,https://snort.org/rule_docs/1-36054,['T1205'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Ios.Backdoor.SYNful inbound connection""; flow:to_server,established; content:""text"",depth 4,offset 78; content:""|00 00 00|"",within 3,distance 1; content:""|45 25 6D|"",within 3,distance 1,fast_pattern; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36054; rev:6; )"
53341,https://snort.org/rule_docs/1-53341,['T1048'],"alert tcp any any -> $HOME_NET 8009 ( msg:""SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt""; flow:to_server,established; content:""|12 34|"",depth 2; content:""|02|"",within 1,distance 2; byte_test:1,!&,0xF9,0,relative; byte_extract:2,1,protocol_len,relative; content:""HTTP"",within protocol_len,nocase; content:""javax.servlet.include.request_uri|00|"",fast_pattern,nocase; content:""javax.servlet.include.servlet_path|00|"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:53341; rev:2; )"
26640,https://snort.org/rule_docs/1-26640,['T1220'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value""; flow:to_server,established; flowbits:isset,file.xml; file_data; content:""<CanonicalizationMethod"",fast_pattern; content:""<xsl"",distance 0; pcre:""/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/Rms""; metadata:policy max-detect-ips drop; service:smtp; classtype:misc-activity; sid:26640; rev:7; )"
40904,https://snort.org/rule_docs/1-40904,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 7001 ( msg:""SERVER-WEBAPP Oracle Weblogic default credentials login attempt""; flow:to_server,established; http_uri; content:""/j_security_check"",fast_pattern,nocase; http_client_body; content:""j_username=weblogic""; content:""j_password""; pcre:""/j_password=(welcome1|weblogic|admin)/""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:40904; rev:3; )"
51542,https://snort.org/rule_docs/1-51542,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.ModularInstaller variant outbound connection detected""; flow:to_server,established; http_uri; content:""/webkit_login_records"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:51542; rev:1; )"
44475,https://snort.org/rule_docs/1-44475,['T1195'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:""MALWARE-OTHER GHBkdr TLS Handshake spoof runtime detection""; flow:to_server,established; content:""|16 03 02 00 81 01 00 00 7D 03 02|""; content:""|00 00 18 C0 14 C0 13 00 39 00 33 00 35 00 2F C0 0A C0 09 00 38 00 32 00 0A 00 13 01 00 00 3C 00 00 00 16 00 14 00 00 11|www.microsoft.com|00 05 00 05 01 00 00 00 00 00 0A 00 06 00 04 00 17 00 18 00 0B 00 02 01 00 00 17 00 00 FF 01 00 01 00|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:44475; rev:3; )"
58732,https://snort.org/rule_docs/1-58732,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; content:""upper"",fast_pattern,nocase; http_cookie; content:""upper"",nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58732; rev:7; )"
7177,https://snort.org/rule_docs/1-7177,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger ab system spy runtime detection - info send through email""; flow:to_server,established; content:""From|3A|"",nocase; content:""<logs@dummyserver.com>"",distance 0; content:""Subject|3A|"",nocase; content:""Logs"",distance 0,nocase; content:""X-Mailer|3A|"",nocase; content:""Built-in Mail"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:7177; rev:10; )"
41084,https://snort.org/rule_docs/1-41084,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Sundown Exploit kit landing page obfuscation detected""; flow:to_client,established; file_data; content:""|22|script|22|"",nocase; content:""|22|createE|22|"",within 50,nocase; content:""|22|lement|22|"",within 20,nocase; content:""|22|type|22|"",within 50,nocase; content:""|22|text/j|22|"",within 50,nocase; content:""|22|avascript|22|"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:41084; rev:2; )"
1434,https://snort.org/rule_docs/1-1434,['T1552'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .bash_history access""; flow:to_server,established; http_uri; content:""/.bash_history""; metadata:ruleset community; service:http; T1139; classtype:web-application-attack; sid:1434; rev:15; )"
56616,https://snort.org/rule_docs/1-56616,['T1102'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Cobalt Strike beacon outbound connection attempt""; flow:to_server,established; content:""{|22|locale|22 3A 22|en|22|,|22|channel|22 3A 22|prod|22|,|22|addon|22 3A 22|"",fast_pattern,nocase; pcre:""/^POST\s(?:\/track|\/api\/v1\/survey\/embed|\/svc\/weather\/v2)/""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-user; sid:56616; rev:1; )"
30525,https://snort.org/rule_docs/1-30525,['T1123'],"alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt""; flow:to_server,established; isdataat:68; isdataat:!69; content:""|18 03 03 00 40|"",depth 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30525; rev:4; )"
60591,https://snort.org/rule_docs/1-60591,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Perl.Webshell.GoShell outbound connection attempt""; flow:to_client,established; file_data; content:""<input type=text class=|22|TEXT|22| name=cmd value="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60591; rev:1; )"
40450,https://snort.org/rule_docs/1-40450,['T1102'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Doc.Downloader.Agent file download attempt""; flow:to_server,established; http_uri; content:""/fr/mso/onedrive"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:40450; rev:3; )"
29609,https://snort.org/rule_docs/1-29609,['T1190'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP McAfee ePO DisplayMSAPropsDetail.do sql injection attempt""; flow:to_server,established; http_uri; content:""/EPOAGENTMETA/DisplayMSAPropsDetail.do"",depth 38,fast_pattern; pkt_data; content:""uid|3D|""; pcre:""/uid\x3D\d{0,10}?[A-Za-z\x3B\x25]/""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:29609; rev:3; )"
60283,https://snort.org/rule_docs/1-60283,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.CrewShell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?"",nocase; content:""&defined_vars"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60283; rev:1; )"
29261,https://snort.org/rule_docs/1-29261,['T1102'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Dropper variant outbound connection""; flow:to_server,established; http_uri; bufferlen:19; content:""/FileToDownload.exe"",fast_pattern,nocase; http_header; content:""Host: dl.dropbox.com|0D 0A|""; content:!""Accept""; content:!""User-Agent""; metadata:impact_flag red,ruleset community; service:http; T1102; classtype:trojan-activity; sid:29261; rev:3; )"
286,https://snort.org/rule_docs/1-286,['T1071'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 110 ( msg:""PROTOCOL-POP EXPLOIT x86 BSD overflow""; flow:to_server,established; content:""^|0E|1|C0 B0 3B 8D|~|0E 89 FA 89 F9|"",fast_pattern,nocase; metadata:ruleset community; service:pop3; classtype:attempted-admin; sid:286; rev:18; )"
47640,https://snort.org/rule_docs/1-47640,['T1102'],"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""SERVER-WEBAPP SSL certificate with null issuer rdnSequence fields detected""; flow:to_client,established; ssl_state:server_hello; content:""|30 07 06 03 55 04 06 13 00 31 09 30 07 06 03 55 04 08 13 00 31 09 30 07 06 03 55 04 07 13 00 31 09 30 07 06 03 55 04 0A 13 00 31 09 30 07 06 03 55 04 0B 13 00 31 09 30 07 06 03 55 04 03 13 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; classtype:misc-activity; sid:47640; rev:2; )"
58724,https://snort.org/rule_docs/1-58724,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""${lower:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58724; rev:6; )"
50950,https://snort.org/rule_docs/1-50950,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PHP backdoor communication attempt""; flow:to_server,established; http_header; content:""eval(base64_decode("",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50950; rev:1; )"
37312,https://snort.org/rule_docs/1-37312,['T1020'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-OTHER Mulitple products external entity data exfiltration attempt""; flow:to_client,established; file_data; content:""<!ENTITY"",nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; content:""<!ENTITY"",distance 0,nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:37312; rev:5; )"
56864,https://snort.org/rule_docs/1-56864,['T1094'],"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-CNC MultiOS.Malware.GORAT command and control SSL certificate""; flow:to_client,established; ssl_state:server_hello; content:""|16 03 03|"",depth 3; content:""ACME Shell Co.0""; content:""Z"",distance 0; content:""ACME Shell Co.0"",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:trojan-activity; sid:56864; rev:1; )"
26639,https://snort.org/rule_docs/1-26639,['T1220'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value""; flow:to_client,established; flowbits:isset,file.xml; file_data; content:""<CanonicalizationMethod"",fast_pattern; content:""<xsl"",distance 0; pcre:""/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/Rms""; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:26639; rev:7; )"
49457,https://snort.org/rule_docs/1-49457,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER PHP webshell upload attempt""; flow:to_server,established; file_data; content:""GIF8"",depth 4; content:""a"",within 1,distance 1; content:""<?php""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:49457; rev:2; )"
33857,https://snort.org/rule_docs/1-33857,['T1020'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-CNC Win.Trojan.PwnPOS data exfiltration attempt""; flow:to_server,established; content:""From|3A| "",nocase; content:""Drone"",within 10,nocase; content:""Subject|3A| "",nocase; content:""Drone|0D 0A|"",within 100,nocase; content:""filename="",nocase; content:""syshealth.7z"",within 20,nocase; metadata:impact_flag red; service:smtp; classtype:trojan-activity; sid:33857; rev:3; )"
13280,https://snort.org/rule_docs/1-13280,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger email spy monitor 6.9 runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Chilkat"",distance 0,nocase; content:""Software"",distance 0,nocase; content:""Inc"",distance 0,nocase; pcre:""/^X\x2DMailer\x3A[^\r\n]*Chilkat\s+Software\s+Inc/ims""; flowbits:set,EmailSpyMonitor_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13280; rev:7; )"
59019,https://snort.org/rule_docs/1-59019,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.AyyildizTim inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; http_client_body; content:""work_dir="",fast_pattern,nocase; content:""command="",nocase; content:""textarea="",nocase; content:""submit_btn="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59019; rev:2; )"
29394,https://snort.org/rule_docs/1-29394,['T1176'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-WEBKIT Apple WebKit QuickTime plugin content-type http header buffer overflow attempt""; flow:to_client,established; flowbits:isset,file.quicktime|file.smil; http_header; content:""Content-Type: ""; content:!""|3B|"",within 255; content:!""|0A|"",within 255; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:29394; rev:8; )"
29615,https://snort.org/rule_docs/1-29615,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Keylogger outbound connection""; flow:to_server,established; http_uri; content:""/sizemore/css5.php?a"",depth 20; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:29615; rev:9; )"
300255,https://snort.org/rule_docs/1-300255,['T1505'],"alert file ( msg:""MALWARE-OTHER Php.Webshell.CmdShell transfer attempt""; flow:to_server,established; file_data; content:""<?""; content:""system($_GET['cmd'])"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; gid:1; sid:300255; rev:1; )"
37300,https://snort.org/rule_docs/1-37300,['T1021'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN startup attempt""; flow:to_server,established; http_uri; content:""/access/popular"",fast_pattern,nocase; http_header; content:""Host""; content:""hola.org"",within 50; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37300; rev:4; )"
38355,https://snort.org/rule_docs/1-38355,['T1094'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.NetWiredRC variant keepalive""; flow:to_server,established; content:""|01 00 00 00 01|"",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:38355; rev:3; )"
37909,https://snort.org/rule_docs/1-37909,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION known javascript packer detected""; flow:to_client,established; file_data; content:""eval|28|function|28|p,a,c,k,e,"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:misc-activity; sid:37909; rev:2; )"
56597,https://snort.org/rule_docs/1-56597,['T1094'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC MultiOS.Malware.GORAT outbound communications attempt""; flow:to_server,established; http_method; content:""POST""; http_header; content:""Connection: upgrade""; content:""|0D 0A|Upgrade: tcp/1|0D 0A|"",fast_pattern,nocase; content:!""|0D 0A|Referer:""; content:!""|0D 0A|Accept""; content:!""|0D 0A|Cookie:""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56597; rev:1; )"
12625,https://snort.org/rule_docs/1-12625,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger windows family safety 2.0 runtime detection""; flow:to_server,established; content:""Subject|3A|"",nocase; content:""Windows Supervisor Report"",distance 0,nocase; content:""<title>Windows Family Safety</title>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12625; rev:9; )"
5881,https://snort.org/rule_docs/1-5881,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger spyagent runtime detect - ftp delivery""; flow:to_server,established; content:""STOR spyagent-log"",fast_pattern,nocase; service:ftp; classtype:successful-recon-limited; sid:5881; rev:11; )"
30779,https://snort.org/rule_docs/1-30779,['T1123'],"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|16 03 01|""; byte_jump:2,0,relative; content:""|18 03 01|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30779; rev:4; )"
9650,https://snort.org/rule_docs/1-9650,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger ghost Keylogger runtime detection""; flow:to_server,established; flowbits:isset,ghost_keylogger_start; content:""[Static"",nocase; content:""Text]"",distance 0,nocase; pcre:""/^\s*\x5BStatic\s+Text\x5D/ims""; service:smtp; classtype:successful-recon-limited; sid:9650; rev:9; )"
58730,https://snort.org/rule_docs/1-58730,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; content:""lower"",fast_pattern,nocase; http_cookie; content:""lower"",nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58730; rev:7; )"
19884,https://snort.org/rule_docs/1-19884,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION String.fromCharCode with multiple encoding types detected""; flow:to_client,established; file_data; content:""String.fromCharCode"",fast_pattern,nocase; pcre:""/String\x2efromCharCode\s*\x28[^\x29]*0x[0-9a-f]{2}\s*,[^\x29]*,\s*0[0-7]{1,3}\s*,[^\x29]*,\s*[1-9][0-9]{0,2}\s*,/ims""; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:19884; rev:10; )"
8445,https://snort.org/rule_docs/1-8445,['T1204'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-OFFICE Microsoft Windows RTF file with embedded object package download attempt""; flow:to_client,established; file_data; content:""{|5C|rt"",nocase; content:""{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"",distance 0,nocase; flowbits:set,file.rtf.embed; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:8445; rev:17; )"
36585,https://snort.org/rule_docs/1-36585,['T1059'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt""; flow:to_client,established; file_data; content:""applescript://com.apple.scripteditor"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:36585; rev:3; )"
57067,https://snort.org/rule_docs/1-57067,['T1106'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER HP Web JetAdmin file write attempt""; flow:to_server,established; http_uri; content:""/plugins/framework/script/tree.xms"",fast_pattern,nocase; content:""WriteToFile"",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:57067; rev:1; )"
32103,https://snort.org/rule_docs/1-32103,['T1218'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Oracle WebCenter Content CheckOutAndOpen.dll ActiveX control code execution ActiveX clsid access""; flow:to_client,established; file_data; content:""A200D7A4-CA91-4165-9885-AB618A39B3F0"",fast_pattern,nocase; content:"".coao|28|"",nocase; content:"".hta"",nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:32103; rev:8; )"
45980,https://snort.org/rule_docs/1-45980,['T1056'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-CNC MultiOS.Trojan.OSCelestial variant inbound connection""; flow:to_client,established; content:""|74 00 29|net.oscp.client.keylogger.KeystrokeLogger"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; T1056; classtype:trojan-activity; sid:45980; rev:2; )"
59260,https://snort.org/rule_docs/1-59260,['T1505'],"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.Generic outbound connection attempt""; flow:to_client,established; file_data; content:""<meta name="",nocase; content:""Stupidc0de Family"",within 150,fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59260; rev:1; )"
58734,https://snort.org/rule_docs/1-58734,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""jndi"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58734; rev:4; )"
18242,https://snort.org/rule_docs/1-18242,['T1047'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI Administrator Tools Object Viewer ActiveX function call access""; flow:to_client,established; file_data; content:""AddContextRef"",fast_pattern,nocase; pcre:""/(?P<c>\w+)\s*=\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\)/Oims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18242; rev:15; )"
520,https://snort.org/rule_docs/1-520,['T1213'],"alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:""PROTOCOL-TFTP root directory""; flow:to_server; content:""|00 01|/"",depth 3; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:520; rev:13; )"
58726,https://snort.org/rule_docs/1-58726,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; content:""jndi"",fast_pattern,nocase; http_cookie; content:""jndi"",nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)jndi(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58726; rev:7; )"
25579,https://snort.org/rule_docs/1-25579,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake bookinginfo HTTP Response phishing attack""; flow:to_client,established; http_header; content:""|3B 20|filename=BookingInfo.zip|0D 0A|"",fast_pattern,nocase; file_data; content:""BookingInfo.exe""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:25579; rev:4; )"
28349,https://snort.org/rule_docs/1-28349,['T1047'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""%32%37%34%35%45%35%46%35%2d%44%32%33%34%2d%31%31%44%30%2d%38%34%37%41%2d%30%30%43%30%34%46%44%37%42%42%30%38"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:28349; rev:7; )"
44623,https://snort.org/rule_docs/1-44623,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 8045 ( msg:""POLICY-OTHER EMC Autostart default domain login attempt""; flow:to_server,established; content:""|31 00 00 00|""; content:""|00 00 00 63 00 00 00 01|"",within 8,distance 8; content:""|31 00 00 00|"",within 4,distance 4; content:""eas550"",within 6,distance 64; classtype:default-login-attempt; sid:44623; rev:4; )"
33939,https://snort.org/rule_docs/1-33939,['T1218'],"alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:""MALWARE-OTHER Executable control panel file attachment detected""; flow:to_client,established; content:"".cpl"",fast_pattern,nocase; content:""Content-Disposition: attachment|3B|""; content:""filename="",nocase; pcre:""/filename=[\x22\x27]?[^\n]*\x2ecpl[\x22\x27\s]/is""; metadata:policy max-detect-ips drop,policy security-ips drop; service:imap,pop3; classtype:misc-activity; sid:33939; rev:3; )"
37381,https://snort.org/rule_docs/1-37381,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Digi default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""cm9vdDpkYnBz"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37381; rev:3; )"
29031,https://snort.org/rule_docs/1-29031,['T1102'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Banload variant inbound connection""; flow:to_client,established; http_header; content:""/avcheck.exe|0D 0A 0D 0A|"",fast_pattern,nocase; content:""|0D 0A|Location: https://dl.dropboxusercontent.com/""; pcre:""/\r\nLocation\x3a\x20https\x3a\x2f{2}dl\.dropboxusercontent\.com\/[a-zA-Z\d\x2f]{5,32}\/avcheck\.exe\r\n\r\n$/""; metadata:impact_flag red,ruleset community; service:http; T1102; classtype:trojan-activity; sid:29031; rev:5; )"
60497,https://snort.org/rule_docs/1-60497,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Exoshell inbound connection attempt""; flow:to_server,established; http_uri; content:"".php?dlink=home"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60497; rev:1; )"
28323,https://snort.org/rule_docs/1-28323,"['T1505', 'T1219']","alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""FromBase64String""; content:""z"",within 200,nocase; pcre:""/z\d{1,3}/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:28323; rev:8; )"
10436,https://snort.org/rule_docs/1-10436,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger keyspy runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""mail"",distance 0,nocase; content:""function"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*mail\s+function/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:10436; rev:8; )"
1693,https://snort.org/rule_docs/1-1693,['T1190'],"alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS ( msg:""SERVER-ORACLE create table attempt""; flow:to_server,established; content:""create table"",nocase; metadata:ruleset community; classtype:protocol-command-decode; sid:1693; rev:8; )"
58788,https://snort.org/rule_docs/1-58788,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""$%7b"",fast_pattern,nocase; pcre:""/\x24%7b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58788; rev:4; )"
16129,https://snort.org/rule_docs/1-16129,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Keylogger kamyab Keylogger v.3 runtime detection""; flow:to_server,established; http_uri; content:""/ahmad.php"",nocase; http_header; content:""Host|3A|"",nocase; content:""www.kamyab-hack.com"",distance 0,fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:successful-recon-limited; sid:16129; rev:9; )"
5790,https://snort.org/rule_docs/1-5790,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger pc actmon pro runtime detection - smtp""; flow:to_server,established; content:""X-Sender|3A| ActMon"",fast_pattern,nocase; service:smtp; classtype:successful-recon-limited; sid:5790; rev:11; )"
19319,https://snort.org/rule_docs/1-19319,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""MALWARE-OTHER Dos.Tool.LOIC TCP default U dun goofed attack""; flow:to_server,established,no_stream; content:""U dun goofed"",fast_pattern,nocase; detection_filter:track by_src,count 10,seconds 2; metadata:policy max-detect-ips drop; classtype:attempted-dos; sid:19319; rev:6; )"
384,https://snort.org/rule_docs/1-384,['T1082'],"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP PING""; icode:0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:384; rev:8; )"
41092,https://snort.org/rule_docs/1-41092,['T1027'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Rig Exploit Kit landing page obfuscation detected""; flow:to_client,established; file_data; content:""<script "",nocase; content:""VBScript"",within 50,fast_pattern,nocase; content:""Execute"",within 200,nocase; content:""chr"",within 20,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:41092; rev:2; )"
29616,https://snort.org/rule_docs/1-29616,['T1056'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Keylogger inbound connection""; flow:to_client,established; file_data; content:""787**KB"",depth 7; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:29616; rev:10; )"
32008,https://snort.org/rule_docs/1-32008,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake Delta Ticket HTTP Response phishing attack""; flow:to_client,established; file_data; content:""PK"",depth 2; content:""DeltaTicket_ET-RM-"",distance 0,nocase; content:"".exe"",distance 0,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:32008; rev:3; )"
56600,https://snort.org/rule_docs/1-56600,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original outbound connection attempt""; flow:to_server,established; http_header; content:""Accept: */*|0D 0A|""; content:""Accept-Language: en-US|0D 0A|""; content:""Accept-Encoding: gzip, deflate|0D 0A|""; http_uri; pcre:""/(\/check|\/v1\/stats|\/gql|\/1.5\/95648064|\/u\/0\/_\/og\/botguard\/get|\/ev\/\w{3}001001)/i""; file_data; content:""{|22|locale|22|:|22|en|22|,|22|channel|22|:|22|prod|22|,|22|addon|22|:|22|""; content:""ses-""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56600; rev:1; )"
50094,https://snort.org/rule_docs/1-50094,['T1187'],"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; file_data; content:""<img src=|27|file://RespProxySrv/pictures/logo.jpg|27|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:misc-attack; sid:50094; rev:1; )"
37382,https://snort.org/rule_docs/1-37382,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Digi default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""dXNlcjpwYXNzd2Q="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37382; rev:3; )"
56584,https://snort.org/rule_docs/1-56584,['T1190'],"alert udp any any -> any 88 ( msg:""MALWARE-TOOLS GhostPack Rubeus kerberos request attempt""; flow:to_server; content:""|05|"",depth 30; content:""|0A|"",within 1,distance 4; content:""Z""; content:""|A7 06 02 04 6C 69 6C 00|"",within 25; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:kerberos; classtype:trojan-activity; gid:1; sid:56584; rev:2; )"
39410,https://snort.org/rule_docs/1-39410,['T1020'],"alert tcp $HOME_NET any -> $SMTP_SERVERS [25,587] ( msg:""MALWARE-CNC Win.Trojan.iSpy variant exfiltration outbound connection""; flow:to_server,established; content:""=0D=0A"",fast_pattern,nocase; content:""iSpy Keylogger""; content:""=0D=0ABrowser""; content:""=0D=0AWebsite"",within 70; content:""=0D=0AUsername"",within 70; content:""=0D=0APassword"",within 70; metadata:impact_flag red,ruleset community; service:smtp; T1020; T1056; classtype:trojan-activity; sid:39410; rev:3; )"
7154,https://snort.org/rule_docs/1-7154,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger active keylogger home runtime detection""; flow:to_server,established; content:""Active"",nocase; content:""Keylogger"",distance 0,nocase; content:""Home"",distance 0,nocase; content:""Report"",distance 0,nocase; service:smtp; classtype:successful-recon-limited; sid:7154; rev:9; )"
6208,https://snort.org/rule_docs/1-6208,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-OTHER Keylogger winsession runtime detection - ftp""; flow:to_server,established; content:""_WinSession Logger.clk"",fast_pattern,nocase; service:ftp; classtype:successful-recon-limited; sid:6208; rev:11; )"
39320,https://snort.org/rule_docs/1-39320,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION HTTP header invalid entry evasion attempt""; flow:to_client,established; content:""HTTP/1.1 200"",depth 12,nocase; content:!"" "",within 1,nocase; content:!""|0D 0A|Server: RUI""; metadata:policy max-detect-ips drop; service:http; classtype:non-standard-protocol; sid:39320; rev:5; )"
34957,https://snort.org/rule_docs/1-34957,['T1176'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Sysmain outbound connection""; flow:to_server,established; http_uri; content:""/wp-content/plugins/akismet/iddx.php?id="",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:34957; rev:4; )"
58738,https://snort.org/rule_docs/1-58738,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""upper"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)upper(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58738; rev:5; )"
13768,https://snort.org/rule_docs/1-13768,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger cyber sitter runtime detection""; flow:to_server,established; flowbits:isset,cyberSitter_detection; content:""CYBERsitter"",nocase; content:""appears"",distance 0,nocase; content:""to"",distance 0,nocase; content:""be"",distance 0,nocase; content:""functioning"",distance 0,nocase; pcre:""/CYBERsitter\s+appears\s+to\s+be\s+functioning/ims""; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13768; rev:6; )"
24517,https://snort.org/rule_docs/1-24517,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP F5 Networks FirePass my.activation.php3 state parameter sql injection attempt""; flow:to_server,established; http_uri; content:""/my.activation.php3"",fast_pattern,nocase; content:""state="",nocase; pcre:""/[?&]state=[^&]*?[\x22\x27]/i""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:24517; rev:5; )"
50105,https://snort.org/rule_docs/1-50105,['T1187'],"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_client,established; content:""|EE 85 AB F7 EA F6 0C 4F 92 81 92 47 6D EB 76 A9|"",fast_pattern,nocase; content:""|27 FB EA D7 50 09 D2 01|""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50105; rev:1; )"
13494,https://snort.org/rule_docs/1-13494,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger smart pc Keylogger runtime detection""; flow:to_server,established; content:""Subject|3A| Smart PC Keylogger - Log File Mailing"",fast_pattern,nocase; content:""X-Mailer|3A| Smart PC Keylogger"",nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:13494; rev:8; )"
20158,https://snort.org/rule_docs/1-20158,['T1078'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Oracle GlassFish Server default credentials login attempt""; flow:to_server,established; http_uri; content:""j_security_check"",fast_pattern,nocase; http_client_body; content:""j_username=admin""; pcre:""/j_password=(&|$|adminadmin)/""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:20158; rev:15; )"
2044,https://snort.org/rule_docs/1-2044,['T1595'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 ( msg:""POLICY-OTHER PPTP Start Control Request attempt""; flow:to_server,established,no_stream; content:""|00 01|"",depth 2,offset 2; content:""|00 01|"",depth 2,offset 8; metadata:ruleset community; classtype:attempted-admin; sid:2044; rev:8; )"
1129,https://snort.org/rule_docs/1-1129,['T1218'],"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .htaccess access""; flow:to_server,established; http_uri; content:"".htaccess"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1170; classtype:attempted-recon; sid:1129; rev:16; )"
38561,https://snort.org/rule_docs/1-38561,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger plugins download attempt""; flow:to_server,established; content:"".p HTTP/1.1"",fast_pattern,nocase; http_uri; content:""/plugins/""; pcre:""/\/plugins\/[a-z]{3,10}\.p/i""; metadata:impact_flag red,ruleset community; service:http; T1056; T1176; classtype:trojan-activity; sid:38561; rev:3; )"
47400,https://snort.org/rule_docs/1-47400,['T1059'],"alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE Microsoft powershell.exe outbound shell attempt""; content:""Windows PowerShell"",depth 18; metadata:policy max-detect-ips drop; classtype:attempted-user; sid:47400; rev:3; )"
27960,https://snort.org/rule_docs/1-27960,['T1014'],"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit upload attempt""; flow:to_server,established; file_data; content:""|22|opener: Finished move to System Library StartupItems |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:27960; rev:3; )"
7552,https://snort.org/rule_docs/1-7552,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger ardamax keylogger runtime detection - ftp""; flow:to_server,established; content:""{D082139B-D5E4-4e63-B866-9BFC97880A48}"",fast_pattern,nocase; classtype:successful-recon-limited; sid:7552; rev:9; )"
30567,https://snort.org/rule_docs/1-30567,['T1566'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Trojan.Agent E-FAX phishing attempt""; flow:to_client,established; flowbits:isset,file.zip; file_data; content:""pdf_efax_"",fast_pattern,nocase; content:""PK"",depth 2; content:"".pif"",distance 0,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:30567; rev:3; )"
49529,https://snort.org/rule_docs/1-49529,['T1187'],"alert tcp any $FILE_DATA_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner download attempt""; flow:to_client,established; flowbits:isset,file.exe; file_data; content:""poisoners.NBTNS"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:49529; rev:1; )"
58735,https://snort.org/rule_docs/1-58735,['T1190'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""lower"",fast_pattern,nocase; pcre:""/(%(25)?24|\x24)(%(25)?7b|\x7b)lower(%(25)?3a|\x3a)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58735; rev:4; )"
4236,https://snort.org/rule_docs/1-4236,['T1047'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Internet Explorer WMI ASDI Extension ActiveX object access""; flow:to_client,established; file_data; content:""F0975AFE-5C7F-11D2-8B74-00104B2AFB41"",fast_pattern,nocase; pcre:""/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F0975AFE-5C7F-11D2-8B74-00104B2AFB41/is""; service:http; classtype:attempted-user; sid:4236; rev:16; )"
20618,https://snort.org/rule_docs/1-20618,['T1003'],"alert tcp $EXTERNAL_NET any -> $HOME_NET 1707 ( msg:""SERVER-OTHER Sage SalesLogix database credential disclosure attempt""; flow:to_server,established; content:""|00 00 00 00 00 00 00 00 00 00|"",depth 10; content:""|00 00 00|"",within 3,distance 1; content:""GetConnection|00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:attempted-admin; sid:20618; rev:6; )"
48402,https://snort.org/rule_docs/1-48402,['T1041'],"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.Emotet variant outbound connection attempt""; flow:to_server,established; content:""GET / HTTP/1.1|0D 0A|Cookie: "",depth 24; content:""="",within 6; pcre:""/Cookie: \d{1,5}=[a-zA-Z0-9\x2b\x2f]+=*\r\nUser-Agent:/""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:48402; rev:1; )"
15863,https://snort.org/rule_docs/1-15863,['T1021'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows Remote Desktop Client ActiveX function call access""; flow:to_client,established; file_data; content:""MsRDP.MsRDP"",nocase; pcre:""/(?P<c>\w+)\s*=\s*(\x22MsRDP\.MsRDP(\.\d)?\x22|\x27MsRDP\.MsRDP(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)(\s*\.\s*MsRdpClientShell\.RdpFileContents\s*|.*(?P=v)\s*\.\s*MsRdpClientShell\.RdpFileContents\s*)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22MsRDP\.MsRDP(\.\d)?\x22|\x27MsRDP\.MsRDP(\.\d)?\x27)\s*\)(\s*\.\s*MsRdpClientShell\.RdpFileContents\s*|.*(?P=n)\s*\.\s*MsRdpClientShell\.RdpFileContents)\s*=/Oims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:15863; rev:16; )"
21318,https://snort.org/rule_docs/1-21318,['T1001'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FakeAV TDSS/PurpleHaze variant outbound connection - base64 encoded""; flow:to_server,established; http_header; content:""Accept-Language|3A 20|en-US|0D 0A|User-Agent|3A 20|Mozilla/4.0|20|(compatible"",fast_pattern,nocase; content:!""Referer""; pkt_data; content:""GET /"",depth 5; base64_decode:relative; base64_data; content:""cl|7C|1.6|7C|""; content:""|7C|161"",distance 0; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:21318; rev:8; )"
22033,https://snort.org/rule_docs/1-22033,['T1001'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Apple OSX Flashback malware variant outbound connection""; flow:to_server,established; http_uri; content:""/auupdate/"",fast_pattern; http_header; content:""User-Agent|3A|""; base64_decode:relative; base64_data; content:""|7C|i386|7C|10.""; service:http; classtype:trojan-activity; sid:22033; rev:6; )"
57975,https://snort.org/rule_docs/1-57975,['T1105'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Raccoon variant outbound request detected""; flow:to_server,established; http_uri; content:""/l/f/"",depth 5,fast_pattern; content:!""?""; http_header; content:!""User-Agent"",nocase; content:!""Accept"",nocase; content:!""Referer"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:57975; rev:1; )"
59352,https://snort.org/rule_docs/1-59352,['T1505'],"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.SmallShell download attempt""; flow:to_client,established; file_data; content:""<?""; content:""$cmd"",nocase; content:""($_REQUEST["",within 16,nocase; content:""cmd"",within 4,nocase; content:""])|3B|"",within 4; content:""shell_exec($cmd)|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59352; rev:1; )"
38385,https://snort.org/rule_docs/1-38385,['T1056'],"alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:""MALWARE-CNC Win.Trojan.FTPKeyLogger outbound connection""; flow:to_server,established; content:""USER obitex@benfoods.tk|0D 0A|"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:ftp; T1056; classtype:trojan-activity; sid:38385; rev:3; )"
4916,https://snort.org/rule_docs/1-4916,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer javascript onload document.write obfuscation overflow attempt""; flow:to_client,established; file_data; content:""document.write"",nocase; pcre:""/document\.write\(([^\x22\x27\x29\x3B]*([\x22\x27]))((?(?=\2)\2(?1)))\x3C(?3)b(?3)o(?3)d(?3)y(?3)\s*(?3)o(?3)n(?3)l(?3)o(?3)a(?3)d(?3)\s*(?3)=(?3)\s*(?3)w(?3)i(?3)n(?3)d(?3)o(?3)w(?3)\x28(?3)\x29/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:4916; rev:15; )"
60585,https://snort.org/rule_docs/1-60585,['T1505'],"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Perl.Webshell.GammaShell inbound connection attempt""; flow:to_server,established; http_client_body; content:""action=browse&command="",depth 22,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60585; rev:1; )"
38595,https://snort.org/rule_docs/1-38595,['T1027'],"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION Invalid HTTP version evasion attempt""; flow:to_client,established; content:""HTTP/"",depth 5,fast_pattern,nocase; content:!""0.9 "",within 4; content:!""1.0 "",within 4; content:!""1.1 "",within 4; content:!""2.0 "",within 4; metadata:policy max-detect-ips drop; service:http; classtype:non-standard-protocol; sid:38595; rev:3; )"
1950,https://snort.org/rule_docs/1-1950,['T1040'],"alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:""PROTOCOL-RPC portmap SET attempt UDP 111""; flow:to_server; content:""|00 01 86 A0|"",depth 4,offset 12; content:""|00 00 00 01|"",within 4,distance 4; content:""|00 00 00 00|"",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1950; rev:13; )"
49788,https://snort.org/rule_docs/1-49788,['T1043'],"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zacinlo outbound connection""; flow:to_server,established; http_uri; content:""/entry/feedbackinfo/production/"",fast_pattern,nocase; http_header; content:""User-Agent: wget""; content:""Referer:""; content:""/entry/feedbackinfo/production/"",within 100; content:!""Accept-""; content:!""Content-""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:49788; rev:2; )"
