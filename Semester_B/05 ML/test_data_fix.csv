Rule,technique ids
"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; file_data; content:""<img src=|27|file://RespProxySrv/pictures/logo.jpg|27|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:misc-attack; sid:50094; rev:1; )",['T1187']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger fake 404 response""; flow:to_client,established; http_stat_code; content:""200""; http_stat_msg; content:""OK""; pkt_data; content:"">404 Not Found<"",fast_pattern,nocase; content:"" requested URL / was not found ""; metadata:impact_flag red,ruleset community; service:http; T1056; classtype:trojan-activity; sid:38563; rev:4; )",['T1056']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .bat? access""; flow:to_server,established; http_uri; content:"".bat?"",fast_pattern,nocase; content:""/cgi-bin/"",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:976; rev:22; )",['T1204']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .htaccess access""; flow:to_server,established; http_uri; content:"".htaccess"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1170; classtype:attempted-recon; sid:1129; rev:16; )",['T1218']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""caidao="",fast_pattern,nocase; pcre:""/caidao\s?=\s?(Response|Write|Execute)/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:27967; rev:6; )","['T1505', 'T1219']"
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Napolar phishing attack""; flow:to_client,established; content:""facebook.com.exe"",fast_pattern,nocase; metadata:ruleset community; service:http; T1192; classtype:trojan-activity; sid:29869; rev:4; )",['T1566']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [587,2525] ( msg:""MALWARE-CNC Win.Trojan.Nighthunter data exfiltration attempt""; flow:to_server,established; content:""Subject|3A| Limitless Logger |3A 20 3A| Execution Confirmation"",fast_pattern,nocase; metadata:impact_flag red; service:smtp; classtype:trojan-activity; sid:31807; rev:3; )",['T1020']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; content:""|24 7B|"",fast_pattern,nocase; pcre:""/^[\w\x2d\x20]+\x3a[^\r\n]*?\x24\x7b(jndi|lower|upper)\x3a/im""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; classtype:attempted-user; sid:58751; rev:4; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP ManageEngine OpManager default credentials authentication attempt""; flow:to_server,established; http_uri; content:""/jsp/Login.do"",nocase; http_client_body; content:""userName=IntegrationUser"",fast_pattern,nocase; content:""password=plugin"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:36100; rev:4; )",['T1078']
"alert tcp $HOME_NET 456 -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger win32.remotekeylog.b runtime detection - keylog""; flow:to_client,established; content:""KEY"",depth 3,nocase; metadata:policy max-detect-ips drop; classtype:successful-recon-limited; sid:10096; rev:10; )",['T1056']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_client_body; content:""=@eval(base64_decode($_POST"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1001; T1100; T1132; classtype:trojan-activity; sid:37245; rev:4; )","['T1001', 'T1219']"
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Rat.Tool.CSBundleUSATodayServer variant inbound command attempt""; flow:to_client,established; http_header; content:""X-Timer: S1593010188.776402,VS0,VE1"",fast_pattern,nocase; content:""Content-Type: application/json|5C 3B| charset=utf-8""; content:""Strict-Transport-Security: max-age=10890000""; content:""Cache-Control: public, immutable, max-age=315360000""; content:""X-Cache: HIT, HIT""; content:""Vary: X-AbVariant, X-AltUrl, Accept-Encoding""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56606; rev:1; )",['T1071']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Cobalt Strike beacon connection attempt""; flow:to_server,established; http_header; content:""client-="",fast_pattern,nocase; content:""Accept-Encoding|3A| gzip, deflate, br""; content:""|5C 3B|auth=1|7D|""; http_uri; pcre:""/^\/v1\/(queue|profile|docs\/wsdl|pull)/i""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56614; rev:1; )",['T1083']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger mg-shadow 2.0 runtime detection""; flow:to_server,established; content:""X-Mailer|3A|"",nocase; content:""Mailer"",distance 0,nocase; pcre:""/^X-Mailer\x3a[^\r\n]*Mailer/ims""; content:""+++ MG-Shadow 2.0"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:successful-recon-limited; sid:12372; rev:8; )",['T1056']
"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Php.Webshell.CWShell outbound connection attempt""; flow:to_client,established; file_data; content:""<b>uname -a:"",fast_pattern,nocase; content:""<b>Server Name:"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59348; rev:1; )",['T1505']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 9090 ( msg:""SERVER-WEBAPP WebNMS framework server credential disclosure attempt""; flow:to_server,established; http_uri; content:""/servlets/FetchFile"",fast_pattern,nocase; content:""fileName="",nocase; content:""conf/securitydbData.xml"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:39642; rev:3; )",['T1003']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Keylogger.AgentTesla variant outbound connection""; flow:to_server,established; http_uri; content:""/post.php"",fast_pattern,nocase; http_client_body; content:""type="",nocase; content:""hwid="",nocase; content:""pcname="",nocase; content:""username="",nocase; content:""password="",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:40238; rev:3; )",['T1056']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 100 ( msg:""MALWARE-OTHER Win.Keylogger.Vacky system information disclosure""; flow:to_server,established; content:""|00 00 00 00 00 00 00|"",depth 7,offset 1; content:""|AA AA AA AA|"",within 4,distance 4,fast_pattern; isdataat:15; isdataat:!16; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:29918; rev:4; )",['T1056']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 25 ( msg:""MALWARE-OTHER Keylogger active Keylogger 3.9.2 runtime detection""; flow:to_server,established; content:""Attached"",nocase; content:""|28|ZIP"",distance 0,nocase; content:""file|29|"",distance 0,nocase; content:""to"",distance 0,nocase; content:""this"",distance 0,nocase; content:""email"",distance 0,nocase; content:""are"",distance 0,nocase; content:""the"",distance 0,nocase; content:""activity"",distance 0,nocase; content:""logs"",distance 0,nocase; content:""that"",distance 0,nocase; content:""you"",distance 0,nocase; content:""have"",distance 0,nocase; content:""requested."",distance 0,nocase; pcre:""/Attached\s+\x28ZIP\s+file\x29\s+to\s+this\s+email\s+are\s+the\s+activity\s+logs\s+that\s+you\s+have\s+requested\x2E/ims""; flowbits:set,ActiveKeylogger392_detection; flowbits:noalert; metadata:policy max-detect-ips alert; service:smtp; classtype:successful-recon-limited; sid:13236; rev:7; )",['T1056']
"alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE Microsoft cmd.exe outbound shell attempt""; content:""Microsoft Windows XP [Version"",depth 29; metadata:policy max-detect-ips drop; classtype:attempted-user; sid:47399; rev:2; )",['T1059']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-OTHER Keylogger desktop detective 2000 runtime detection - init connection""; flow:to_client,established; flowbits:isset,DesktopDetective_InitConnection2; content:""|FE FE FE FE|90|00 00|"",fast_pattern,nocase; classtype:successful-recon-limited; sid:7180; rev:10; )",['T1056']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Cobalt Strike beacon inbound connection attempt""; flow:to_client,established; content:""x-timer: S1580937960.346550,VS0,VE0"",fast_pattern,nocase; content:""Cache-Control: public,max-age=31536000""; content:""Server: UploadServer""; content:""Vary: Accept-Encoding, Fastly-SSL""; content:""x-api-version: F-X""; content:""x-Firefox-Spdy: h2""; content:""x-served-by: cache-mdw17344-MDW""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-user; sid:56617; rev:1; )",['T1102']
"alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:""BROWSER-IE Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt""; flow:to_server,established; content:""i|00|e|00|s|00|h|00|i|00|m|00|s|00|.|00|d|00|l|00|l|00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:netbios-ssn; classtype:attempted-user; sid:19172; rev:12; )",['T1574']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt""; flow:to_server,established; http_uri; content:""/DDIService.svc/SetObject"",fast_pattern,nocase; content:""VirtualDirectory"",nocase; http_client_body; content:""ExternalUrl"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:57252; rev:1; )",['T1106']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_client_body; content:""$%257b"",fast_pattern,nocase; pcre:""/\x24%257b.{0,200}(%(25)?24|\x24)(%(25)?7b|\x7b).{0,200}(%(25)?3a|\x3a)(%(25)?(27|2d|5c|22)|[\x27\x2d\x5c\x22])*([jndi\x7d\x3a\x2d]|(%(25)?(7d|3a|2d))|(%(25)?5c|\x5c)u00[a-f0-9]{2}){1,4}(%(25)?(22|27)|[\x22\x27])?(%(25)?(3a|7d)|[\x3a\x7djndi])/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58789; rev:4; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Microsoft Exchange autodiscover server side request forgery attempt""; flow:to_server,established; http_uri; content:""/autodiscover"",fast_pattern,nocase; http_client_body; content:""Email="",nocase; pcre:""/(^|&)Email=[^&]*?(\x2f|%(25)?2f)autodiscover/im""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; gid:1; sid:57906; rev:6; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.C99Madnet inbound connection attempt""; flow:to_server,established; http_client_body; content:""act=""; content:""&fullhexdump="",fast_pattern,nocase; content:""&d=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:59219; rev:1; )",['T1505']
"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 00|""; byte_jump:2,0,relative; content:""|18 03 00|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30778; rev:4; )",['T1123']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 10000 ( msg:""SERVER-OTHER Veritas Backup Exec root connection attempt using default password hash""; flow:to_server,established; content:""|00 00 00 00 00 00 09 01|"",depth 8,offset 12; content:""|00 00 00 02|"",depth 4,offset 28; content:""root"",depth 4,offset 36,nocase; content:""|B4 B8 0F|& |5C|B4|03 FC AE EE 8F 91|=o"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; classtype:suspicious-login; sid:4126; rev:13; )",['T1078']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; content:"" () {"",depth 50; http_uri; bufferlen:>0; pkt_data; content:!""HTTP/""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:32335; rev:2; )",['T1204']
"alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS ( msg:""SERVER-ORACLE select union attempt""; flow:to_server,established; content:""select "",nocase; content:"" union "",nocase; metadata:ruleset community; classtype:protocol-command-decode; sid:1676; rev:7; )",['T1213']
"alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION DNS TXT response record tunneling""; flow:to_client; dsize:>300; content:""|00 10 00 01 00 00 00 00 01 00 FF|"",fast_pattern,nocase; detection_filter:track by_src,count 25,seconds 1; metadata:policy max-detect-ips drop,ruleset community; service:dns; T1048; classtype:misc-activity; sid:47639; rev:3; )",['T1048']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer getElementById object corruption""; flow:to_client,established; file_data; content:""function post_info(info_array)""; content:""info_array.length|3B| i ++)"",distance 0; pcre:""/^\s*\x7B[^\x7D]*document\.createElement\('input'\)[^\x7D]*form\.appendChild\(plugin\)\s*\x7D/Rims""; content:""document.body.removeChild(form)|3B|""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19079; rev:9; )",['T1176']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER Apache Log4j logging remote code execution attempt""; flow:to_server,established; http_header; content:""${lower:"",fast_pattern,nocase; pcre:""/\x24{(\x24{(upper|lower):j}|j)(\x24{(upper|lower):n}|n)(\x24{(upper|lower):d}|d)(\x24{(upper|lower):i}|i)(\x24{(upper|lower)::}|:)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; gid:1; sid:58724; rev:6; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Rockwell Automation default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW5pc3RyYXRvcjptbDExMDA="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37390; rev:3; )",['T1078']
"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-OTHER self-signed SSL certificate with default MyCompany Ltd organization name""; flow:to_client,established; ssl_state:server_hello; content:""|55 04 0A|""; content:""|0E|MyCompany Ltd"",within 14,distance 1; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:ssl; T1078; classtype:policy-violation; sid:27538; rev:4; )",['T1078']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE IP address check to dyndns.org detected""; flow:to_server,established; http_header; content:""Host|3A 20|checkip.dyndns.org"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:misc-activity; sid:26353; rev:3; )",['T1043']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-APACHE Apache chunked-encoding worm attempt""; flow:to_server,established; http_header; content:""X-CCCCCCC|3A 20|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:1809; rev:20; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE PhpSploit backdoor communication attempt""; flow:to_server,established; http_header; content:""JHg9JF9QT1NUWy"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:50954; rev:1; )",['T1505']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""EXPLOIT-KIT Angler exploit kit obfuscated Flash actionscript classname detected""; flow:to_server,established; file_data; content:""|0E|IIll1III111I11|0E|Illl1III111I11"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:35110; rev:4; )",['T1027']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer CHM file load attempt""; flow:to_client,established; file_data; content:""showHelp("",fast_pattern,nocase; content:"".chm"",within 40,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:28931; rev:3; )",['T1218']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Gen variant outbound connection""; flow:to_server,established; http_uri; content:""/aspnet_client/system_web/4_0_30319/update/"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:44689; rev:3; )",['T1071']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-OTHER Multiple products external entity data exfiltration attempt""; flow:to_server,established; file_data; content:""<!ENTITY"",nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; content:""<!ENTITY"",distance 0,nocase; content:""SYSTEM"",within 50,nocase; content:""://"",within 25; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-attack; sid:37313; rev:5; )",['T1020']
"alert tcp any $FILE_DATA_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner download attempt""; flow:to_client,established; flowbits:isset,file.exe; file_data; content:""poisoners.NBTNS"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:49529; rev:1; )",['T1187']
"alert udp $EXTERNAL_NET any -> $HOME_NET 123 ( msg:""SERVER-OTHER NTP origin timestamp denial of service attempt""; flow:to_server; content:""|00|"",depth 1,offset 1; byte_test:1,>,17,0,relative; content:""RATE|00 00 00 00|"",within 8,distance 10; metadata:policy max-detect-ips drop; classtype:attempted-dos; sid:40811; rev:4; )",['T1547']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Apple Quicktime plugin SetLanguage buffer overflow attempt""; flow:to_client,established; file_data; content:""<object"",nocase; content:""02BF25D5-8C17-4B23-BC80-D3488ABDDC6B"",within 200; content:""<EMBED"",nocase; content:""SRC="",distance 0,nocase; content:""PLUGINSPAGE"",distance 0; content:""SetLanguage|28 22|"",nocase; content:!""|22|"",within 512; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:23985; rev:10; )",['T1176']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Php.Webshell.DToolPro inbound connection attempt""; flow:to_server,established; http_uri; content:"".php"",nocase; pkt_data; content:""?&cmd="",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60401; rev:1; )",['T1505']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original Stager 2 download attempt""; flow:to_client,established; http_header; content:""Content-Type: text/json|0D 0A|""; content:""Server: Microsoft-IIS/10.0|0D 0A|""; content:""X-Powered-By: ASP.NET|0D 0A|""; content:""Cache-Control: no-cache, no-store, max-age=0, must-revalidate|0D 0A|""; content:""Pragma: no-cache|0D 0A|""; content:""X-Frame-Options: SAMEORIGIN|0D 0A|""; content:""Content-Type: image/gif""; file_data; content:""|01 00 01 00 00 02 01 44 00 3B|""; content:""|FF FF FF 21 F9 04 01 00 00 00 2C 00 00 00 00|""; content:""|47 49 46 38 39 61 01 00 01 00 80 00 00 00 00|""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56601; rev:1; )",['T1043']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Win.Backdoor.Chopper webshell inbound request attempt""; flow:to_server,established; http_uri; content:""/temporary_listen_addresses/wsman"",fast_pattern,nocase; http_cookie; content:""_reguestguid"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:50277; rev:4; )",['T1071']
"alert http ( msg:""SERVER-WEBAPP Atlassian Confluence OGNL expression injection attempt""; flow:to_server,established; http_uri; content:""${""; content:""com.opensymphony."",distance 0,fast_pattern; content:""|28|"",distance 0; content:""}"",distance 0; pcre:""/\x24\x7b[^\x7d]*?com\x2eopensymphony\x2e(xwork2|webwork)\x2e(Servlet)?ActionContext[^\x7d]*?\x28/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:59948; rev:1; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt""; flow:to_server,established,only_stream; content:""|18 03 02|"",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30512; rev:8; )",['T1123']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Php.Webshell.Generic download attempt""; flow:to_client,established; file_data; content:""<?""; content:""function deltree($deldir) "",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:59092; rev:1; )",['T1505']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Win.Trojan.Xtrat outbound connection detected""; flow:to_server,established; http_uri; content:""/plugin.xtr"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:39734; rev:4; )",['T1176']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /.... access""; flow:to_server,established; content:""/....""; metadata:ruleset community; service:http; classtype:attempted-recon; sid:1142; rev:11; )",['T1074']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP TRACE attempt""; flow:to_server,established; content:""TRACE"",depth 5; metadata:ruleset community; service:http; classtype:web-application-attack; sid:2056; rev:12; )",['T1078']
"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""APP-DETECT Teamviewer control server ping""; flow:to_server; content:""teamviewer"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:dns; classtype:policy-violation; sid:24094; rev:3; )",['T1219']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP DELETE attempt""; flow:to_server,established; content:""DELETE "",depth 7,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1603; rev:13; )",['T1592']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original outbound connection attempt""; flow:to_server,established; http_header; content:""Accept: */*|0D 0A|""; content:""Accept-Language: en-US|0D 0A|""; content:""Accept-Encoding: gzip, deflate|0D 0A|""; http_uri; pcre:""/(\/check|\/v1\/stats|\/gql|\/1.5\/95648064|\/u\/0\/_\/og\/botguard\/get|\/ev\/\w{3}001001)/i""; file_data; content:""{|22|locale|22|:|22|en|22|,|22|channel|22|:|22|prod|22|,|22|addon|22|:|22|""; content:""ses-""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56600; rev:1; )",['T1043']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Careto plugin download""; flow:to_server,established; http_uri; content:""/l/af_l_addon.xpi"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; T1176; classtype:trojan-activity; sid:29790; rev:4; )",['T1176']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original inbound connection attempt""; flow:to_client,established; file_data; content:""{|22|meta|22|:{},|22|status|22|:|22|OK|22|,|22|saved|22|:|22|1|22|,|22|starttime|22|:17656184060,|22|id|22|:|22 22|,|22|vims|22|:{|22|dtc|22|:"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56598; rev:1; )",['T1043']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Oilrig variant outbound connection""; flow:to_server,established; http_header; content:""User-Agent: Microsoft BITS/7.7"",fast_pattern,nocase; content:""Referer: https://www.google.com""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:41435; rev:3; )",['T1197']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 21 ( msg:""OS-OTHER Bash environment variable injection attempt""; flow:to_server,established; content:""USER "",depth 5; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp; classtype:attempted-admin; sid:32043; rev:3; )",['T1204']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP content-disposition file upload attempt""; flow:to_server,established; http_header; content:""Content-Disposition|3A|"",nocase; pkt_data; content:""form-data|3B|"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1425; rev:22; )",['T1155']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666 ( msg:""MALWARE-CNC Win.Trojan.Baisogu outbound connection""; flow:to_server; content:""/9hao/count.asp?"",fast_pattern,nocase; content:""mac="",depth 4,offset 21; content:""&ver="",within 25; content:""&tjuser="",within 35; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:35471; rev:3; )",['T1571']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Hirschmann default password login attempt""; flow:to_server,established; http_header; content:""Authorization|3A|"",nocase; content:""YWRtaW46cHJpdmF0ZQ=="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:default-login-attempt; sid:37385; rev:3; )",['T1078']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 749 ( msg:""SERVER-WEBAPP MIT Kerberos V% KAdminD klog_vsyslog server overflow attempt""; flow:to_server,established; content:""|90|D|FA A0 B1|^C|07|m'|1C|m|08 02 D0 C7 C0|q|EE|q|E3|R|B3 1C|}K|DE D2 C1 F8 5C|{"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:attempted-user; sid:16207; rev:11; )",['T1550']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Jsp.Webshell.TinyUploader upload attempt""; flow:to_server,established; content:""java.io.FileOutputStream"",fast_pattern,nocase; content:""<%""; content:""request"",within 100; content:""write""; content:""getParameter"",within 100; isdataat:!600; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59927; rev:2; )",['T1094']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Dridex4 initial outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:1; http_header; content:""Referer: https://twitter.com/|0D 0A|"",fast_pattern,nocase; pkt_data; content:""|0D 0A 0D 0A|""; byte_extract:1,4,lessthanChar,relative; byte_test:1,=,lessthanChar,7,relative; byte_extract:1,0,lChar,relative; byte_test:1,=,lChar,15,relative; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:34037; rev:4; )",['T1102']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Drupal 8 remote code execution attempt""; flow:to_server,established; http_uri; content:""element_parents="",fast_pattern,nocase; content:""#value""; http_client_body; pcre:""/(%23|#)(submit|validate|access_callback|pre_render|post_render|lazy_builder|%6c%61%7a%79%5f%62%75%69%6c%64%65%72)/i""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:46316; rev:5; )",['T1106']
"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Php.Webshell.DiveShell outbound connection attempt""; flow:to_client,established; file_data; content:""command_hist[current_line] = document.shell.command.value|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60338; rev:1; )",['T1505']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Noop download attempt""; flow:to_client,established; file_data; content:""java.util.*""; content:""java.io.FileOutputStream"",distance 0; content:""request.getParameter(|22|name|22|)"",within 200,fast_pattern; content:""request.getParameter(|22|contentString|22|)""; isdataat:!300,relative; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59930; rev:2; )",['T1094']
"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Mimikatz use via SMB attempt""; flow:to_server,established; content:""k|00|u|00|h|00|l|00|_|00|m|00|_|00|l|00|s|00|a|00|d|00|u|00|m|00|p|00|_|00|g|00|e|00|t|00|H|00|a|00|s|00|h|00|"",fast_pattern,nocase; content:""|FF|SMB|2F|"",depth 5,offset 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50463; rev:1; )",['T1187']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Chopper upload attempt""; flow:to_server,established; content:""DriverManager.getConnection""; content:""ServletOutputStream""; content:""ResultSetMetaData""; content:""request.getParameter""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59931; rev:2; )",['T1094']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION String.fromCharCode with multiple encoding types detected""; flow:to_client,established; content:""String.fromCharCode"",fast_pattern,nocase; pcre:""/String\x2efromCharCode\s*\x28[^\x29]*0x[0-9a-f]{2}\s*,[^\x29]*,\s*0[0-7]{1,3}\s*,[^\x29]*,\s*[1-9][0-9]{0,2}\s*,/ims""; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:21038; rev:9; )",['T1027']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.WinPlock variant outbound connection""; flow:to_server,established; http_uri; content:""/wp-content/plugins/WPCoreLog/log.php?rnd="",fast_pattern,nocase; http_header; content:""WinHttp.WinHttpRequest.5""; http_client_body; content:""Run as Admin""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36304; rev:3; )",['T1176']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP Symantec Web Gateway blocked.php blind sql injection attempt""; flow:to_server,established; http_uri; content:""/blocked.php"",fast_pattern,nocase; content:""id="",nocase; pcre:""/[\x3f\x26]id=\d*?[\x28\x29\x22\x27]/is""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:23934; rev:11; )",['T1190']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/motd file access attempt""; flow:to_server,established; http_uri; content:""/etc/motd"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:43288; rev:3; )",['T1087']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Php.Webshell.Cybershell upload attempt""; flow:to_server,established; file_data; content:""header(|22|Expires: |22|.date(|22|r|22|,mktime(0,0,0,1,1,2030)))|3B|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; gid:1; sid:60299; rev:1; )",['T1505']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP RedHat Piranha Virtual Server Package default passwd and arbitrary command execution attempt""; flow:to_server,established; http_uri; content:""/piranha/secure/passwd.php3"",fast_pattern,nocase; content:""passwd=ACCEPT"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-admin; sid:27756; rev:4; )",['T1078']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:""APP-DETECT remote desktop protocol attempted administrator connection request""; flow:to_server,established; content:""|E0|"",depth 1,offset 5; content:""mstshash=Administr"",distance 0,nocase; classtype:misc-activity; sid:4060; rev:9; )",['T1021']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Oracle WebCenter Content CheckOutAndOpen.dll ActiveX control code execution ActiveX function call access""; flow:to_client,established; file_data; content:""CheckOutAndOpen.Control"",fast_pattern,nocase; content:"".coao|28|"",nocase; content:"".hta"",nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:32105; rev:8; )",['T1218']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Adobe Invoice email scam phishing attempt""; flow:to_server,established; content:""Content-Disposition|3A 20|attachment"",nocase; content:""adb-"",within 50,nocase; content:""-invoice.zip"",within 12,distance 6,fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop; service:smtp; classtype:trojan-activity; sid:32771; rev:3; )",['T1566']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/licenseserverproto.cgi"",fast_pattern,nocase; http_client_body; content:""id="",nocase; pcre:""/(^|&)(server)?id=/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57465; rev:2; )",['T1071']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 02|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30522; rev:9; )",['T1123']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP csh access""; flow:to_server,established; http_uri; content:""/csh"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:attempted-recon; sid:862; rev:21; )",['T1204']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake bookinginfo HTTP Response phishing attack""; flow:to_client,established; http_header; content:""|3B 20|filename=BookingInfo.zip|0D 0A|"",fast_pattern,nocase; file_data; content:""BookingInfo.exe""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:25579; rev:4; )",['T1566']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.GateKeylogger initial exfiltration attempt""; flow:to_server,established; content:""/gate.php"",fast_pattern,nocase; http_client_body; content:""pc="",nocase; content:""&admin="",distance 0,nocase; content:""&os="",distance 0,nocase; content:""&hid="",distance 0,nocase; content:""&arc="",distance 0,nocase; http_header; content:""User-Agent|3A 20|""; pcre:""/User-Agent\x3a\x20[A-F0-9]{32}\x0d\x0a/""; metadata:impact_flag red,ruleset community; service:http; T1020; T1056; classtype:trojan-activity; sid:38562; rev:4; )",['T1020']
"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_client,established; content:""|FF|SMB|73|"",depth 5,offset 4; content:""|CE 0E 00 00 00 0F|S|00|M|00|B|00|1|00|2|00 02 00 0A 00|S|00|M|00|B|00|1|00|2|00|"",distance 0; content:""W|00|i|00|n|00|d|00|o|00|w|00|s|00| |00|S|00|e|00|r|00|v|00|e|00|r|00| |00|2|00|0|00|0|00|3|00| |00|3|00|7|00|9|00|0|00|"",distance 0; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50465; rev:1; )",['T1187']
"alert tcp $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any ( msg:""MALWARE-BACKDOOR Perl.Backdoor.STEADYPULSE webshell variant access""; flow:to_client,established; file_data; content:""Results of |27|""; content:""|27| execution:|0A 0A|"",within 260; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57462; rev:1; )",['T1071']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Apache Syncope XSL transform code injection attempt""; flow:to_server,established; http_uri; content:""/syncope-console/wicket/bookmarkable/org.apache.syncope.client.console.pages.Reports"",fast_pattern,nocase; http_client_body; content:""xmlEditorInfo=""; content:""ENTITY"",distance 1,nocase; content:""xsl""; content:""template"",within 10,distance 1; pcre:""/(\x21|%21)ENTITY((?!\x3e|%3e).)*?(SYSTEM|PUBLIC)/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:48231; rev:2; )",['T1220']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Agent.cer variant outbound connection""; flow:to_server,established; http_uri; content:""/com_plugin.php"",nocase; http_client_body; content:""subject|3D|"",nocase; content:""|26|message|3D|"",distance 1,nocase; service:http; classtype:trojan-activity; sid:19706; rev:9; )",['T1176']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.ATRIUM variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/compcheckresult.cgi"",fast_pattern,nocase; http_client_body; content:""id="",nocase; pcre:""/(^|&)id=/im""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57466; rev:1; )",['T1071']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP MCA Sistemas ScadaBR index.php brute force login attempt""; flow:to_server,established,only_stream; http_uri; content:""/ScadaBR/login.htm"",fast_pattern,nocase; http_raw_header; content:""JSESSIONID""; http_client_body; content:""username""; content:""password""; detection_filter:track by_src,count 10,seconds 30; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:42451; rev:4; )",['T1110']
"alert tcp any any -> $HOME_NET 8009 ( msg:""SERVER-APACHE Apache Tomcat AJP connector arbitrary file access attempt""; flow:to_server,established; content:""|12 34|"",depth 2; content:""|02|"",within 1,distance 2; byte_test:1,!&,0xF9,0,relative; byte_extract:2,1,protocol_len,relative; content:""HTTP"",within protocol_len,nocase; content:""javax.servlet.include.request_uri|00|"",fast_pattern,nocase; content:""javax.servlet.include.servlet_path|00|"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:53341; rev:2; )",['T1048']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Java.Trojan.Jacksbot class download""; flow:to_client,established; flowbits:isset,file.class; file_data; content:""FLOOD DRAIN"",fast_pattern,nocase; content:""#!/bin/bash""; content:"".minecraft"",distance 0; content:""/etc/rc.common"",distance 0; content:""/etc/rc.local"",distance 0; content:"".filezilla/recentservers.xml"",distance 0; metadata:impact_flag red,policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:24426; rev:5; )",['T1087']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-PDF JavaScript contained in an xml template embedded in a pdf attempt""; flow:to_client,established; flowbits:isset,file.pdf; file_data; content:""<template xmlns=""; content:""http|3A|//www.xfa.org/"",distance 1; content:""<event activity"",distance 0; content:""initialize"",within 50,distance 1; content:""application/x-javascript"",distance 0; metadata:policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:23612; rev:11; )",['T1027']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.yty plugin downloader initial outbound connection""; flow:to_server,established; http_header; content:""Expect: 100-continue"",fast_pattern,nocase; http_client_body; content:""pc=""; content:""pc_data=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1176; classtype:trojan-activity; sid:46067; rev:2; )",['T1176']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT Sundown Exploit kit landing page obfuscation detected""; flow:to_client,established; file_data; content:""|22|script|22|"",nocase; content:""|22|createE|22|"",within 50,nocase; content:""|22|lement|22|"",within 20,nocase; content:""|22|type|22|"",within 50,nocase; content:""|22|text/j|22|"",within 50,nocase; content:""|22|avascript|22|"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:41084; rev:2; )",['T1027']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-TOOLS Win.Tool.Delete variant download detected""; flow:to_client,established; file_data; content:""/|00|q|00 20 00|&|00|&|00 20 00|s|00|h|00|u|00|t|00|d|00|o|00|w|00|n|00 20 00|/|00|r|00 20 00|/|00|f|00 20 00|/|00|t|00 20 00|0|00|0|00|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:48501; rev:2; )",['T1070']
"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""MALWARE-OTHER DNS data exfiltration attempt""; flow:to_server; content:""|00 00 00|"",offset 2; content:""|01|"",within 1; content:""|3A|"",within 1,distance 6; content:""|2D 2D 2D|"",within 3,distance 30,fast_pattern; content:""|3A|"",within 1,distance 25; content:""|01|"",within 1,distance 58; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:dns; classtype:policy-violation; sid:26803; rev:6; )",['T1020']
"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_client,established; content:""|C8 27 3D FB D4 18 55 4F B2 40 AF D7 61 73 75 3B|"",fast_pattern,nocase; content:""|84 D6 FB A3 01 35 CD 01|""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50104; rev:1; )",['T1187']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP bash access""; flow:to_server,established; http_uri; content:""/bash"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:885; rev:21; )",['T1204']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 00|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30520; rev:9; )",['T1123']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-BACKDOOR Perl.Backdoor.HARDPULSE variant inbound cnc connection""; flow:to_server,established; http_uri; content:""/compcheckjava.cgi"",fast_pattern,nocase; http_client_body; content:""hashid="",nocase; content:""checkcode="",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:57464; rev:1; )",['T1071']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Ios.Backdoor.SYNful inbound connection""; flow:to_server,established; content:""text"",depth 4,offset 78; content:""|00 00 00|"",within 3,distance 1; content:""|45 25 6D|"",within 3,distance 1,fast_pattern; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36054; rev:6; )",['T1205']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-BACKDOOR MultiOS.Malware.GORAT malware download attempt""; flow:to_server,established; file_data; content:""aqlKZ7wjzg0iKM00E1WB/jq9_RA46w91EKl9A02Dv/nbNdZiLsB1ci8Ph0fb64/9Ks1YxAE86iz9A0dUiDl""; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:smtp; classtype:trojan-activity; sid:56595; rev:1; )",['T1050']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""OS-OTHER Bash CGI environment variable injection attempt""; flow:to_server,established; http_client_body; content:""() {"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:31976; rev:5; )",['T1204']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""z9=base64%5fdecode"",fast_pattern,nocase; content:""=%40eval""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:42834; rev:5; )","['T1505', 'T1219']"
"alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-OBFUSCATION ICMP HTTP tunneling attempt""; icode:0; content:""HTTP/"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:misc-activity; sid:47401; rev:2; )",['T1048']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:""MALWARE-OTHER GHBkdr TLS Handshake spoof runtime detection""; flow:to_server,established; content:""|16 03 02 00 81 01 00 00 7D 03 02|""; content:""|00 00 18 C0 14 C0 13 00 39 00 33 00 35 00 2F C0 0A C0 09 00 38 00 32 00 0A 00 13 01 00 00 3C 00 00 00 16 00 14 00 00 11|www.microsoft.com|00 05 00 05 01 00 00 00 00 00 0A 00 06 00 04 00 17 00 18 00 0B 00 02 01 00 00 17 00 00 FF 01 00 01 00|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:44475; rev:3; )",['T1195']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-BACKDOOR Jsp.Webshell.Behinder download attempt""; flow:to_client,established; file_data; content:""<%""; content:""java.util.*""; content:""extends ClassLoader"",fast_pattern,nocase; content:""defineClass""; content:""getInstance(|22|AES|22|)""; content:""decodeBuffer"",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:59929; rev:2; )",['T1094']
"alert tcp any 445 -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB attack attempt""; flow:to_client,established; content:""W|00|I|00|N|00|-|00|P|00|R|00|H|00|4|00|9|00|2|00|R|00|Q|00|A|00|F|00|V|00|.|00|S|00|M|00|B|00|3|00|.|00|l|00|o|00|c|00|a|00|l|00|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50106; rev:1; )",['T1187']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/shadow file access attempt""; flow:to_server,established; http_uri; content:""/etc/shadow"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:43289; rev:3; )",['T1087']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-IE Microsoft Internet Explorer CHM file load attempt""; flow:to_server,established; file_data; content:""showHelp("",nocase; content:"".chm"",within 40,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:misc-activity; sid:28932; rev:3; )",['T1218']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS RealNetworks RealPlayer obfuscated Ierpplug.dll ActiveX exploit attempt""; flow:to_client,established; file_data; content:""VulObject = |22|IER|22| + |22|PCtl.I|22| + |22|ERP|22| + |22|Ctl.1|22 3B|"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:12775; rev:13; )",['T1027']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Tentobr outbound connection""; flow:to_server,established; http_uri; content:""/botnet/suca.php"",fast_pattern,nocase; http_raw_uri; bufferlen:16; http_client_body; content:""entradatrasera="",depth 15,nocase; content:""&key="",distance 0; content:""&pais="",distance 0; content:""&timeout="",distance 0; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:36666; rev:3; )",['T1571']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER Arcserve Unified Data Protection Management credential disclosure attempt""; flow:to_server,established; http_uri; content:""/services/EdgeServiceImpl"",fast_pattern,nocase; http_client_body; content:""getBackupPolicy"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:34944; rev:6; )",['T1003']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""APP-DETECT VPN Over DNS application download attempt""; flow:to_server,established; flowbits:isset,file.apk|file.zip; file_data; content:""assets/dns160.png"",fast_pattern,nocase; content:""assets/dns240.png"",nocase; content:""assets/dns320.png"",within 150,nocase; content:""assets/fond-Snow-UI-Kit-2.png"",within 150,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:policy-violation; sid:29383; rev:4; )",['T1021']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS obfuscated instantiation of ActiveX object - likely malicious""; flow:to_client,established; file_data; content:""new ActiveXObject|28|"",nocase; content:""unescape|28|"",within 20,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:17571; rev:9; )",['T1027']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-IIS view source via translate header""; flow:to_server,established; http_header; content:""Translate|3A| F"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:1042; rev:26; )",['T1119']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.NetWiredRC variant keepalive""; flow:to_server,established; content:""|01 00 00 00 01|"",depth 5; isdataat:4; isdataat:!5; metadata:impact_flag red,ruleset community; classtype:trojan-activity; sid:38355; rev:3; )",['T1094']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""APP-DETECT Foca file scanning attempt""; flow:to_server,established; http_header; content:""User-Agent|3A 20|FOCA|0D 0A|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-recon; sid:29354; rev:3; )",['T1083']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""OS-WINDOWS Microsoft Windows Content-Disposition CLSID command attempt""; flow:to_client,established; http_header; content:""Content-Disposition|3A|"",nocase; content:""{3050f4d8-98B5-11CF-BB82-00AA00BDCE0B}""; content:""%2e"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:2589; rev:19; )",['T1203']
"alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.Bledoor TCP tunnel in ICMP""; content:""|08 00 45|"",depth 3,offset 12; content:""|00 00|"",within 2,distance 5; content:""|06|"",within 1,distance 1; content:""|00 00 00 00|"",within 4,distance 18; metadata:impact_flag red,policy max-detect-ips drop; classtype:trojan-activity; sid:24088; rev:6; )",['T1048']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Cobalt Strike beacon inbound connection attempt""; flow:to_client,established; file_data; content:""{|22|meta|22|:{},|22|status|22|:|22|OK|22|,|22|saved|22|:|22|1|22|,|22|starttime|22|:17656184060,|22|id|22|:|22 22|,|22|vims|22|:{|22|dtc|22|:|22|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56608; rev:1; )",['T1020']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""PUA-ADWARE Osx.Adware.TotalAdviseSearch variant download attempt""; flow:to_client,established; file_data; flowbits:isset,file.macho64le; content:""|06 00 48 89 DF 5B 41 5C 41 5E 41 5F 5D E9 DD 0B 00 00 5B 41 5C 41 5E 41 5F 5D C3 55 48 89 E5 53|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:50028; rev:2; )",['T1643']
"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP IPV6 Where-Are-You undefined code""; icode:>0; itype:33; metadata:ruleset community; classtype:misc-activity; sid:414; rev:10; )",['T1592']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""INDICATOR-OBFUSCATION known packer routine with secondary obfuscation""; flow:to_client,established; file_data; content:""eval(function(p,a,c,k,e,r)"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ftp-data,http,imap,pop3; T1027; T1140; classtype:misc-activity; sid:23621; rev:9; )",['T1189']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC evilotus 1.3.2 variant outbound connection""; flow:to_server,established; flowbits:isset,Evilotus_detection; content:""|0C|~|7F D8|"",depth 4; content:""|00 00 00|d|C8 00 00|"",within 8,distance 1; content:""|00 00 00|"",within 3,distance 1; classtype:trojan-activity; sid:13507; rev:6; )",['T1014']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.tdss.1.gen install-time detection - yournewsblog.net""; flow:to_server,established; http_uri; content:""/tdss/""; pkt_data; content:""Host|3A| yournewsblog.net"",nocase; service:http; classtype:trojan-activity; sid:16268; rev:8; )",['T1014']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Raccoon variant outbound request detected""; flow:to_server,established; http_uri; content:""/l/f/"",depth 5,fast_pattern; content:!""?""; http_header; content:!""User-Agent"",nocase; content:!""Accept"",nocase; content:!""Referer"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:57975; rev:1; )",['T1105']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-OFFICE Microsoft Windows RTF file with embedded object package download attempt""; flow:to_client,established; file_data; content:""{|5C|rt"",nocase; content:""{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"",distance 0,nocase; flowbits:set,file.rtf.embed; metadata:policy max-detect-ips alert,policy security-ips alert,ruleset community; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:8445; rev:17; )",['T1204']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""EXPLOIT-KIT Scanbox exploit kit enumeration code detected""; flow:to_server,established; file_data; content:""document|2E|createElement|28|unescape|28 22 25|3Ciframe|25|20id|25|3D"",fast_pattern,nocase; content:""|2E|crypt|2E|_utf8_encode""; content:""|2E|push|28|""; content:""|3D 3D|c|3A 5C 5C|Program Files|5C 5C|"",within 30; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:31858; rev:3; )",['T1189']
"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1.2 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|18 03 03|""; byte_jump:2,0,relative; content:""|18 03 03|"",within 3; byte_test:2,>,128,0,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30788; rev:5; )",['T1005']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Download of executable screensaver file""; flow:to_client,established; flowbits:isset,file.screensaver; file_data; content:""MZ"",depth 2; metadata:impact_flag red,policy max-detect-ips drop; service:http; classtype:policy-violation; sid:32949; rev:3; )",['T1546']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""EXPLOIT-KIT unknown exploit kit obfuscated landing page""; flow:to_client,established; file_data; content:""[]]}|7C|}{$$$$]}$]]}]]$|7C|$}$]$+]}]/$/]/${$$]$]]]]])$)$|7C|]/$+"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:21108; rev:7; )",['T1027']
"alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:""APP-DETECT VNC server response""; flow:established; content:""RFB 0"",depth 5; content:"".0"",depth 2,offset 7; metadata:ruleset community; classtype:misc-activity; sid:560; rev:9; )",['T1021']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Malvertising network attempted redirect""; flow:to_client,established; file_data; content:"".php|22| name=|22|Twitter|22| scrolling=|22|auto|22| frameborder=|22|no|22| align=|22|center|22| height=|22|2|22| width=|22|2|22|></iframe>"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:23620; rev:6; )",['T1102']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Html.Dropper.Xbash variant obfuscated powershell invocation""; flow:to_client,established; file_data; content:""|5C|x70|5C|x6F|5C|x77|5C|x65|5C|x72|5C|x73|5C|x68|5C|x65|5C|x6C|5C|x6C|5C|x2E|5C|x65|5C|x78|5C|x65|5C|x20|5C|x2D|5C|x65|5C|x78|5C|x65|5C|x63|5C|x75|5C|x74|5C|x69|5C|x6F|5C|x6E|5C|x70|5C|x6F|5C|x6C|5C|x69|5C|x63|5C|x79|5C|x20|5C|x62|5C|x79|5C|x70|5C|x61|5C|x73|5C|x73"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:47866; rev:2; )",['T1059']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Siemens IP-Camera credential disclosure attempt""; flow:to_server,established; http_uri; content:""/cgi-bin/readfile.cgi"",fast_pattern,nocase; content:""query=ADMINID"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-admin; sid:39930; rev:3; )",['T1003']
"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""SERVER-WEBAPP SSL certificate with null issuer rdnSequence fields detected""; flow:to_client,established; ssl_state:server_hello; content:""|30 07 06 03 55 04 06 13 00 31 09 30 07 06 03 55 04 08 13 00 31 09 30 07 06 03 55 04 07 13 00 31 09 30 07 06 03 55 04 0A 13 00 31 09 30 07 06 03 55 04 0B 13 00 31 09 30 07 06 03 55 04 03 13 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:ssl; classtype:misc-activity; sid:47640; rev:2; )",['T1102']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""FILE-OTHER WinRAR ACE remote code execution attempt""; flow:to_server,established; file_data; content:""**ACE**"",depth 7,offset 7; pcre:""/(?:[a-z]:\x5C?){2}/i""; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:49292; rev:4; )",['T1547']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""=edoced_46esab"",fast_pattern,nocase; content:""z0=""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:42835; rev:5; )","['T1505', 'T1219']"
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_server,established; file_data; content:""powershell|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?powershell\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:47847; rev:4; )",['T1059']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.FakeAV TDSS/PurpleHaze variant outbound connection - base64 encoded""; flow:to_server,established; http_header; content:""Accept-Language|3A 20|en-US|0D 0A|User-Agent|3A 20|Mozilla/4.0|20|(compatible"",fast_pattern,nocase; content:!""Referer""; pkt_data; content:""GET /"",depth 5; base64_decode:relative; base64_data; content:""cl|7C|1.6|7C|""; content:""|7C|161"",distance 0; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:21318; rev:8; )",['T1001']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer XSLT memory corruption attempt""; flow:to_client,established; file_data; content:""xmlns"",nocase; content:""|3A|xsl"",within 8,nocase; content:""http|2D|equiv|3D|"",nocase; content:""refresh"",within 10,nocase; content:""onunload"",fast_pattern,nocase; pcre:""/http\x2dequiv\x3d\s*?[\x22\x27]\s*?refresh\s*?[\x22\x27]\s*?content\s*?\x3d\s*?[\x22\x27]\s*?((1\s*?)|(0\s*?)|(\.\d\s*?)|(1\.\d\s*?))[\x22\x27]/ims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19671; rev:18; )",['T1220']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.PassStealer passwords exfiltration attempt""; flow:to_server; file_data; content:""Passwords Recorded On "",fast_pattern; content:""Time of Recording:"",within 20,distance 22; content:""IP Address"",within 12,distance 15; metadata:impact_flag red,ruleset community; service:ftp; T1020; classtype:trojan-activity; sid:38950; rev:4; )",['T1020']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-MAIL Microsoft Exchange Server arbitrary file write attempt""; flow:to_server,established; http_uri; content:""/DDIService.svc/SetObject"",fast_pattern,nocase; content:""VirtualDirectory"",nocase; http_client_body; content:""FilePathName"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-admin; sid:57253; rev:1; )",['T1106']
"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Responder poisoner SMB negotiation attack attempt""; flow:to_server,established; content:""|FF|SMB|2D|"",depth 5,offset 4; content:""|0F FF 00|"",within 3,distance 27; content:""|16 00 20 00 40 9D C1 57 01 00|"",within 10,distance 6; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50466; rev:1; )",['T1187']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Necurs Rootkit sba.cgi""; flow:to_server,established; http_method; content:""POST""; http_raw_uri; bufferlen:16; http_uri; content:""/cgi-bin/sba.cgi"",fast_pattern,nocase; http_client_body; pcre:""/[^\x20-\x7e\x0d\x0a]{4}/""; metadata:ruleset community; service:http; T1014; classtype:trojan-activity; sid:25503; rev:4; )",['T1014']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Cobalt Strike beacon outbound connection attempt""; flow:to_server,established; http_header; content:""auth=0|5C 3B|loc=US}"",fast_pattern,nocase; content:""sess-=""; content:""Accept-Encoding: gzip, deflate, br""; content:""Accept-Language: en-US|0D 0A|""; content:""Accept: */*""; http_uri; pcre:""/^\x2f(updates|license\x2feula|docs\x2foffice|software-activation)/i""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56610; rev:1; )",['T1020']
"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL SSLv3 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|16 03 00|""; byte_jump:2,0,relative; content:""|18 03 00|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30777; rev:4; )",['T1123']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake postal receipt HTTP Response phishing attack""; flow:to_client,established; http_header; content:""|3B 20|filename=Postal-Receipt.zip|0D 0A|"",fast_pattern,nocase; file_data; content:""Postal-Receipt.exe""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:26261; rev:3; )",['T1566']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla download directory file deletion attempt""; flow:to_client,established; file_data; content:""<a href=|22|data:application/octet-stream,hello|22|>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:45173; rev:3; )",['T1070']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 01|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30521; rev:9; )",['T1123']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""PUA-ADWARE Osx.Adware.TotalAdviseSearch variant download attempt""; flow:to_server,established; file_data; flowbits:isset,file.macho64le; content:""|06 00 48 89 DF 5B 41 5C 41 5E 41 5F 5D E9 DD 0B 00 00 5B 41 5C 41 5E 41 5F 5D C3 55 48 89 E5 53|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:misc-activity; sid:50029; rev:2; )",['T1643']
"alert ssl ( msg:""SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt""; flow:established; content:""|06 03 55 1D 1E|""; ber_skip:0x01,optional; ber_data:0x04; ber_data:0x30; ber_data:0xa0; ber_data:0x30; content:""|81 82|"",within 2; byte_test:2,>,500,0,relative; content:""xn--"",within 4,distance 2,fast_pattern; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:300307; rev:3; )",['T1189']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Wordpress plugin arbitrary file deletion attempt""; flow:to_server,established; http_uri; content:""/wp-admin/admin-ajax.php"",fast_pattern,nocase; http_client_body; content:""plugin="",nocase; content:""action=delete"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:42066; rev:3; )",['T1070']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Multiple routers getcfg.php credential disclosure attempt""; flow:to_server,established; http_uri; content:""/getcfg.php"",fast_pattern,nocase; http_client_body; pcre:""/(\n|%0A)(A|%41)(U|%55)(T|%54)(H|%48)/i""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-recon; sid:44388; rev:6; )",['T1003']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value""; flow:to_client,established; flowbits:isset,file.xml; file_data; content:""<CanonicalizationMethod"",fast_pattern; content:""<xsl"",distance 0; pcre:""/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/Rms""; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-activity; sid:26639; rev:7; )",['T1220']
"alert tcp any any -> $HOME_NET 445 ( msg:""OS-WINDOWS Microsoft Windows SMB remote code execution attempt""; flow:to_server,established; content:""|FF|SMB3|00 00 00 00|"",depth 9,offset 4; byte_extract:2,26,TotalDataCount,relative,little; byte_test:2,>,TotalDataCount,20,relative,little; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; classtype:attempted-admin; sid:41978; rev:5; )",['T1189']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER OSX.Trojan.Renepo rootkit upload attempt""; flow:to_server,established; file_data; content:""|22|opener: Finished move to System Library StartupItems |22| |3E 3E| |2F|.performance.txt"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:27960; rev:3; )",['T1014']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-WEBKIT Apple Safari user assisted applescript code execution attempt""; flow:to_client,established; file_data; content:""applescript://com.apple.scripteditor"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:36585; rev:3; )",['T1059']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Banker.QO variant outbound connection""; flow:to_server,established; http_client_body; content:""RooTKit+By+Iron+Mask+%2D+Espanha"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:18717; rev:12; )",['T1014']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [$HTTP_PORTS,22222,22223] ( msg:""APP-DETECT Hola VPN non-http port ping""; flow:to_server,established; content:""/ping?rmt_ver"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:policy-violation; sid:37304; rev:3; )",['T1021']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN startup attempt""; flow:to_server,established; http_uri; content:""/be_client_cgi/perr?browser="",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37306; rev:4; )",['T1021']
"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-CNC MultiOS.Malware.GORAT command and control SSL certificate""; flow:to_client,established; ssl_state:server_hello; content:""|16 03 03|"",depth 3; content:""ACME Shell Co.0""; content:""Z"",distance 0; content:""ACME Shell Co.0"",distance 0; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:trojan-activity; sid:56864; rev:1; )",['T1094']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""APP-DETECT Teamviewer installer download attempt""; flow:to_client,established; flowbits:isset,file.exe; content:""T|00|e|00|a|00|m|00|V|00|i|00|e|00|w|00|e|00|r""; content:""www.teamviewer.com"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:policy-violation; sid:24095; rev:4; )",['T1219']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Worm.Luder variant outbound connection""; flow:to_server,established; http_uri; content:""/loader.cpl"",fast_pattern,nocase; pcre:""/\/loader\.cpl$/""; http_header; content:""|3B 20|MSIE|20|""; content:!""|0D 0A|Accept-Language:""; metadata:impact_flag red,ruleset community; service:http; T1196; classtype:trojan-activity; sid:26774; rev:4; )",['T1218']
"alert tcp $HOME_NET any -> any $HTTP_PORTS ( msg:""MALWARE-CNC Rat.Tool.FeyeYelp variant outbound beacon attempt""; flow:to_server,established; http_header; content:""Sec-Fetch-Dest:"",nocase; content:""empty"",within 10,nocase; http_uri; content:""request_origin=user"",fast_pattern,nocase; content:""parent_request_id="",nocase; pcre:""/parent_request_id=[^&\x3B]{128}/i""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56612; rev:1; )",['T1041']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Rootkit.Necurs outbound connection""; flow:to_server,established; http_method; content:""POST""; http_raw_uri; bufferlen:15; http_uri; content:""/docs/index.php"",fast_pattern,nocase; http_header; content:""Content-Type|3A 20|application/octet-stream""; content:!""User-Agent|3A 20|""; content:!""Accept|3A 20|""; content:!""Referer|3A 20|""; metadata:impact_flag red,ruleset community; service:http; T1014; classtype:trojan-activity; sid:31070; rev:4; )",['T1014']
"alert tcp any $HTTP_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner HTTP attack attempt""; flow:to_client,established; file_data; content:""Welcome To Spider Shell!"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:50098; rev:1; )",['T1566']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN installation attempt""; flow:to_server,established; http_header; content:""User-Agent: wget|0D 0A|Host: perr.hola.org"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37298; rev:4; )",['T1021']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-CNC Word.Trojan.Emotet obfuscated powershell""; flow:to_client,established; file_data; flowbits:isset,file.doc|file.xls; content:""powershell"",fast_pattern,nocase; pcre:""/powershell\s*?-e\s*?[A-Za-z0-9+\/=]{20}/i""; metadata:impact_flag red; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:44559; rev:3; )",['T1059']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-PLUGINS CTSWebProxy ActiveX privilege escalation attempt""; flow:to_server,established; flowbits:isset,file.exe; file_data; content:""TSWbPrxy.exe"",fast_pattern,nocase; content:""PSHCMD"",nocase; content:""powershell.exe"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:attempted-admin; sid:47462; rev:2; )",['T1059']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT Hola VPN installation attempt""; flow:to_server,established; http_header; content:""User-Agent: hola_get"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:37299; rev:4; )",['T1021']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Ransomware.Sigma outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:10; http_uri; content:""/email.bin"",fast_pattern,nocase; http_header; content:""User-Agent: Microsoft BITS/"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:46065; rev:2; )",['T1197']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/inetd.conf file access attempt""; flow:to_server,established; http_uri; content:""/etc/inetd.conf"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:43287; rev:3; )",['T1087']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Apple OSX Flashback malware variant outbound connection""; flow:to_server,established; http_uri; content:""/auupdate/"",fast_pattern; http_header; content:""User-Agent|3A|""; base64_decode:relative; base64_data; content:""|7C|i386|7C|10.""; service:http; classtype:trojan-activity; sid:22033; rev:6; )",['T1001']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake Delta Ticket HTTP Response phishing attack""; flow:to_client,established; file_data; content:""PK"",depth 2; content:""DeltaTicket_ET-RM-"",distance 0,nocase; content:"".exe"",distance 0,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:32008; rev:3; )",['T1566']
"alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL SSLv3 heartbeat read overrun attempt""; flow:to_server,established,only_stream; content:""|18 03 00|"",depth 3; detection_filter:track by_src,count 3,seconds 1; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30510; rev:8; )",['T1005']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 4080 ( msg:""SERVER-WEBAPP iChat directory traversal attempt""; flow:to_server,established; content:""/../../""; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1604; rev:12; )",['T1567']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""MALWARE-CNC Win.Trojan.Emotet variant outbound connection attempt""; flow:to_server,established; content:""GET / HTTP/1.1|0D 0A|Cookie: "",depth 24; content:""="",within 6; pcre:""/Cookie: \d{1,5}=[a-zA-Z0-9\x2b\x2f]+=*\r\nUser-Agent:/""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:48402; rev:1; )",['T1041']
"alert udp any any -> any 69 ( msg:""PROTOCOL-TFTP GET passwd""; flow:to_server; content:""|00 01|"",depth 2; content:""passwd"",offset 2,nocase; metadata:policy max-detect-ips drop,ruleset community; classtype:successful-admin; sid:1443; rev:12; )",['T1213']
"alert tcp any any -> any any ( msg:""MALWARE-CNC Unix.Malware.Drovorub cnc inbound connection attempt""; flow:established; content:""{|22|children|22|:[{|22|name|22|:"",fast_pattern,nocase; content:""|81|"",depth 1; content:""|22 2C 22|value|22 3A|"",distance 0,nocase; pcre:""/^\x81.{1,9}\x7b\x22children\x22\x3a\x5b\x7b\x22name\x22\x3a\x22[a-z0-9_\x2e]+\x22\x2c\x22value\x22\x3a\x22[a-z0-9\x2b\x2f]+={0,2}\x22\x7d/ims""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:trojan-activity; sid:54793; rev:1; )",['T1094']
"alert tcp $HOME_NET any -> $HOME_NET [139,445] ( msg:""FILE-OTHER Adobe Acrobat Reader plugin ace.dll dll-load exploit attempt""; flow:to_server,established; content:""a|00|c|00|e|00|.|00|d|00|l|00|l|00|"",fast_pattern,nocase; content:!""|00|a|00|c|00|e|00|.|00|d|00|l|00|l|00|"",nocase; service:netbios-ssn; classtype:attempted-user; sid:18434; rev:13; )",['T1574']
"alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:""PROTOCOL-TFTP Get""; flow:to_server; content:""|00 01|"",depth 2; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:1444; rev:10; )",['T1213']
"alert tcp any any -> $HOME_NET 445 ( msg:""OS-WINDOWS Microsoft Windows SMB anonymous session IPC share access attempt""; flow:to_server,established; flowbits:isset,smb.null_session; content:""|FF|SMB|75 00 00 00 00|"",depth 9,offset 4; content:""|00 5C 00|I|00|P|00|C|00|$|00 00 00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; T1077; classtype:attempted-recon; sid:42340; rev:4; )",['T1189']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Internet Explorer WMI ASDI Extension ActiveX object access""; flow:to_client,established; file_data; content:""F0975AFE-5C7F-11D2-8B74-00104B2AFB41"",fast_pattern,nocase; pcre:""/<OBJECT\s+[^>]*classid\s*=\s*[\x22\x27]?\s*clsid\s*\x3a\s*\x7B?\s*F0975AFE-5C7F-11D2-8B74-00104B2AFB41/is""; service:http; classtype:attempted-user; sid:4236; rev:16; )",['T1047']
"alert tcp $EXTERNAL_NET 6666:7000 -> $HOME_NET any ( msg:""MALWARE-CNC Win.Trojan.Insomnia variant inbound connection - post infection""; flow:to_client,established; content:""Asdf1|17|0"",depth 500; content:""irc.bhfirc.net"",within 50; service:ssl; classtype:trojan-activity; sid:22053; rev:4; )",['T1571']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zacinlo outbound connection""; flow:to_server,established; http_uri; content:""/entry/exe/runinfo"",fast_pattern,nocase; content:""&mac=""; http_header; content:""User-Agent: wget""; content:""Referer:""; content:""/entry/"",within 50; content:!""Accept-""; content:!""Content-""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:49790; rev:1; )",['T1043']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC PowerShell Empire variant outbound connection""; flow:to_server,established; content:""HTTP/1.1|0D 0A|Cookie: SESSION"",fast_pattern,nocase; http_cookie; pcre:""/^session(id)?=[a-z0-9\x2b\x2f]{27}=$/im""; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:trojan-activity; sid:44564; rev:5; )",['T1059']
"alert tcp $HOME_NET [21,25,443,465,636,992,993,995,2484] -> $EXTERNAL_NET any ( msg:""SERVER-OTHER OpenSSL TLSv1 large heartbeat response - possible ssl heartbleed attempt""; flow:to_client,established; content:""|17 03 01|""; byte_jump:2,0,relative; content:""|18 03 01|"",within 3,fast_pattern; byte_test:2,>,128,0,relative; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30780; rev:4; )",['T1123']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-OTHER Sony rootkit runtime detection""; flow:to_server,established; http_header; content:""User-Agent|3A|"",nocase; content:""SecureNet"",fast_pattern,nocase; pkt_data; content:""Xtra"",distance 0,nocase; http_header; pcre:""/^User-Agent\x3A[^\r\n]*SecureNet\s+Xtra/ims""; pcre:""/^Host\x3A[^\r\n]*sonymusic\x2Ecom/ims""; service:http; classtype:misc-activity; sid:6365; rev:11; )",['T1014']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_server,established; file_data; content:""msiexec|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?msiexec\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:47845; rev:3; )",['T1559']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP PHPmyadmin brute force login attempt - User-Agent User-Agent""; flow:to_server,established,only_stream; http_header; content:""User-Agent: User-Agent: Mozilla/4.0"",fast_pattern,nocase; http_uri; content:""/phpmyadmin/index.php?lang=en&server=1&pma_username=root"",nocase; detection_filter:track by_src,count 30,seconds 4; metadata:impact_flag red,policy max-detect-ips drop; service:http; classtype:trojan-activity; sid:25907; rev:6; )",['T1110']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE malicious file download attempt""; flow:to_server,established; http_uri; content:""|2F 70 6F 63|""; pcre:""/\x2f\x70\x6f\x63(\d*|\x5f[\x61-\x7a]+)\x2e(\x68\x74\x6d\x6c|\x78(\x6c\x73|\x73\x6c|\x6d\x6c)|\x6a(\x73|\x61\x76a)|\x61\x73\x70|\x70(\x64f|\x70\x74|\x48\x70|\x73\x64)|\x66\x6c\x76|\x73\x77\x66|\x64\x6fc|\x74\x74\x66|\x62\x6d\x70|\x6d(\x70\x33|\x33\x75))/i""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:misc-activity; sid:37963; rev:3; )",['T1192']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-FIREFOX Mozilla download directory file deletion attempt""; flow:to_server,established; file_data; content:""<a href=|22|data:application/octet-stream,hello|22|>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:smtp; classtype:attempted-user; sid:45174; rev:3; )",['T1070']
"alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg:""PROTOCOL-ICMP Unusual PING detected""; icode:0; itype:8; fragbits:!M; content:!""ABCDEFGHIJKLMNOPQRSTUVWABCDEFGHI"",depth 32; content:!""0123456789abcdefghijklmnopqrstuv"",depth 32; content:!""EEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE"",depth 36; content:!""WANG2""; content:!""cacti-monitoring-system"",depth 65; content:!""SolarWinds"",depth 72; metadata:policy max-detect-ips drop,ruleset community; classtype:successful-recon-limited; sid:29456; rev:3; )",['T1040']
"alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:""PROTOCOL-RPC portmap SET attempt UDP 111""; flow:to_server; content:""|00 01 86 A0|"",depth 4,offset 12; content:""|00 00 00 01|"",within 4,distance 4; content:""|00 00 00 00|"",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1950; rev:13; )",['T1040']
"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP PING Unix""; itype:8; content:""|10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F|"",depth 32; metadata:ruleset community; classtype:misc-activity; sid:366; rev:11; )",['T1018']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 443 ( msg:""MALWARE-OTHER GHBkdr TLS Change Cipher spoof runtime detection""; flow:to_server,established; content:""|14 03 02 00 01 01 16 03 02 00 40 9D 6D CF 97 6A A0 67 DE 89 7C D1 E4 E3 DB 85 84 BB DF 54 7D 86 D3 C6 C8 99 F6 05 BA 5B 41 DD 9E 9F E6 6E 49 38 9A 3D 50 DD 2E 9C 61 56 6E 4C 9F CF B9 57 EE 80 E8 57 77 F4 F2 47 11 B8 82 B0 D7|"",fast_pattern,nocase; metadata:impact_flag red,policy max-detect-ips drop,policy security-ips drop; classtype:trojan-activity; sid:44474; rev:4; )",['T1195']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP robots.txt access""; flow:to_server,established; http_uri; content:""/robots.txt"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:web-application-activity; sid:1852; rev:11; )",['T1593']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Alureon - Malicious IFRAME load attempt""; flow:to_client,established; file_data; content:""name=|5C 22|Twitter|5C 22| scrolling=|5C 22|auto|5C 22| frameborder=|5C 22|no|5C 22| align=|5C 22|center|5C 22| height = |5C 22|1px|5C 22| width = |5C 22|1px|5C 22|>"",fast_pattern,nocase; metadata:policy balanced-ips alert,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1102; classtype:trojan-activity; sid:22061; rev:8; )",['T1102']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""EXPLOIT-KIT Hello/LightsOut exploit kit payload download attempt""; flow:to_server,established; http_uri; content:"".php?a=dw"",fast_pattern,nocase; pcre:""/\?a=dw[a-z]$/""; http_header; content:"" Java/1.""; flowbits:set,file.exploit_kit.pe; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1189; classtype:trojan-activity; sid:30003; rev:6; )",['T1189']
"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP PING Windows""; itype:8; content:""abcdefghijklmnop"",depth 16; metadata:ruleset community; classtype:misc-activity; sid:382; rev:11; )",['T1082']
"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP PING""; icode:0; itype:8; metadata:ruleset community; classtype:misc-activity; sid:384; rev:8; )",['T1082']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 25 ( msg:""MALWARE-OTHER Executable control panel file attachment detected""; flow:to_server,established; content:"".cpl"",fast_pattern,nocase; content:""Content-Disposition: attachment|3B|""; content:""filename="",nocase; pcre:""/filename=[\x22\x27]?[^\n]*\x2ecpl[\x22\x27\s]/is""; metadata:policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:misc-activity; sid:33940; rev:3; )",['T1218']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Fake delivery information phishing attack""; flow:to_client,established; http_header; content:""|3B| filename=""; content:""Delivery_Information_ID-"",fast_pattern,nocase; file_data; content:""Delivery_Information_ID-""; content:"".exe"",within 50; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1192; classtype:trojan-activity; sid:26660; rev:3; )",['T1566']
"alert ssl ( msg:""SERVER-OTHER OpenSSL x509 crafted email address buffer overflow attempt""; flow:established; content:""|06 03 55 1D 1E|""; ber_skip:0x01,optional; ber_data:0x04; ber_data:0x30; ber_data:0xa1; ber_data:0x30; content:""|81 82|"",within 2; byte_test:2,>,500,0,relative; content:""xn--"",within 4,distance 2,fast_pattern; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; classtype:attempted-user; gid:1; sid:300306; rev:3; )",['T1189']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.CSBundle_Original stager outbound connection attempt""; flow:to_server,established; http_header; content:""Accept: */*""; content:""Accept-Language: en-US""; content:""Accept-Encoding: gzip, deflate""; http_cookie; content:""Cookie: SIDCC=AN0-TYutOSq-fxZK6e4kagm70VyKACiG1susXcYRuxK08Y-rHysliq0LWklTqjtulAhQOPH8uA""; http_uri; content:""/api/v1/user""; metadata:impact_flag red,policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56599; rev:1; )",['T1043']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-TOOLS Win.Tool.Delete variant download detected""; flow:to_server,established; file_data; content:""/|00|q|00 20 00|&|00|&|00 20 00|s|00|h|00|u|00|t|00|d|00|o|00|w|00|n|00 20 00|/|00|r|00 20 00|/|00|f|00 20 00|/|00|t|00 20 00|0|00|0|00|"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:attempted-user; sid:48502; rev:2; )",['T1070']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Pdf.Phishing.Agent variant outbound connection detected""; flow:to_server,established; http_uri; content:""/cache/dropbox1/dropbox/"",fast_pattern,nocase; pkt_data; content:""//cache/dropbox1/dropbox/"",nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:45483; rev:3; )",['T1102']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_client_body; content:""=@eval(get_magic_quotes_gpc()?stripslashes($_POST["",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:42836; rev:5; )","['T1505', 'T1219']"
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Js.Trojan.Agent variant outbound connection""; flow:to_server,established; http_header; content:""User-Agent|3A| xmsSofts_1.0.0_"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:48818; rev:2; )",['T1043']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 55443 ( msg:""SERVER-WEBAPP McAfee Virus Scan Linux authentication token brute force attempt""; flow:to_server,established,no_stream; content:""/0409/nails"",fast_pattern,nocase; content:""Cookie|3A| nailsSessionId="",nocase; content:""pg=proxy"",nocase; content:""&tplt="",distance 0,nocase; detection_filter:track by_src,count 25,seconds 5; metadata:policy max-detect-ips drop; service:http; classtype:web-application-attack; sid:41920; rev:4; )",['T1110']
"alert tcp $EXTERNAL_NET [110,143] -> $HOME_NET any ( msg:""MALWARE-OTHER Executable control panel file attachment detected""; flow:to_client,established; content:"".cpl"",fast_pattern,nocase; content:""Content-Disposition: attachment|3B|""; content:""filename="",nocase; pcre:""/filename=[\x22\x27]?[^\n]*\x2ecpl[\x22\x27\s]/is""; metadata:policy max-detect-ips drop,policy security-ips drop; service:imap,pop3; classtype:misc-activity; sid:33939; rev:3; )",['T1218']
"alert tcp $EXTERNAL_NET any -> $HOME_NET [543,544,754] ( msg:""SERVER-OTHER MIT Kerberos 5 krb5_read_message denial of service attempt""; flow:to_server,established; content:""KRB5_SENDAUTH_V1.0""; content:""|00 00 00 00 00|"",within 5,distance -24; metadata:policy max-detect-ips drop; service:kerberos; classtype:attempted-dos; sid:34709; rev:4; )",['T1550']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI Administrator Tools Object Viewer ActiveX function call access""; flow:to_client,established; file_data; content:""ReleaseContext"",fast_pattern,nocase; pcre:""/(?P<c>\w+)\s*=\s*(\x22ReleaseContext(\.\d)?\x22|\x27ReleaseContext(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22ReleaseContext(\.\d)?\x22|\x27ReleaseContext(\.\d)?\x27)\s*\)/Oims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18329; rev:14; )",['T1047']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""BROWSER-IE Microsoft Internet Explorer 11 VBScript execution policy bypass attempt""; flow:to_client,established; file_data; content:""ex = xml.transformNode(xsl)|3B 20|document.getElementById"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:48531; rev:2; )",['T1220']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""APP-DETECT TeamViewer remote administration tool outbound connection attempt""; flow:to_server,established; http_uri; content:""client=DynGate"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:34463; rev:5; )",['T1219']
"alert tcp $EXTERNAL_NET 113 -> $SMTP_SERVERS 25 ( msg:""SERVER-MAIL Sendmail 8.6.9 exploit""; flow:to_server,established; content:""|0A|D/""; metadata:ruleset community; service:smtp; classtype:attempted-admin; sid:655; rev:16; )",['T1068']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""BROWSER-IE Microsoft Internet Explorer XML digital signature transformation of digest value""; flow:to_server,established; flowbits:isset,file.xml; file_data; content:""<CanonicalizationMethod"",fast_pattern; content:""<xsl"",distance 0; pcre:""/[^>]*\x26lt\x3bCanonicalizationMethod[^>]*\x26lt\x3bDigestValue\x26gt\x3b(?P<DV>[^\x26]+).*[^\x2f]DigestValue>(?!P=DV)/Rms""; metadata:policy max-detect-ips drop; service:smtp; classtype:misc-activity; sid:26640; rev:7; )",['T1220']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Zeus encrypted POST Data exfiltration""; flow:to_server,established; http_header; content:""Accept-Encoding|3A| identity, *|3B|q=0|0D 0A|"",fast_pattern,nocase; content:""|3B| MSIE ""; http_client_body; pcre:""/[^ -~\r\n]{4}/""; metadata:impact_flag red,ruleset community; service:http; T1020; classtype:trojan-activity; sid:27919; rev:5; )","['T1020', 'T1071']"
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""FromBase64String""; content:""z"",within 200,nocase; pcre:""/z\d{1,3}/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:28323; rev:8; )","['T1505', 'T1219']"
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""OS-WINDOWS Microsoft Windows Content-Disposition CLSID command attempt""; flow:to_client,established; http_header; content:""Content-Disposition|3A|"",nocase; content:""{3050F3D9-98B5-11CF-BB82-00AA00BDCE0B}""; content:""%2e"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58616; rev:1; )",['T1203']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP Ektron ServerControlWS.asmx XSL transform code injection attempt""; flow:to_server,established; http_uri; content:""/WorkArea/ServerControlWS.asmx"",fast_pattern,nocase; http_client_body; content:""<msxsl:script"",nocase; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:40493; rev:3; )",['T1220']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-FIREFOX Mozilla Firefox 3 xsl parsing heap overflow attempt""; flow:to_client,established; file_data; content:""<xsl|3A|key name=|22|poc|22| match=|22|nodeB|22| use=|22|does_not_exist|28 29 22|/>"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:17444; rev:12; )",['T1220']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 12401 ( msg:""SERVER-WEBAPP Schneider Electric IGSS dashboard deletion attempt""; flow:to_server,established; content:""|01 00 34 12 0D 00 00 00 00 00 00 00|"",depth 12,offset 2,fast_pattern; content:""|04|"",within 1,distance 4; content:""DASH"",distance 3,nocase; metadata:policy max-detect-ips drop; classtype:web-application-attack; sid:43113; rev:3; )",['T1070']
"alert tcp $EXTERNAL_NET 443 -> $HOME_NET any ( msg:""MALWARE-CNC Win.Backdoor.Upatre SSL Cert inbound""; flow:to_client,established; content:""|55 04 03|""; content:""|23|server.itiltrainingcertworkshop.com"",within 36,distance 1; service:ssl; classtype:trojan-activity; sid:32001; rev:4; )",['T1571']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER Arcserve Unified Data Protection Management credential disclosure attempt""; flow:to_server,established; http_uri; content:""/services/EdgeServiceImpl"",fast_pattern,nocase; http_client_body; content:""getBackupPolicies"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:policy-violation; sid:57532; rev:1; )",['T1003']
"alert udp $HOME_NET any -> $EXTERNAL_NET 53 ( msg:""MALWARE-CNC Win.Trojan.Bledoor TCP tunnel in UDP""; flow:to_server; content:""|08 00 45|"",depth 3,offset 12; content:""|00 00|"",within 2,distance 5; content:""|06|"",within 1,distance 1; content:""|00 00 00 00|"",within 4,distance 18; metadata:impact_flag red,policy max-detect-ips drop; service:dns; classtype:trojan-activity; sid:24087; rev:6; )",['T1048']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Sweeper variant dropper initial download attempt""; flow:to_server,established; http_method; content:""HEAD""; pkt_data; content:"".bin"",fast_pattern,nocase; http_header; content:""User-Agent|3A 20|Microsoft BITS""; pkt_data; content:""Accept-Encoding|3A 20|identity|0D 0A|""; http_header; content:!""Content-Length""; http_uri; pcre:""/\/[a-f0-9]{32}\/\w+\.bin/""; metadata:impact_flag red,ruleset community; service:http; T1197; classtype:trojan-activity; sid:38565; rev:3; )",['T1197']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-WEBAPP WordPress arbitrary file deletion attempt""; flow:to_server,established; http_uri; content:""/wp-admin/admin.php""; content:""page=wc.status"",fast_pattern,nocase; content:""handle="",nocase; content:""../""; pcre:""/[?&]handle=[^&]*?\x2e\x2e\x2f/i""; metadata:policy max-detect-ips drop,policy security-ips drop; service:http; classtype:web-application-attack; sid:48573; rev:2; )",['T1070']
"alert ip $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE id check returned userid""; content:""uid="",nocase; content:"" gid="",distance 0; pcre:""/uid=\d{1,5}\S+\s+gid=\d{1,5}/ims""; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:1882; rev:20; )",['T1166']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""BROWSER-IE Microsoft Internet Explorer 8 ieshims.dll dll-load exploit attempt""; flow:to_server,established; http_uri; content:""|2F|ieshims.dll"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:19171; rev:12; )",['T1574']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 1723 ( msg:""POLICY-OTHER PPTP Start Control Request attempt""; flow:to_server,established,no_stream; content:""|00 01|"",depth 2,offset 2; content:""|00 01|"",depth 2,offset 8; metadata:ruleset community; classtype:attempted-admin; sid:2044; rev:8; )",['T1595']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP Domino webadmin.nsf access""; flow:to_server,established; http_uri; content:""/webadmin.nsf"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:attempted-recon; sid:1579; rev:16; )",['T1133']
" alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC User-Agent known malicious user agent - EMERY - Win.Trojan.W97M""; flow:to_server,established; http_header; content:""User-Agent|3A 20|EMERY|0D 0A|"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; sid:34843; rev:3; )",['T1133']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Doc.Downloader.Agent file download attempt""; flow:to_server,established; http_uri; content:""/fr/mso/onedrive"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:40450; rev:3; )",['T1102']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC SambaCry ransomware download attempt""; flow:to_server,established; content:""/kelly6666/lo.txt"",fast_pattern,nocase; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:45469; rev:3; )",['T1571']
"alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_server,established; file_data; content:""cmd|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?cmd\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:smtp; classtype:trojan-activity; sid:47849; rev:3; )",['T1559']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER HP Web JetAdmin file write attempt""; flow:to_server,established; http_uri; content:""/plugins/framework/script/tree.xms"",fast_pattern,nocase; http_client_body; content:""WriteToFile"",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:2549; rev:7; )",['T1106']
"alert tcp $HOME_NET any -> $EXTERNAL_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.2 heartbeat read overrun attempt - vulnerable client response""; flow:to_server,established,only_stream; content:""|18 03 03|"",depth 3; byte_test:2,>,128,3; detection_filter:track by_dst,count 2,seconds 5; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30523; rev:9; )",['T1005']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""%32%37%34%35%45%35%46%35%2d%44%32%33%34%2d%31%31%44%30%2d%38%34%37%41%2d%30%30%43%30%34%46%44%37%42%42%30%38"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:28349; rev:7; )",['T1047']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC URI request for known malicious URI - base64 encoded""; flow:to_server,established; http_uri; content:""Y2xrPTQu"",fast_pattern,nocase; pkt_data; content:""GET /"",depth 5; isdataat:100,relative; content:!"" "",within 100; base64_decode:relative; base64_data; content:""clk=""; content:""&bid="",distance 0; content:""&aid="",within 5,distance 40; content:""&sid="",distance 0; content:""&rd="",distance 0; content:""&x86="",distance 0; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:24243; rev:3; )",['T1001']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""BROWSER-IE Microsoft Internet Explorer protected mode atlthunk.dll dll-load exploit attempt""; flow:to_server,established; http_uri; content:""|2F|atlthunk.dll"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:35215; rev:3; )",['T1574']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_client,established; file_data; content:""msiexec|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?msiexec\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:47848; rev:3; )",['T1559']
"alert http ( msg:""MALWARE-CNC HttpBrowser User-Agent outbound communication attmept""; flow:to_server,established; http_header:field user-agent; content:""HttpBrowser/1.0"",fast_pattern,nocase; metadata:impact_flag red,ruleset community; service:http; classtype:trojan-activity; gid:1; sid:42886; rev:4; )",['T1219']
"alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:""PROTOCOL-TFTP root directory""; flow:to_server; content:""|00 01|/"",depth 3; metadata:policy max-detect-ips drop,ruleset community; classtype:bad-unknown; sid:520; rev:13; )",['T1213']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP weblogic/tomcat .jsp view source attempt""; flow:to_server,established; http_uri; content:"".jsp"",nocase; pkt_data; pcre:!""/^\w+\s+[^\n\s\?]*\.jsp/ims""; metadata:ruleset community; service:http; classtype:web-application-attack; sid:1054; rev:14; )",['T1518']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-OTHER Microsoft Frontpage /_vti_bin/ access""; flow:to_server,established; http_uri; content:""/_vti_bin/"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:1288; rev:18; )",['T1119']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Oddjob outbound connection""; flow:to_server,established; http_raw_uri; bufferlen:80<=>120; http_method; content:""HEAD""; http_header; content:""User-Agent: Microsoft BITS"",fast_pattern,nocase; content:""Accept-Encoding: identity"",nocase; http_uri; pcre:""/\x2f[A-Z0-9\x3d\x2d\x2b\x2e\x20]{80,120}\x20/i""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:42395; rev:3; )",['T1197']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:7000 ( msg:""MALWARE-CNC Linux.Backdoor.Tsunami outbound connection""; flow:to_server,established; content:""NICK"",depth 4; content:""USER"",within 4,distance 11; content:""|3A|raft"",within 5,distance 31; metadata:impact_flag red; service:irc; classtype:trojan-activity; sid:28399; rev:5; )",['T1571']
"alert udp $EXTERNAL_NET any -> $HOME_NET 111 ( msg:""PROTOCOL-RPC portmap listing UDP 111""; flow:to_server; content:""|00 01 86 A0|"",depth 4,offset 12; content:""|00 00 00 04|"",within 4,distance 4; content:""|00 00 00 00|"",depth 4,offset 4; metadata:policy max-detect-ips drop,ruleset community; service:sunrpc; classtype:rpc-portmap-decode; sid:1280; rev:18; )",['T1592']
"alert tcp $HOME_NET any -> $EXTERNAL_NET 6666:6667 ( msg:""MALWARE-CNC Win.Trojan.IRCBrute.I variant outbound connection""; flow:to_server,established; flowbits:isset,trojan.ircbrute_i; content:""JOIN|20 23 23|"",depth 7,nocase; content:""|23 23|"",within 8,distance 2; pcre:""/^JOIN\s\x23\x23\S{2,6}\x23\x23\s?\x0D\x0A/im""; classtype:trojan-activity; sid:19037; rev:8; )",['T1571']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""2745E5F5-D234-11D0-847A-00C04FD7BB08"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18241; rev:17; )",['T1047']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""INDICATOR-COMPROMISE Revil Kaseya ransomware log clearing http upload""; flow:to_server,established; file_data; content:""Server.CreateObject""; content:""KComWExec.execCmd"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:57879; rev:2; )",['T1485']
"alert tcp any $FILE_DATA_PORTS -> any any ( msg:""INDICATOR-COMPROMISE Responder poisoner toolkit download attempt""; flow:to_client,established; file_data; content:""Responder.py"",fast_pattern,nocase; content:""Responder.conf"",nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:misc-attack; sid:50096; rev:1; )",['T1072']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:""SERVER-OTHER OpenSSL Heartbleed masscan access exploitation attempt""; flow:to_server,established; content:""[masscan/1.0]""; metadata:policy balanced-ips drop,policy connectivity-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30549; rev:2; )",['T1005']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""OS-WINDOWS Microsoft Windows Content-Disposition CLSID command attempt""; flow:to_client,established; http_header; content:""Content-Disposition|3A|"",nocase; content:""{25336920-03f9-11cf-8fd0-00aa00686f13}""; content:""%2e"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58615; rev:1; )",['T1203']
"alert tcp $HOME_NET $FILE_DATA_PORTS -> $EXTERNAL_NET any ( msg:""SERVER-WEBAPP /etc/passwd file access attempt""; flow:to_client,established; file_data; content:""root:x:0:0:root:/root:/"",fast_pattern,nocase; content:!""html""; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-admin; sid:31289; rev:5; )",['T1087']
"alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:""MALWARE-CNC DNS Fast Flux attempt""; flow:to_client; content:""|00 01|"",depth 2,offset 4; byte_test:2,>,1,0,relative; byte_test:1,=,1,2,bitmask 0x80; content:""|00 01 00 01|"",distance 6; content:""|00 01 00 01 00 00 00 05|"",distance 0; metadata:policy max-detect-ips drop; service:dns; classtype:trojan-activity; sid:57756; rev:2; )",['T1568']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI Administrator Tools Object Viewer ActiveX function call access""; flow:to_client,established; file_data; content:""AddContextRef"",fast_pattern,nocase; pcre:""/(?P<c>\w+)\s*=\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\x3b.*(?P<v>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(?P=c)\s*\)|(?P<n>\w+)\s*=\s*new\s*ActiveXObject\s*\(\s*(\x22AddContextRef(\.\d)?\x22|\x27AddContextRef(\.\d)?\x27)\s*\)/Oims""; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18242; rev:15; )",['T1047']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Houdini backdoor file download request""; flow:to_server,established; http_uri; content:""/ChromeSetup.bat"",fast_pattern,nocase; pkt_data; content:""User-Agent|3A| Microsoft BITS""; metadata:impact_flag red,ruleset community; service:http; T1197; classtype:trojan-activity; sid:41712; rev:3; )",['T1197']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:""OS-WINDOWS Microsoft Windows empty RDP cookie negotiation attempt""; flow:to_server,established; content:""|08 E0 00 00 00 00|"",depth 6,offset 4; content:""|0D 0A|"",within 2,distance 1; isdataat:!1,relative; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:rdp; classtype:policy-violation; sid:42255; rev:4; )",['T1482']
"alert tcp any any -> any any ( msg:""INDICATOR-COMPROMISE undocumented SMB dialect request attempt""; flow:established; content:""|02|Cairo 0.xa"",fast_pattern,nocase; content:""|FF|SMB|72|"",depth 5,offset 4; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50517; rev:1; )",['T1046']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP redirect access""; flow:to_server,established; http_uri; content:""/redirect"",fast_pattern,nocase; metadata:ruleset community; service:http; classtype:attempted-recon; sid:895; rev:19; )",['T1154']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE Microsoft Windows ntds.dit file exfiltration attempt""; flow:established; flowbits:isset,file.ese; file_data; content:""|01|N|00|t|00|-|00|P|00|w|00|d|00|-|00|H|00|i|00|s|00|t|00|o|00|r|00|y|00|"",fast_pattern,nocase; content:""|01|n|00|t|00|P|00|w|00|d|00|H|00|i|00|s|00|t|00|o|00|r|00|y|00|""; isdataat:10000; metadata:policy max-detect-ips drop,policy security-ips drop; classtype:misc-activity; gid:1; sid:61893; rev:2; )",['T1003']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 1707 ( msg:""SERVER-OTHER Sage SalesLogix database credential disclosure attempt""; flow:to_server,established; content:""|00 00 00 00 00 00 00 00 00 00|"",depth 10; content:""|00 00 00|"",within 3,distance 1; content:""GetConnection|00|"",fast_pattern,nocase; metadata:policy max-detect-ips drop; classtype:attempted-admin; sid:20618; rev:6; )",['T1003']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""OS-WINDOWS Microsoft Windows Content-Disposition CLSID command attempt""; flow:to_client,established; http_header; content:""Content-Disposition|3A|"",nocase; content:""{48123bc4-99d9-11d1-a6b3-00c04fd91555}""; content:""%2e"",within 50,nocase; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; classtype:attempted-user; sid:58617; rev:1; )",['T1203']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Sweeper variant dropper download attempt""; flow:to_server,established; content:"".bin"",fast_pattern,nocase; http_header; content:""User-Agent|3A 20|Microsoft BITS""; pkt_data; content:""Accept-Encoding|3A 20|identity|0D 0A|""; http_header; content:""If-Unmodified-Since""; content:""Range""; http_uri; pcre:""/\/[a-f0-9]{32}\/\w+\.bin/""; metadata:impact_flag red,ruleset community; service:http; T1197; classtype:trojan-activity; sid:38566; rev:3; )",['T1197']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER HP Web JetAdmin file write attempt""; flow:to_server,established; http_uri; content:""/plugins/framework/script/tree.xms"",fast_pattern,nocase; content:""WriteToFile"",nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:57067; rev:1; )",['T1106']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""FILE-OTHER WinRAR ACE remote code execution attempt""; flow:to_client,established; file_data; content:""**ACE**"",depth 7,offset 7; pcre:""/(?:[a-z]:\x5C?){2}/i""; metadata:policy max-detect-ips drop; service:ftp-data,http,imap,pop3; classtype:attempted-user; sid:49291; rev:4; )",['T1547']
"alert tcp $HOME_NET any -> any $HTTP_PORTS ( msg:""MALWARE-CNC Rat.Tool.FeyeYelp variant outbound beacon attempt""; flow:to_server,established; content:""_gat_global=1"",fast_pattern,nocase; http_cookie; content:""_gat_global=1"",nocase; content:""recent_locations"",nocase; content:""_gat_www=1"",nocase; content:""bse="",nocase; pcre:""/bse=[^&\x3B]{128}/i""; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:trojan-activity; sid:56613; rev:1; )",['T1041']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""NDVFNUY1LUQyMzQtMTFEMC04NDdBLTAwQzA0RkQ3QkIwOC"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:28350; rev:7; )",['T1047']
"alert tcp any any -> any 445 ( msg:""INDICATOR-COMPROMISE Responder poisoner NetServer enumeration attempt""; flow:to_server,established; content:""B16BBDz|00 01 00 FF FF 00 00 00 80|""; content:""|00|ABCD|00|"",within 200; isdataat:!0,relative; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; classtype:misc-attack; sid:50464; rev:1; )",['T1046']
"alert tcp any any -> $HOME_NET $HTTP_PORTS ( msg:""POLICY-OTHER Active Directory Federation Services policy store transfer service request detected""; flow:to_server,established; http_uri; content:""/adfs/services/policystoretransfer"",fast_pattern,nocase; http_method; content:""POST"",nocase; metadata:ruleset community; service:http; classtype:misc-activity; sid:57738; rev:1; )",['T1082']
"alert tcp $HOME_NET any -> $EXTERNAL_NET ![20,21] ( msg:""INDICATOR-OBFUSCATION FTP file upload over non-standard port attempt""; flow:to_server,established; content:""STOR "",depth 5; metadata:policy max-detect-ips drop; classtype:misc-activity; sid:47402; rev:2; )",['T1048']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-OTHER Win.Downloader.DDECmdExec variant download""; flow:to_client,established; file_data; content:""cmd|7C 27|"",nocase; content:""|27 21|"",within 250; pcre:""/[=+-@](\w+\x28)?cmd\x7C\x27[^\x27]+\x27\x21\w+/i""; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:47844; rev:3; )",['T1559']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""FILE-PDF Adobe Acrobat Reader plugin agm.dll dll-load exploit attempt""; flow:to_server,established; http_uri; content:""|2F|agm.dll"",nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:18440; rev:13; )",['T1574']
"alert tcp $EXTERNAL_NET any -> $HOME_NET [21,25,443,465,636,992,993,995,2484] ( msg:""SERVER-OTHER OpenSSL TLSv1.1 heartbeat read overrun attempt""; flow:to_server,established; content:""|18 03 02 00 03 01 40 00|"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ssl; classtype:attempted-recon; sid:30524; rev:5; )",['T1005']
"alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:""BROWSER-PLUGINS Microsoft Windows WMI administrator tools object viewer ActiveX clsid access""; flow:to_client,established; file_data; content:""NzQ1RTVGNS1EMjM0LTExRDAtODQ3QS0wMEMwNEZEN0JCMD"",fast_pattern,nocase; metadata:policy max-detect-ips drop; service:http; classtype:attempted-user; sid:28351; rev:7; )",['T1047']
"alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:""INDICATOR-COMPROMISE directory listing""; flow:established; content:""Volume Serial Number""; metadata:ruleset community; classtype:bad-unknown; sid:1292; rev:12; )",['T1592']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Apple OSX Flashback malware variant outbound connection""; flow:to_server,established; http_uri; content:""/auupdate/"",fast_pattern; http_header; content:""User-Agent|3A|""; base64_decode:relative; base64_data; content:""|7C|x86_64|7C|10.""; service:http; classtype:trojan-activity; sid:22034; rev:6; )",['T1001']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP /etc/passwd file access attempt""; flow:to_server,established; http_uri; content:""/etc/passwd"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; T1087; classtype:attempted-recon; sid:1122; rev:16; )",['T1087']
"alert tcp any any -> $HOME_NET 445 ( msg:""MALWARE-CNC Win.Trojan.Doublepulsar variant process injection command""; flow:to_server,established; content:""|FF|SMB|32 00 00 00 00|"",depth 9,offset 4; content:""|42 00|"",within 2,distance 21; content:""|0E 00|"",within 2,distance 29; content:!""|00 00|"",within 2; flowbits:set,smb.trans2.mid66; metadata:impact_flag red,ruleset community; service:netbios-ssn; T1055; classtype:trojan-activity; sid:42331; rev:5; )","['T1189', 'T1055']"
"alert tcp $EXTERNAL_NET any -> $HOME_NET 22 ( msg:""INDICATOR-SCAN SSH brute force login attempt""; flow:to_server,established; content:""SSH-"",depth 4; detection_filter:track by_src,count 5,seconds 60; metadata:policy max-detect-ips drop; service:ssh; classtype:misc-activity; gid:1; sid:19559; rev:16; )",['T1018']
"alert icmp $EXTERNAL_NET any -> $HOME_NET any ( msg:""PROTOCOL-ICMP Echo Reply""; icode:0; itype:0; metadata:ruleset community; classtype:misc-activity; sid:408; rev:8; )",['T1018']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .htpasswd access attempt""; flow:to_server,established; http_uri; content:"".htpasswd"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-attack; sid:1071; rev:15; )",['T1081']
"alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:""SERVER-WEBAPP .bash_history access""; flow:to_server,established; http_uri; content:""/.bash_history""; metadata:ruleset community; service:http; T1139; classtype:web-application-attack; sid:1434; rev:15; )",['T1552']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC URI request for known malicious URI - base64 encoded""; flow:to_server,established; content:""GET http|3A 2F 2F|"",depth 11; base64_decode:relative; base64_data; content:""clk=""; content:""&bid="",distance 0; content:""&aid="",within 5,distance 40; content:""&sid="",distance 0; content:""&rd="",distance 0; content:""&x86="",distance 0; metadata:impact_flag red,ruleset community; service:http; T1001; T1132; classtype:trojan-activity; sid:21442; rev:6; )",['T1001']
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""=Execute"",nocase; content:""On+Error+Resume+Next:"",fast_pattern,nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:27968; rev:7; )","['T1505', 'T1219']"
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Backdoor.Chopper web shell connection""; flow:to_server,established; http_header; content:""X-Forwarded-For"",nocase; http_client_body; content:""=Response"",nocase; content:""FromBase64String"",nocase; metadata:impact_flag red,policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop,ruleset community; service:http; T1100; classtype:trojan-activity; sid:27966; rev:7; )","['T1505', 'T1219']"
"alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:""SERVER-OTHER HP Web JetAdmin setinfo access attempt""; flow:to_server,established; http_uri; content:""/plugins/hpjdwm/script/test/setinfo.hts"",fast_pattern,nocase; metadata:policy max-detect-ips drop,ruleset community; service:http; classtype:web-application-activity; sid:2548; rev:10; )",['T1531']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""BROWSER-IE Microsoft Internet Explorer mapi32x.dll dll-load exploit attempt""; flow:to_server,established; http_uri; content:""/mapi32x.dll"",fast_pattern,nocase; metadata:policy balanced-ips drop,policy max-detect-ips drop,policy security-ips drop; service:http; classtype:attempted-user; sid:37257; rev:3; )",['T1574']
"alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any ( msg:""MALWARE-BACKDOOR MultiOS.Malware.GORAT malware download attempt""; flow:to_client,established; file_data; content:""aqlKZ7wjzg0iKM00E1WB/jq9_RA46w91EKl9A02Dv/nbNdZiLsB1ci8Ph0fb64/9Ks1YxAE86iz9A0dUiDl""; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:ftp-data,http,imap,pop3; classtype:trojan-activity; sid:56594; rev:1; )",['T1050']
"alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:""OS-WINDOWS Microsoft Windows Server 2003 smart card authentication buffer overflow attempt""; flow:to_server,established; content:""|03 00|""; content:""|02 F0|"",distance 0; content:""|64|"",distance 0; content:""|72 44 43 49|""; byte_extract:4,12,msg_size,relative,little; content:""|DC 90 01 08|"",within msg_size,fast_pattern; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:rdp; classtype:attempted-admin; sid:59502; rev:1; )",['T1569']
"alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:""MALWARE-CNC Win.Trojan.Begfanit.A outbound connection""; flow:to_server,established; content:""Trident/4.0|3B| Media Center PC 4.0|3B| SLCC1|3B| .NET CLR 3.0.04320)"",fast_pattern,nocase; content:""|0D 0A 0D 0A|""; base64_decode:relative; base64_data; pcre:""/^\w+\x3b.*?\x3b.*?\x3b/""; metadata:impact_flag red; service:http; classtype:trojan-activity; sid:23780; rev:6; )",['T1001']
"alert tcp $EXTERNAL_NET any -> $SQL_SERVERS $ORACLE_PORTS ( msg:""SERVER-ORACLE drop table attempt""; flow:to_server,established; content:""drop table"",nocase; metadata:ruleset community; classtype:protocol-command-decode; sid:1692; rev:7; )",['T1565']
